!function(e){"use strict";setupCSRF();var t="/api/v1.3/recommendorder/customers/"+window.customer_id+"/items";Vue.filter("toFixed",function(e,t){return Number(Number(e).toFixed(t))});var r=new Vue({el:"#recommend-items",data:{dealers:[],sum:0,isShowSumCell:!0,isShowBlank:!1,isShowCon:!0,selectedItem:{},recommendUrl:"/recommendorder/customer/"+window.customer_id+"/recommend",customerProfile:"/recommendorder/customer/"+window.customer_id+"/profile",dealerListUrl:"/recommendorder/customer/"+window.customer_id+"/dealer-list",dealerlist:"/recommendorder/dealer/1/customer/"+window.customer_id+"/add-item",customizeflag:!1,customizedata:null,custombutton:[],itemtags:null,promptflag:!1,indexArr:[]},watch:{sum:function(e,t){e>0?$("#placeorder").css("background","#ff4a0c"):0===e&&$("#placeorder").css("background","#dbdbdb")}},beforeCreate:function(){var e=getCookie("user_role");this.isSalesman="salesman"===e},methods:{back:function(){zhuge.track("返回（个性定制）",function(){window.location.href="/recommendorder/salesman/customer-status"})},promptConfirm:function(){var e=this;e.promptflag=!1,zhuge.track("确认（至少筛选一个条件）")},botCustomization:function(){zhuge.track("个性定制（个性定制）")},botDealer:function(){zhuge.track("供货商（个性定制）",function(){window.location.href="/recommendorder/customer/"+window.customer_id+"/dealer-list"})},botHome:function(){zhuge.track("个人中心（个性定制）",function(){window.location.href="/recommendorder/customer/"+window.customer_id+"/profile"})},init:function(){var e=this;$.ajax({url:t,type:"get",data:{type:"recommendation",groupby:"dealer",max:"50"},success:function(t){e.dealers=t.items,0===e.dealers.length?(e.isShowBlank=!0,e.isShowSumCell=!1,e.isShowCon=!1):(e.isShowBlank=!1,e.isShowSumCell=!0,e.isShowCon=!0),e.sum>0?$("#placeorder").css("background","#ff4a0c"):0===e.sum&&$("#placeorder").css("background","#dbdbdb")}})},add:function(e,t,r){var s=e.inventory;e.num==s&&1==parseInt(t)||0===e.num&&parseInt(t)==-1||(e.num=e.num-0+parseInt(t),e.selected===!0&&(this.addToSelectedItem(e),this.changeTotalSpend(e,t,r)),zhuge.track("修改商品数量（个性定制）",{"商品名称":$(this.$refs["item"+e.id]).find(".item_name").text(),"商品数量":$(this.$refs["item"+e.id]).find(".num_value").val()-0+t}))},changeTotalSpend:function(e,t,r){var s=this;r.amount=Number(r.amount)+e.price*parseFloat(t),s.sum=s.sum+e.price*parseFloat(t)},set:function(e,t,r){var s=this,i=/[^\d]/,o=event.target.value,a=parseInt(o),n=parseInt(t.inventory),c=o.search(i);c!=-1||0===o.length?t.num=0:a>n?t.num=n:t.num=a;var d=r.items.indexOf(t);Vue.set(r.items,d,t);var m=parseInt(s.selectedItem[t.id]),u=t.num-m;if(t.selected===!0&&0!==u){s.selectedItem[t.id];this.addToSelectedItem(t),this.changeTotalSpend(t,u,r)}},seNumtBlur:function(e){zhuge.track("修改商品数量（个性定制）",{"商品名称":$(this.$refs["item"+e]).find(".item_name").text(),"商品数量":$(this.$refs["item"+e]).find(".num_value").val()})},dAllSelected:function(e){for(var t=0;t<this.dealers.length;t++)if(this.dealers[t].dealer_id===e||void 0===e)for(var r=0;r<this.dealers[t].items.length;r++)if(this.dealers[t].items[r].selected===!1)return!1;return!0},dSelectAll:function(e,t,r){var s=this,i={};i.items=[];var o,a,n=!0;for(o=0;o<this.dealers.length;o++)if(this.dealers[o].dealer_id===r||void 0===r)for(a=0;a<this.dealers[o].items.length;a++)if(this.dealers[o].items[a].selected===!1){n=!1;break}for(o=0;o<this.dealers.length;o++)if(this.dealers[o].dealer_id===r||void 0===r)for(a=0;a<this.dealers[o].items.length;a++)this.dealers[o].items[a].selected===n&&this.select(this.dealers[o].items[a],this.dealers[o]);for(var c=0,d=0;d<this.dealers.length;d++)c+=this.dealers[d].items.length;if("choose"===e)zhuge.track("全选经销商商品(个性定制)",{"经销商名称":$(s.$refs["dealer"+r]).text()});else if(e="allChoose")zhuge.track("全选（个性定制）",{"商品数量":c});else if("unChoose"===e||"unAllChoose"===e)return},select:function(e,t,r){e.selected===!0?(e.selected=!1,this.deleteFromSelectedItem(e),this.changeTotalSpend(e,e.num*-1,t)):(e.selected=!0,this.addToSelectedItem(e),this.changeTotalSpend(e,e.num,t)),zhuge.track("勾选商品（个性定制）",{"商品名称":$(this.$refs["item"+e.id]).find(".item_name").text(),"商品数量":$(this.$refs["item"+e.id]).find(".num_value").val(),"勾选的商品序号":r-0+1})},addToSelectedItem:function(e){var t=this;t.selectedItem[e.id]=parseInt(e.num)},deleteFromSelectedItem:function(e){var t=this;t.selectedItem.hasOwnProperty(e.id)&&delete t.selectedItem[e.id]},dhref:function(e){zhuge.track("选择进入经销商店铺(个性定制)",function(){window.location.href="/recommendorder/dealer/"+e+"/customer/"+window.customer_id+"/add-item"})},confirmOrder:function(){var e="/api/v1.1/recommendorder/customer/"+window.customer_id+"/cart",t=this,r=0;for(var s in t.selectedItem)r+=1;for(var i=0,o=0;o<this.dealers.length;o++)i+=this.dealers[o].items.length;$.ajax({url:e,type:"post",data:t.selectedItem,success:function(e){$.ajax({url:"/api/v1.3/recommendorder/recommendation-statistics",type:"post",data:{selected_num:r,total_num:i},success:function(e){zhuge.track("增加(个性定制)",{"勾选数目":r,"展示数目":i,"下单金额":$(".xiadan_sum").text()},function(){window.location.href="/recommendorder/customer/"+window.customer_id+"/cart"})}})}})},customizesubmite:function(){for(var e=this,t=[],r=[],s=0;s<e.custombutton.length;s++)t[s]=e.custombutton[s].tag_id;for(var i=0;i<e.customizedata.length;i++)for(var o=0;o<e.customizedata[i].items.length;o++)e.customizedata[i].items[o].select===!0&&r.push(e.customizedata[i].items[o].name);0!==e.custombutton.length?(zhuge.track("提交（个性定制）",{"提交（个性定制）的结果":r}),$.ajax({url:"/api/v1.3/recommendorder/tag-preferences",type:"post",data:{tags:t},success:function(t){e.customizeflag=!1,e.init()}})):e.promptflag=!0},clickcustom:function(e,t){for(var r=this,s=!1,i=0;i<r.custombutton.length;i++)if(r.custombutton[i].tag_id==e){r.custombutton.splice(i,1),s=!0,zhuge.track("过滤（个性定制）",{"选择状态":t+"(没选中)"});break}s||(r.custombutton.push({tag_id:e,tag_name:t}),zhuge.track("个性定制（过滤）",{"选择状态":t+"(选中)"})),r.additem()},additem:function(){for(var e=this,t=0;t<e.itemtags.length;t++)if(0==e.custombutton.length)e.itemtags[t].select=!1;else for(var r=0;r<e.custombutton.length;r++){if(e.custombutton[r].tag_id==e.itemtags[t].id){e.itemtags[t].select=!0;break}e.itemtags[t].select=!1}for(var s=[e.itemtags[0]],t=1;t<e.itemtags.length;t++){for(var i=!1,o=0;o<s.length;o++)if(s[o].cat_order==e.itemtags[t].cat_order){i=!0;break}i||s.push(e.itemtags[t])}for(var a=0;a<s.length;a++)s[a].items=[];for(var t=0;t<e.itemtags.length;t++)for(var i=!1,o=0;o<s.length;o++)if(s[o].cat_order==e.itemtags[t].cat_order){s[o].items.push(e.itemtags[t]),i=!0;break}e.customizedata=s},opencustomize:function(){var e=this;$.ajax({url:"/api/v1.3/recommendorder/item-tags",type:"GET",success:function(t){e.itemtags=t.tags,e.additem(),e.customizeflag=!e.customizeflag}}),zhuge.track("重新定制(个性定制)")}},mounted:function(){var e=this;$.ajax({url:"/api/v1.3/recommendorder/tag-preferences",type:"get",success:function(t){$.ajax({url:"/api/v1.3/recommendorder/item-tags",type:"GET",success:function(t){e.itemtags=t.tags,e.additem()}}),0==t.tags.length?(e.customizeflag=!0,e.custombutton=e.clickcustom(1,"补货优先")):e.custombutton=t.tags}})}});r.init(),$(".place-order").click(function(){var e="/recommendorder/customer/"+customer_id+"/cart";zhuge.track("购物车（个性定制）",function(){window.location.href=e})})}(window.cmApp=window.cmApp||{});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY29tbWVuZG9yZGVyL3JlY29tbWVuZC5qcyJdLCJuYW1lcyI6WyJjbUFwcCIsInNldHVwQ1NSRiIsInVybCIsIndpbmRvdyIsImN1c3RvbWVyX2lkIiwiVnVlIiwiZmlsdGVyIiwibnVtIiwicHJlY2lzaW9uIiwiTnVtYmVyIiwidG9GaXhlZCIsImJpbmQiLCJlbCIsImRhdGEiLCJkZWFsZXJzIiwic3VtIiwiaXNTaG93U3VtQ2VsbCIsImlzU2hvd0JsYW5rIiwiaXNTaG93Q29uIiwic2VsZWN0ZWRJdGVtIiwicmVjb21tZW5kVXJsIiwiY3VzdG9tZXJQcm9maWxlIiwiZGVhbGVyTGlzdFVybCIsImRlYWxlcmxpc3QiLCJjdXN0b21pemVmbGFnIiwiY3VzdG9taXplZGF0YSIsImN1c3RvbWJ1dHRvbiIsIml0ZW10YWdzIiwicHJvbXB0ZmxhZyIsImluZGV4QXJyIiwid2F0Y2giLCJuZXdfdmFsdWUiLCJvbGRfdmFsdWUiLCIkIiwiY3NzIiwiYmVmb3JlQ3JlYXRlIiwidXNlcl9yb2xlIiwiZ2V0Q29va2llIiwidGhpcyIsImlzU2FsZXNtYW4iLCJtZXRob2RzIiwiYmFjayIsInpodWdlIiwidHJhY2siLCJsb2NhdGlvbiIsImhyZWYiLCJwcm9tcHRDb25maXJtIiwiX3RoaXMiLCJib3RDdXN0b21pemF0aW9uIiwiYm90RGVhbGVyIiwiYm90SG9tZSIsImluaXQiLCJhamF4IiwidHlwZSIsImdyb3VwYnkiLCJtYXgiLCJzdWNjZXNzIiwiaXRlbXMiLCJsZW5ndGgiLCJhZGQiLCJpdGVtIiwiZGVhbGVyIiwiaW52ZW50b3J5IiwicGFyc2VJbnQiLCJzZWxlY3RlZCIsImFkZFRvU2VsZWN0ZWRJdGVtIiwiY2hhbmdlVG90YWxTcGVuZCIsIuWVhuWTgeWQjeensCIsIiRyZWZzIiwiaWQiLCJmaW5kIiwidGV4dCIsIuWVhuWTgeaVsOmHjyIsInZhbCIsImFtb3VudCIsInByaWNlIiwicGFyc2VGbG9hdCIsInNldCIsIiRldmVudCIsInJlIiwiY2hhbmdlVmFsdWUiLCJldmVudCIsInRhcmdldCIsInZhbHVlIiwiaW50Q2hhbmdlVmFsdWUiLCJpbnRJbnZlcnRvcnkiLCJyZXN1bHQiLCJzZWFyY2giLCJpbmRleCIsImluZGV4T2YiLCJpbnRPcmdOdW0iLCJjaGFuZ2VOdW0iLCJzZU51bXRCbHVyIiwiZEFsbFNlbGVjdGVkIiwiZGlkIiwiaSIsImRlYWxlcl9pZCIsInVuZGVmaW5lZCIsImoiLCJkU2VsZWN0QWxsIiwic3RhdHVzIiwiZGF0YVRvU2VuZCIsImN1cnJlbnQiLCJzZWxlY3QiLCJjaG9vc2VudW0iLCJtIiwi57uP6ZSA5ZWG5ZCN56ewIiwiZGVsZXRlRnJvbVNlbGVjdGVkSXRlbSIsIuWLvumAieeahOWVhuWTgeW6j+WPtyIsImhhc093blByb3BlcnR5IiwiZGhyZWYiLCJjb25maXJtT3JkZXIiLCJzaG93bnVtIiwibiIsInNob3dBbGxOdW0iLCJzZWxlY3RlZF9udW0iLCJ0b3RhbF9udW0iLCLli77pgInmlbDnm64iLCLlsZXnpLrmlbDnm64iLCLkuIvljZXph5Hpop0iLCJjdXN0b21pemVzdWJtaXRlIiwic2VsZiIsIm5hbWUiLCJ0YWdfaWQiLCJrIiwicHVzaCIsIuaPkOS6pO+8iOS4quaAp+WumuWItu+8ieeahOe7k+aenCIsInRhZ3MiLCJjbGlja2N1c3RvbSIsImZsYWciLCJzcGxpY2UiLCLpgInmi6nnirbmgIEiLCJ0YWdfbmFtZSIsImFkZGl0ZW0iLCJ4IiwicmVzIiwicmVwZWF0IiwiY2F0X29yZGVyIiwicSIsIm9wZW5jdXN0b21pemUiLCJtb3VudGVkIiwiY2xpY2siLCJjYXJ0X2hyZWYiXSwibWFwcGluZ3MiOiJDQUFBLFNBQVVBLEdBRU4sWUFDQUMsWUFFQSxJQUFJQyxHQUFNLHNDQUF3Q0MsT0FBT0MsWUFBYyxRQUV2RUMsS0FBSUMsT0FBTyxVQUFXLFNBQVVDLEVBQUtDLEdBQ2pDLE1BQU9DLFFBQU9BLE9BQU9GLEdBQUtHLFFBQVFGLEtBRXRDLElBQUlHLEdBQU8sR0FBSU4sTUFDWE8sR0FBSSxtQkFDSkMsTUFDSUMsV0FDQUMs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QUFPaUcsT0FJaEMzSSxPQUFPSCxNQUFRRyxPQUFPSCIsImZpbGUiOiJyZWNvbW1lbmRvcmRlci9yZWNvbW1lbmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oY21BcHApIHtcblxuICAgICd1c2Ugc3RyaWN0JztcbiAgICBzZXR1cENTUkYoKTtcblxuICAgIHZhciB1cmwgPSAnL2FwaS92MS4zL3JlY29tbWVuZG9yZGVyL2N1c3RvbWVycy8nICsgd2luZG93LmN1c3RvbWVyX2lkICsgJy9pdGVtcyc7XG5cbiAgICBWdWUuZmlsdGVyKCd0b0ZpeGVkJywgZnVuY3Rpb24gKG51bSwgcHJlY2lzaW9uKSB7XG4gICAgICAgIHJldHVybiBOdW1iZXIoTnVtYmVyKG51bSkudG9GaXhlZChwcmVjaXNpb24pKTtcbiAgICB9KTtcbiAgICB2YXIgYmluZCA9IG5ldyBWdWUoe1xuICAgICAgICBlbDogJyNyZWNvbW1lbmQtaXRlbXMnLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBkZWFsZXJzOiBbXSxcbiAgICAgICAgICAgIHN1bTogMCxcbiAgICAgICAgICAgIGlzU2hvd1N1bUNlbGw6dHJ1ZSxcbiAgICAgICAgICAgIGlzU2hvd0JsYW5rOmZhbHNlLFxuICAgICAgICAgICAgaXNTaG93Q29uOnRydWUsXG4gICAgICAgICAgICBzZWxlY3RlZEl0ZW06IHt9LFxuICAgICAgICAgICAgcmVjb21tZW5kVXJsOiBcIi9yZWNvbW1lbmRvcmRlci9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL3JlY29tbWVuZFwiLFxuICAgICAgICAgICAgY3VzdG9tZXJQcm9maWxlOiBcIi9yZWNvbW1lbmRvcmRlci9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL3Byb2ZpbGVcIixcbiAgICAgICAgICAgIGRlYWxlckxpc3RVcmwgOiBcIi9yZWNvbW1lbmRvcmRlci9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL2RlYWxlci1saXN0XCIsXG4gICAgICAgICAgICBkZWFsZXJsaXN0OlwiL3JlY29tbWVuZG9yZGVyL2RlYWxlci8xL2N1c3RvbWVyL1wiICsgd2luZG93LmN1c3RvbWVyX2lkICsgXCIvYWRkLWl0ZW1cIixcbiAgICAgICAgICAgIGN1c3RvbWl6ZWZsYWc6ZmFsc2UsXG4gICAgICAgICAgICBjdXN0b21pemVkYXRhOm51bGwsXG4gICAgICAgICAgICBjdXN0b21idXR0b246W10sXG4gICAgICAgICAgICBpdGVtdGFnczpudWxsLFxuICAgICAgICAgICAgcHJvbXB0ZmxhZzpmYWxzZSxcbiAgICAgICAgICAgIGluZGV4QXJyOltdXG4gICAgICAgIH0sXG4gICAgICAgIHdhdGNoOiB7XG4gICAgICAgICAgICBzdW06IGZ1bmN0aW9uKG5ld192YWx1ZSxvbGRfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3X3ZhbHVlID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnI3BsYWNlb3JkZXInKS5jc3MoJ2JhY2tncm91bmQnLCcjZmY0YTBjJyk7XG4gICAgICAgICAgICAgICAgfWVsc2UgaWYobmV3X3ZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJyNwbGFjZW9yZGVyJykuY3NzKCdiYWNrZ3JvdW5kJywnI2RiZGJkYicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYmVmb3JlQ3JlYXRlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHVzZXJfcm9sZSA9IGdldENvb2tpZSgndXNlcl9yb2xlJyk7XG4gICAgICAgICAgICB0aGlzLmlzU2FsZXNtYW4gPSB1c2VyX3JvbGUgPT09IFwic2FsZXNtYW5cIjtcbiAgICAgICAgfSxcbiAgICAgICAgbWV0aG9kczoge1xuICAgICAgICAgICAgYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB6aHVnZS50cmFjaygn6L+U5Zue77yI5Liq5oCn5a6a5Yi277yJJyxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvcmVjb21tZW5kb3JkZXIvc2FsZXNtYW4vY3VzdG9tZXItc3RhdHVzXCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvbXB0Q29uZmlybTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgX3RoaXMucHJvbXB0ZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHpodWdlLnRyYWNrKCfnoa7orqTvvIjoh7PlsJHnrZvpgInkuIDkuKrmnaHku7bvvIknKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib3RDdXN0b21pemF0aW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB6aHVnZS50cmFjaygn5Liq5oCn5a6a5Yi277yI5Liq5oCn5a6a5Yi277yJJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm90RGVhbGVyOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHpodWdlLnRyYWNrKCfkvpvotKfllYbvvIjkuKrmgKflrprliLbvvIknLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9yZWNvbW1lbmRvcmRlci9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL2RlYWxlci1saXN0XCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm90SG9tZTpmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICB6aHVnZS50cmFjaygn5Liq5Lq65Lit5b+D77yI5Liq5oCn5a6a5Yi277yJJyxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9wcm9maWxlXCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOntcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOlwicmVjb21tZW5kYXRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZ3JvdXBieVwiOlwiZGVhbGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbWF4JzonNTAnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kZWFsZXJzID0gZGF0YS5pdGVtcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIF90aGlzLnN1bSA9TnVtYmVyKGRhdGEuc3VtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF90aGlzLmRlYWxlcnMubGVuZ3RoID09PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1Nob3dCbGFuayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNTaG93U3VtQ2VsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzU2hvd0NvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNTaG93QmxhbmsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1Nob3dTdW1DZWxsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1Nob3dDb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnN1bSA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3BsYWNlb3JkZXInKS5jc3MoJ2JhY2tncm91bmQnLCcjZmY0YTBjJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihfdGhpcy5zdW0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcGxhY2VvcmRlcicpLmNzcygnYmFja2dyb3VuZCcsJyNkYmRiZGInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8v6YCa6L+H5Yqg5YeP6K6+572u6LSt5Lmw5pWw6YePXG4gICAgICAgICAgICBhZGQ6IGZ1bmN0aW9uIChpdGVtLCBudW0sIGRlYWxlcikge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgLy/lupPlrZhcbiAgICAgICAgICAgICAgICB2YXIgaW52ZW50b3J5ID0gaXRlbS5pbnZlbnRvcnk7XG4gICAgICAgICAgICAgICAgLy/llYblk4HmlbDph4/kuLow77yM5oiW6ICF5Li65bqT5a2Y6YeP77yM5YiZ5LiN5YGa5pON5L2cXG4gICAgICAgICAgICAgICAgaWYgKChpdGVtLm51bSA9PSBpbnZlbnRvcnkgJiYgcGFyc2VJbnQobnVtKSA9PSAxKSB8fCAoaXRlbS5udW0gPT09IDAgJiYgcGFyc2VJbnQobnVtKSA9PSAtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGl0ZW0ubnVtID0gaXRlbS5udW0gLSAwICsgcGFyc2VJbnQobnVtKTtcbiAgICAgICAgICAgICAgICAvL+WmguaenOWVhuWTgeaYr+mAieS4reeKtuaAge+8jOWwseaKiuaUueWPmOeahOaVsOmHj+aUvuWIsFNlbGVjdGVkSXRlbemHjO+8jOW5tuS/ruaUueaAu+eahOiKsei0uemHkemineWxleekulxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnNlbGVjdGVkID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVG9TZWxlY3RlZEl0ZW0oaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVG90YWxTcGVuZChpdGVtLCBudW0sIGRlYWxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHpodWdlLnRyYWNrKCfkv67mlLnllYblk4HmlbDph4/vvIjkuKrmgKflrprliLbvvIknLHtcbiAgICAgICAgICAgICAgICAgICAgJ+WVhuWTgeWQjeensCc6JCh0aGlzLiRyZWZzWydpdGVtJyArIGl0ZW0uaWRdKS5maW5kKCcuaXRlbV9uYW1lJykudGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAn5ZWG5ZOB5pWw6YePJzokKHRoaXMuJHJlZnNbJ2l0ZW0nICsgaXRlbS5pZF0pLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSAtIDAgKyBudW1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL+aUueWPmOW3sumAieS4reWVhuWTgeeahOaVsOmHj+aXtu+8jOS/ruaUuee7j+mUgOWVhuiKsei0ueWSjOaAu+iKsei0uVxuICAgICAgICAgICAgY2hhbmdlVG90YWxTcGVuZDogZnVuY3Rpb24gKGl0ZW0sIG51bSwgZGVhbGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAvL+S/ruaUuee7j+mUgOWVhuWVhuWTgeiKsei0uemHkeminVxuICAgICAgICAgICAgICAgIGRlYWxlci5hbW91bnQgPSBOdW1iZXIoZGVhbGVyLmFtb3VudCkgKyBpdGVtLnByaWNlICogcGFyc2VGbG9hdChudW0pO1xuICAgICAgICAgICAgICAgIC8v5L+u5pS56Iqx6LS55oC76YeR6aKdXG4gICAgICAgICAgICAgICAgX3RoaXMuc3VtID0gX3RoaXMuc3VtICsgaXRlbS5wcmljZSAqIHBhcnNlRmxvYXQobnVtKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL+ebtOaOpeiuvue9rui0reS5sOaVsOmHj1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoJGV2ZW50LCBpdGVtLCBkZWFsZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciByZSA9IC9bXlxcZF0vO1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VWYWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgaW50Q2hhbmdlVmFsdWUgPSBwYXJzZUludChjaGFuZ2VWYWx1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIGludEludmVydG9yeSA9IHBhcnNlSW50KGl0ZW0uaW52ZW50b3J5KTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gY2hhbmdlVmFsdWUuc2VhcmNoKHJlKTtcbiAgICAgICAgICAgICAgICAvL+i+k+WFpemdnuaVsOWtl+aUueS4ujBcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IC0xIHx8IGNoYW5nZVZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLm51bSA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnRDaGFuZ2VWYWx1ZSA+IGludEludmVydG9yeSkge1xuICAgICAgICAgICAgICAgICAgICAvL+i2hei/h+W6k+WtmOmHj1xuICAgICAgICAgICAgICAgICAgICBpdGVtLm51bSA9IGludEludmVydG9yeTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLm51bSA9IGludENoYW5nZVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL1Z1ZeWPmOWKqOaVsOe7hFxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGRlYWxlci5pdGVtcy5pbmRleE9mKGl0ZW0pO1xuICAgICAgICAgICAgICAgIFZ1ZS5zZXQoZGVhbGVyLml0ZW1zLCBpbmRleCwgaXRlbSk7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzllYblk4HmmK/pgInkuK3nirbmgIHkuJTllYblk4HmlbDph4/mnInmlLnliqjvvIzlsLHmiormlLnlj5jnmoTmlbDph4/mlL7liLBTZWxlY3RlZEl0ZW3ph4zvvIzlubbkv67mlLnmgLvnmoToirHotLnph5Hpop3lsZXnpLpcbiAgICAgICAgICAgICAgICB2YXIgaW50T3JnTnVtID0gcGFyc2VJbnQoX3RoaXMuc2VsZWN0ZWRJdGVtW2l0ZW0uaWRdKTtcbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlTnVtID0gaXRlbS5udW0gLSBpbnRPcmdOdW07XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uc2VsZWN0ZWQgPT09IHRydWUgJiYgY2hhbmdlTnVtICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcmdOdW0gPSBfdGhpcy5zZWxlY3RlZEl0ZW1baXRlbS5pZF07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVG9TZWxlY3RlZEl0ZW0oaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVG90YWxTcGVuZChpdGVtLCBjaGFuZ2VOdW0sIGRlYWxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlTnVtdEJsdXI6ZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+S/ruaUueWVhuWTgeaVsOmHj++8iOS4quaAp+WumuWItu+8iScse1xuICAgICAgICAgICAgICAgICAgICAn5ZWG5ZOB5ZCN56ewJzokKHRoaXMuJHJlZnNbJ2l0ZW0nICsgaWRdKS5maW5kKCcuaXRlbV9uYW1lJykudGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAn5ZWG5ZOB5pWw6YePJzokKHRoaXMuJHJlZnNbJ2l0ZW0nICsgaWRdKS5maW5kKCcubnVtX3ZhbHVlJykudmFsKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL+iuvue9rue7j+mUgOWVhumAieS4reeKtuaAgVxuICAgICAgICAgICAgZEFsbFNlbGVjdGVkOiBmdW5jdGlvbiAoZGlkKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRlYWxlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVhbGVyc1tpXS5kZWFsZXJfaWQgIT09IGRpZCAmJiBkaWQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuZGVhbGVyc1tpXS5pdGVtcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVhbGVyc1tpXS5pdGVtc1tqXS5zZWxlY3RlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy/lhajpgIlcbiAgICAgICAgICAgIGRTZWxlY3RBbGw6IGZ1bmN0aW9uIChzdGF0dXMsJGV2ZW50LCBkaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVG9TZW5kID0ge307XG4gICAgICAgICAgICAgICAgZGF0YVRvU2VuZC5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgaSwgajtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5kZWFsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlYWxlcnNbaV0uZGVhbGVyX2lkICE9PSBkaWQgJiYgZGlkICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMuZGVhbGVyc1tpXS5pdGVtcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVhbGVyc1tpXS5pdGVtc1tqXS5zZWxlY3RlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZGVhbGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWFsZXJzW2ldLmRlYWxlcl9pZCAhPT0gZGlkICYmIGRpZCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLmRlYWxlcnNbaV0uaXRlbXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlYWxlcnNbaV0uaXRlbXNbal0uc2VsZWN0ZWQgPT09IGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCh0aGlzLmRlYWxlcnNbaV0uaXRlbXNbal0sIHRoaXMuZGVhbGVyc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy/ln4vngrlcbiAgICAgICAgICAgICAgICB2YXIgY2hvb3NlbnVtID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IHRoaXMuZGVhbGVycy5sZW5ndGg7IG0rKykge1xuICAgICAgICAgICAgICAgICAgICBjaG9vc2VudW0gKz0gdGhpcy5kZWFsZXJzW21dLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ2Nob29zZScpIHtcbiAgICAgICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+WFqOmAiee7j+mUgOWVhuWVhuWTgSjkuKrmgKflrprliLYpJyx7XG4gICAgICAgICAgICAgICAgICAgICAgICAn57uP6ZSA5ZWG5ZCN56ewJzokKF90aGlzLiRyZWZzWydkZWFsZXInICsgZGlkXSkudGV4dCgpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID0gJ2FsbENob29zZScpIHtcbiAgICAgICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+WFqOmAie+8iOS4quaAp+WumuWItu+8iScse1xuICAgICAgICAgICAgICAgICAgICAgICAgJ+WVhuWTgeaVsOmHjyc6Y2hvb3NlbnVtXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAndW5DaG9vc2UnIHx8IHN0YXR1cyA9PT0gJ3VuQWxsQ2hvb3NlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8v6YCJ5oup5Y2V5Liq5ZWG5ZOBXG4gICAgICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uIChpdGVtLCBkZWFsZXIsaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5zZWxlY3RlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlRnJvbVNlbGVjdGVkSXRlbShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VUb3RhbFNwZW5kKGl0ZW0sIGl0ZW0ubnVtICogKC0xKSwgZGVhbGVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRUb1NlbGVjdGVkSXRlbShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VUb3RhbFNwZW5kKGl0ZW0sIGl0ZW0ubnVtLCBkZWFsZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL+Wfi+eCuVxuICAgICAgICAgICAgICAgIHpodWdlLnRyYWNrKCfli77pgInllYblk4HvvIjkuKrmgKflrprliLbvvIknLHtcbiAgICAgICAgICAgICAgICAgICAgJ+WVhuWTgeWQjeensCc6JCh0aGlzLiRyZWZzWydpdGVtJyArIGl0ZW0uaWRdKS5maW5kKCcuaXRlbV9uYW1lJykudGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAn5ZWG5ZOB5pWw6YePJzokKHRoaXMuJHJlZnNbJ2l0ZW0nICsgaXRlbS5pZF0pLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgJ+WLvumAieeahOWVhuWTgeW6j+WPtyc6aW5kZXggLSAwICsgMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8v5re75Yqg5Yiw5aKe5YqgZGljdFxuICAgICAgICAgICAgYWRkVG9TZWxlY3RlZEl0ZW06IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RlZEl0ZW1baXRlbS5pZF0gPSBwYXJzZUludChpdGVtLm51bSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy/ku47lop7liqBkaWN05Yig6ZmkXG4gICAgICAgICAgICBkZWxldGVGcm9tU2VsZWN0ZWRJdGVtOiBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnNlbGVjdGVkSXRlbS5oYXNPd25Qcm9wZXJ0eShpdGVtLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMuc2VsZWN0ZWRJdGVtW2l0ZW0uaWRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL+mbtuWUruW6l+i2hemTvuaOpVxuICAgICAgICAgICAgZGhyZWY6IGZ1bmN0aW9uIChkaWQpIHtcbiAgICAgICAgICAgICAgICAvLyDln4vngrlcbiAgICAgICAgICAgICAgICB6aHVnZS50cmFjaygn6YCJ5oup6L+b5YWl57uP6ZSA5ZWG5bqX6ZO6KOS4quaAp+WumuWItiknLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9yZWNvbW1lbmRvcmRlci9kZWFsZXIvXCIgKyBkaWQgKyBcIi9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL2FkZC1pdGVtXCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy/mt7vliqDlubbot7PovazliLDotK3nianovaborqLljZXpobXpnaJcbiAgICAgICAgICAgIGNvbmZpcm1PcmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnL2FwaS92MS4xL3JlY29tbWVuZG9yZGVyL2N1c3RvbWVyLycgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyAnL2NhcnQnO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIHNob3dudW0gPSAwO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIG4gaW4gX3RoaXMuc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3dudW0gKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNob3dBbGxOdW0gPSAwO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIG0gPSAwOyBtIDwgdGhpcy5kZWFsZXJzLmxlbmd0aDsgbSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3dBbGxOdW0gKz0gdGhpcy5kZWFsZXJzW21dLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogX3RoaXMuc2VsZWN0ZWRJdGVtLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS92MS4zL3JlY29tbWVuZG9yZGVyL3JlY29tbWVuZGF0aW9uLXN0YXRpc3RpY3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX251bTogc2hvd251bSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxfbnVtOiBzaG93QWxsTnVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+WinuWKoCjkuKrmgKflrprliLYpJyx7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn5Yu+6YCJ5pWw55uuJzpzaG93bnVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ+WxleekuuaVsOebric6c2hvd0FsbE51bSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICfkuIvljZXph5Hpop0nOiQoJy54aWFkYW5fc3VtJykudGV4dCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3JlY29tbWVuZG9yZGVyL2N1c3RvbWVyLycgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyAnL2NhcnQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN1c3RvbWl6ZXN1Ym1pdGU6ZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gW107XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaTxzZWxmLmN1c3RvbWJ1dHRvbi5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIGlkW2ldID0gc2VsZi5jdXN0b21idXR0b25baV0udGFnX2lkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuY3VzdG9taXplZGF0YS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNlbGYuY3VzdG9taXplZGF0YVtqXS5pdGVtcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuY3VzdG9taXplZGF0YVtqXS5pdGVtc1trXS5zZWxlY3QgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLnB1c2goc2VsZi5jdXN0b21pemVkYXRhW2pdLml0ZW1zW2tdLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmN1c3RvbWJ1dHRvbi5sZW5ndGghPT0wKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIOWfi+eCuVxuICAgICAgICAgICAgICAgICAgICB6aHVnZS50cmFjaygn5o+Q5Lqk77yI5Liq5oCn5a6a5Yi277yJJyx7XG4gICAgICAgICAgICAgICAgICAgICAgICAn5o+Q5Lqk77yI5Liq5oCn5a6a5Yi277yJ55qE57uT5p6cJzpuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEuMy9yZWNvbW1lbmRvcmRlci90YWctcHJlZmVyZW5jZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGFnc1wiOmlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXN0b21pemVmbGFnPWZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wcm9tcHRmbGFnPXRydWU7XG4gICAgICAgICAgICAgICAgfSAgIFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsaWNrY3VzdG9tOmZ1bmN0aW9uKGlkLG5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGZsYWc9ZmFsc2VcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuY3VzdG9tYnV0dG9uLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi5jdXN0b21idXR0b25baV0udGFnX2lkPT1pZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1c3RvbWJ1dHRvbi5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmbGFnPXRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWfi+eCuVxuICAgICAgICAgICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+i/h+a7pO+8iOS4quaAp+WumuWItu+8iScse1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICfpgInmi6nnirbmgIEnOm5hbWUgKyAnKOayoemAieS4rSknXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZmxhZykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1c3RvbWJ1dHRvbi5wdXNoKHsndGFnX2lkJzppZCwndGFnX25hbWUnOm5hbWV9KVxuICAgICAgICAgICAgICAgICAgICAvLyDln4vngrlcbiAgICAgICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+S4quaAp+WumuWItu+8iOi/h+a7pO+8iScse1xuICAgICAgICAgICAgICAgICAgICAgICAgJ+mAieaLqeeKtuaAgSc6bmFtZSArICco6YCJ5LitKSdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuYWRkaXRlbSgpXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhZGRpdGVtOmZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXRhZ3MubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5jdXN0b21idXR0b24ubGVuZ3RoPT0wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW10YWdzW2ldLnNlbGVjdD1mYWxzZTsgIFxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgc2VsZi5jdXN0b21idXR0b24ubGVuZ3RoOyB4Kyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGYuY3VzdG9tYnV0dG9uW3hdLnRhZ19pZD09c2VsZi5pdGVtdGFnc1tpXS5pZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXRhZ3NbaV0uc2VsZWN0PXRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW10YWdzW2ldLnNlbGVjdD1mYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IFtzZWxmLml0ZW10YWdzWzBdXVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2VsZi5pdGVtdGFncy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXBlYXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9MCA7IGogPCByZXMubGVuZ3RoO2orKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc1tqXS5jYXRfb3JkZXIgPT0gc2VsZi5pdGVtdGFnc1tpXS5jYXRfb3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmKCFyZXBlYXQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goc2VsZi5pdGVtdGFnc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcSA9MCA7IHEgPCByZXMubGVuZ3RoO3ErKykge1xuICAgICAgICAgICAgICAgICAgICByZXNbcV0uaXRlbXM9W11cbiAgICAgICAgICAgICAgICB9ICAgXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9MCA7IGkgPCBzZWxmLml0ZW10YWdzLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcGVhdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0wIDsgaiA8IHJlcy5sZW5ndGg7aisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzW2pdLmNhdF9vcmRlciA9PSBzZWxmLml0ZW10YWdzW2ldLmNhdF9vcmRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc1tqXS5pdGVtcy5wdXNoKHNlbGYuaXRlbXRhZ3NbaV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmN1c3RvbWl6ZWRhdGE9cmVzXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcGVuY3VzdG9taXplOmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxLjMvcmVjb21tZW5kb3JkZXIvaXRlbS10YWdzXCIsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXRhZ3M9ZGF0YS50YWdzXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZGl0ZW0oKVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXN0b21pemVmbGFnPSFzZWxmLmN1c3RvbWl6ZWZsYWdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8v5Z+L54K5XG4gICAgICAgICAgICAgICAgemh1Z2UudHJhY2soJ+mHjeaWsOWumuWItijkuKrmgKflrprliLYpJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG1vdW50ZWQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxLjMvcmVjb21tZW5kb3JkZXIvdGFnLXByZWZlcmVuY2VzXCIsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2dldCcsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS92MS4zL3JlY29tbWVuZG9yZGVyL2l0ZW0tdGFnc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW10YWdzPWRhdGEudGFnc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkaXRlbSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS50YWdzLmxlbmd0aD09MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXN0b21pemVmbGFnPXRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1c3RvbWJ1dHRvbiA9IHNlbGYuY2xpY2tjdXN0b20oMSwn6KGl6LSn5LyY5YWIJylcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1c3RvbWJ1dHRvbj1kYXRhLnRhZ3NcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGJpbmQuaW5pdCgpO1xuICAgIC8v54K55Ye75Y676LSt54mp6L2m5oyJ6ZKu6aG16Z2i6Lez6L2s5Zyo6LSt54mp6L2m6aG16Z2i5ZCM5pe25ZWG5ZOB5Ye6546w5Zyo6LSt54mp6L2m5LitXG4gICAgJCgnLnBsYWNlLW9yZGVyJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGNhcnRfaHJlZiA9ICcvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvJyArIGN1c3RvbWVyX2lkICsgJy9jYXJ0JztcbiAgICAgICAgemh1Z2UudHJhY2soJ+i0reeJqei9pu+8iOS4quaAp+WumuWItu+8iScsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjYXJ0X2hyZWY7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG59KSh3aW5kb3cuY21BcHAgPSB3aW5kb3cuY21BcHAgfHwge30pO1xuIl19
