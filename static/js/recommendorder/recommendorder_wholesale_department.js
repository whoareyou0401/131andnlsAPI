$(function(){"use strict";function e(){console.log("ic arrow clicked"),s++,console.log(s),s%2===0?(t.order="price",$(".ic-arrow").css({background:"url(/static/images/recommendorder/ic_arrow_down.png) no-repeat center"})):(t.order="-price",console.log(22222),$(".ic-arrow").css({background:"url(/static/images/recommendorder/ic_arrow_up.png) no-repeat center"}))}function o(){var e=$("#search").val();0==e.length?($(".show").css({display:"block"}),$(".hide").css({display:"none"})):($(".show").css({display:"none"}),$(".hide").css({display:"block"})),n.query=e}document.addEventListener("gesturestart",function(e){e.preventDefault()});var c=new Vue({el:"#footer",data:{total:0},computed:{display_total:function(){return""+this.total.toFixed(2)}}}),t=new Vue({el:"#item-list",data:{items:[],selected_items:{},source:$("#source").attr("name"),customer_id:$("#source").attr("customer_id"),cat_name:"rec",order:"-score"},ready:function(){var e=this;console.log("Vue mounted"),e.$watch("cat_name",function(){e.loadItems(e.cat_name,e.source,e.order)}),e.$watch("order",function(){"price"===e.order?e.items=e.items.sort(function(e,o){return e.price-o.price}):"-price"===e.order?e.items=e.items.sort(function(e,o){return o.price-e.price}):"score"===e.order?e.items=e.items.sort(function(e,o){return e.score-o.score}):"-score"===e.order?e.items=e.items.sort(function(e,o){return o.score-e.score}):"num"===e.order?e.items=e.items.sort(function(e,o){return e.num-o.num}):"-num"===e.order&&(e.items=e.items.sort(function(e,o){return o.num-e.num}))}),$.ajax({url:"/recommendorder/api/v1/basket",type:"get",datatype:"jsonp",success:function(o){var c=o.data;console.log(c),c.forEach(function(o){console.log(o),e.selected_items[o.id]={item_id:o.item_id,num:o.recommend_num,price:o.price}}),e.loadItems(e.cat_name,e.source,e.order),e.refreshSelectedItems(e.items)}})},methods:{toItemString:function(){var e="";for(var o in this.selected_items)e=e+this.selected_items[o].item_id+","+this.selected_items[o].num+"|";return e},refreshSelectedItems:function(e){var o=this;e.forEach(function(e){0!==e.selected_num?o.selected_items[e.id]={item_id:e.item_id,num:e.selected_num,price:e.price}:e.id in o.selected_items&&(o.selected_items[e.id].num=0)}),c.total=0;for(var t in o.selected_items){var n=o.selected_items[t];c.total+=n.num*n.price}},numChange:function(e){console.log(typeof e.selected_num),console.log(typeof e.stock_num),e.selected_num=parseInt(e.selected_num),console.log(typeof e.selected_num),""===e.selected_num?(console.log("Empty!"),e.selected_num=0):e.selected_num>e.stock_num&&(e.selected_num=e.stock_num),this.refreshSelectedItems(this.items)},reduceClicked:function(e){console.log("reduce"),$(".reduce").on("touchstart",".area",function(){console.log(100),$(this).css("opacity","0.5")}),$(".reduce").on("touchend",".area",function(){console.log(200),$(this).css("opacity","1")}),e.selected_num-1>=0&&(e.selected_num=parseInt(e.selected_num)-1),this.refreshSelectedItems(this.items)},plusClicked:function(e){console.log(e),console.log("Plus clicked!"),$(".plus").on("touchstart",".area",function(){console.log(100),$(this).css("opacity","0.5")}),$(".plus").on("touchend",".area",function(){console.log(200),$(this).css("opacity","1")}),e.selected_num=parseInt(e.selected_num)+1,e.selected_num>e.stock_num&&(e.selected_num=e.stock_num),this.refreshSelectedItems(this.items)},itemFilter:function(e){var o=this;return e.forEach(function(e){e.id in o.selected_items?e.selected_num=o.selected_items[e.id].num:e.selected_num=0,e.price=parseFloat(e.price),e.display_price=e.price.toFixed(2)}),e},loadItems:function(e,o,c){var t=this;t.items=[],"rec"===e?$.ajax({url:"/recommendorder/api/v1/items_extended",type:"get",datatype:"jsonp",data:{order:"sort_level_one,sort_level_two,"+t.order,limit:10},success:function(e){console.log(e),t.items=t.itemFilter(e)},error:function(e){console.log(1)}}):$.ajax({url:"/recommendorder/api/v1/items_extended",type:"get",datatype:"jsonp",data:{order:t.order,category:e},success:function(e){console.log(e),t.items=t.itemFilter(e)}})}}}),n=new Vue({el:"#search-results",data:{items:[],query:""},methods:{reduceClicked:function(e){console.log("reduce"),$(".reduce").on("touchstart",".area",function(){console.log(100),$(this).css("opacity","0.5")}),$(".reduce").on("touchend",".area",function(){console.log(200),$(this).css("opacity","1")}),e.selected_num-1>=0&&(e.selected_num=e.selected_num-1),t.refreshSelectedItems(this.items)},plusClicked:function(e){console.log(e),console.log("Plus clicked!"),$(".plus").on("touchstart",".area",function(){console.log(100),$(this).css("opacity","0.5")}),$(".plus").on("touchend",".area",function(){console.log(200),$(this).css("opacity","1")}),console.log(e.stock_num),e.selected_num=parseInt(e.selected_num)+1,e.selected_num>e.stock_num&&(e.selected_num=e.stock_num),t.refreshSelectedItems(this.items)},numChange:function(e){e.selected_num=parseInt(e.selected_num),console.log(typeof e.selected_num),e.selected_num>e.stock_num&&(e.selected_num=e.stock_num),t.refreshSelectedItems(this.items)}},ready:function(){var e=this;console.log("search vue mounted"),e.$watch("query",function(){console.log("Query changed: "+e.query),e.query.length>1&&(console.log("Searching..."),$.ajax({url:"/recommendorder/api/v1/search_item",type:"get",datatype:"jsonp",data:{query:e.query},success:function(o){console.log(o),0===o.code?e.items=t.itemFilter(o.data):console.log("Search error")}}))})}});$(".price").click(function(){e()});var s=0;$("#by-score").click(function(){console.log("by score clicked"),"-score"===t.order?t.order="score":t.order="-score"}),$("#by-num").click(function(){console.log("by score clicked"),"-num"===t.order?t.order="num":t.order="-num"}),$(".nav-item").click(function(){$(this).addClass("active"),$(this).siblings().removeClass("active");var e=$(this).attr("cat_name");t.cat_name=e,console.log("Category name"+e+"of source "+source)}),$(".home-info-nav-b").click(function(){console.log(1e3),$(".model").css({display:"block"}),$(".model .call").css({display:"block"})}),$(".cancel").click(function(){console.log(99),$(".model").css({display:"none"}),$(".model .call").css({display:"none"})}),$(".model .sure").click(function(){console.log(994),window.location.href="tel://83066002"}),$(".money").click(function(){console.log(1e3),$(".add").css({display:"block"}),$(".add .call").css({display:"block"})}),$(".add .cancel").click(function(){console.log(99),$(".add").css({display:"none"}),$(".add .call").css({display:"none"});var e=t.toItemString(),o="/recommendorder/recommendorder-order?order="+e;$(".home-info-nav-a").click(function(){window.location.href=o})}),$(".add .sure").click(function(){console.log("Place order clicked");var e=t.toItemString(),o="/recommendorder/recommendorder-order?tab=basket&order="+e;console.log(o),window.location.href=o,console.log("jumped")});var r=$(".search").val().length;console.log(r),$(".home-info-nav-a").click(function(){0==r&&(window.location.href="recommendorder-order")}),$(".search").bind("input propertychange",function(){0!=$(".search").val().length&&$(".home-info-nav-a").click(function(){window.location.href="recommendorder-wholesale-department"})}),$(".list").click(function(){$(this).addClass("active"),$(this).parent().siblings().children(".list").removeClass("active")}),$(".list").on("click",".imgBig",function(e){var o=$(e.target).attr("bigsrc");console.log(o),$(".imgBigShow img").attr("src",o),$(".modelImg").css({display:"block"}),$(".imgBigShow img").css({display:"block"})}),$(".modelImg").click(function(){console.log(77),$(this).css({display:"none"})}),$(".search").bind("input propertychange",function(){0==$(".search").val().length?($(".show").css({display:"block"}),$(".hide").css({display:"none"})):($(".show").css({display:"none"}),$(".hide").css({display:"block"}))}),$(".no").click(function(){console.log(666),$(".search").val("")}),$("#search").bind("input propertychange",function(){o()}),$(".no").click(function(){$("#search").val(""),o()}),$("#banner-img").click(function(){$(".search").val("燕京"),o()}),$("#banner-img1").click(function(){$(".search").val("偷吃熊"),o()}),nodoubletapzoom()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY29tbWVuZG9yZGVyL3JlY29tbWVuZG9yZGVyX3dob2xlc2FsZV9kZXBhcnRtZW50LmpzIl0sIm5hbWVzIjpbIiQiLCJsaXN0IiwiY29uc29sZSIsImxvZyIsIm51bSIsImFwcCIsIm9yZGVyIiwiY3NzIiwiYmFja2dyb3VuZCIsInF1ZXJ5X2NoYW5nZWQiLCJxdWVyeSIsInZhbCIsImxlbmd0aCIsImRpc3BsYXkiLCJzZWFyY2hWdWUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJmb290ZXIiLCJWdWUiLCJlbCIsImRhdGEiLCJ0b3RhbCIsImNvbXB1dGVkIiwiZGlzcGxheV90b3RhbCIsInRoaXMiLCJ0b0ZpeGVkIiwiaXRlbXMiLCJzZWxlY3RlZF9pdGVtcyIsInNvdXJjZSIsImF0dHIiLCJjdXN0b21lcl9pZCIsImNhdF9uYW1lIiwicmVhZHkiLCJzZWxmIiwiJHdhdGNoIiwibG9hZEl0ZW1zIiwic29ydCIsImEiLCJiIiwicHJpY2UiLCJzY29yZSIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwiZGF0YXR5cGUiLCJzdWNjZXNzIiwiYmFza2V0IiwiZm9yRWFjaCIsImQiLCJpZCIsIml0ZW1faWQiLCJyZWNvbW1lbmRfbnVtIiwicmVmcmVzaFNlbGVjdGVkSXRlbXMiLCJtZXRob2RzIiwidG9JdGVtU3RyaW5nIiwicmVzdWx0IiwiayIsImVsZSIsInNlbGVjdGVkX251bSIsImtleSIsIml0ZW0iLCJudW1DaGFuZ2UiLCJpIiwic3RvY2tfbnVtIiwicGFyc2VJbnQiLCJyZWR1Y2VDbGlja2VkIiwib24iLCJwbHVzQ2xpY2tlZCIsIml0ZW1GaWx0ZXIiLCJwYXJzZUZsb2F0IiwiZGlzcGxheV9wcmljZSIsImxpbWl0IiwiZXJyb3IiLCJjYXRlZ29yeSIsImNvZGUiLCJjbGljayIsImFkZENsYXNzIiwic2libGluZ3MiLCJyZW1vdmVDbGFzcyIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsIml0ZW1TdHIiLCJuZXh0X2hyZWYiLCJuZXdfaHJlZiIsIm1tIiwiYmluZCIsInBhcmVudCIsImNoaWxkcmVuIiwiZXYiLCJiaWdJbWdTcmMiLCJ0YXJnZXQiLCJub2RvdWJsZXRhcHpvb20iXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFLFdBQ0UsWUFrU0EsU0FBU0MsS0FFTEMsUUFBUUMsSUFBSSxvQkFDWkMsSUFDQUYsUUFBUUMsSUFBSUMsR0FDUkEsRUFBTSxJQUFNLEdBQ1pDLEVBQUlDLE1BQVEsUUFDWk4sRUFBRSxhQUFhTyxLQUNYQyxXQUFhLDRFQUdqQkgsRUFBSUMsTUFBUSxTQUNaSixRQUFRQyxJQUFJLE9BQ1pILEVBQUUsYUFBYU8sS0FDWEMsV0FBYSx5RUFvS3pCLFFBQVNDLEtBQ0wsR0FBSUMsR0FBUVYsRUFBRSxXQUFXVyxLQUNSLElBQWRELEVBQU1FLFFBQ0xaLEVBQUUsU0FBU08sS0FDUE0sUUFBVSxVQUVkYixFQUFFLFNBQVNPLEtBQ1BNLFFBQVUsV0FHZGIsRUFBRSxTQUFTTyxLQUNQTSxRQUFVLFNBRWRiLEVBQUUsU0FBU08sS0FDUE0sUUFBVSxXQUdsQkMsRUFBVUosTUFBUUEsRUFuZXRCSyxTQUFTQyxpQkFBaUIsZUFBZ0IsU0FBVUMsR0FDaERBLEVBQUVDLGtCQUVOLElBQUlDLEdBQVMsR0FBSUMsTUFDYkMsR0FBSSxVQUNKQyxNQUNJQyxNQUFPLEdBRVhDLFVBQ0lDLGNBQWUsV0FDWCxNQUFPLEdBQUtDLEtBQUtILE1BQU1JLFFBQVEsT0FLdkN0QixFQUFNLEdBQUllLE1BQ1ZDLEdBQUksYUFDSkMsTUFDSU0sU0FDQUMsa0JBQ0FDLE9BQVE5QixFQUFFLFdBQVcrQixLQUFLLFFBQzFCQyxZQUFhaEMsRUFBRSxXQUFXK0IsS0FBSyxlQUMvQkUsU0FBVSxNQUNWM0IsTUFBTyxVQUVYNEIsTUFBTyxXQUNILEdBQUlDLEdBQU9ULElBQ1h4QixTQUFRQyxJQUFJLGVBQ1pnQyxFQUFLQyxPQUFPLFdBQVksV0FDcEJELEVBQUtFLFVBQVVGLEVBQUtGLFNBQVVFLEVBQUtMLE9BQVFLLEVBQUs3QixT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SSxJQUNqQkYsTUFFSlQsRUFBRSxlQUFlNkUsTUFBTSxXQUNuQjdFLEVBQUUsV0FBV1csSUFBSSxNQUNqQkYsTUFFSlQsRUFBRSxnQkFBZ0I2RSxNQUFNLFdBQ3BCN0UsRUFBRSxXQUFXVyxJQUFJLE9BQ2pCRixNQUdKcUYiLCJmaWxlIjoicmVjb21tZW5kb3JkZXIvcmVjb21tZW5kb3JkZXJfd2hvbGVzYWxlX2RlcGFydG1lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uKCl7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdnZXN0dXJlc3RhcnQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdmFyIGZvb3RlciA9IG5ldyBWdWUoe1xuICAgICAgICBlbDogJyNmb290ZXInLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICB0b3RhbDogMFxuICAgICAgICB9LFxuICAgICAgICBjb21wdXRlZDoge1xuICAgICAgICAgICAgZGlzcGxheV90b3RhbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnICsgdGhpcy50b3RhbC50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgYXBwID0gbmV3IFZ1ZSh7XG4gICAgICAgIGVsOiAnI2l0ZW0tbGlzdCcsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgICAgIHNlbGVjdGVkX2l0ZW1zOiB7fSxcbiAgICAgICAgICAgIHNvdXJjZTogJCgnI3NvdXJjZScpLmF0dHIoXCJuYW1lXCIpLFxuICAgICAgICAgICAgY3VzdG9tZXJfaWQ6ICQoJyNzb3VyY2UnKS5hdHRyKFwiY3VzdG9tZXJfaWRcIiksXG4gICAgICAgICAgICBjYXRfbmFtZTogJ3JlYycsXG4gICAgICAgICAgICBvcmRlcjogJy1zY29yZScsXG4gICAgICAgIH0sXG4gICAgICAgIHJlYWR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdWdWUgbW91bnRlZCcpO1xuICAgICAgICAgICAgc2VsZi4kd2F0Y2goJ2NhdF9uYW1lJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2FkSXRlbXMoc2VsZi5jYXRfbmFtZSwgc2VsZi5zb3VyY2UsIHNlbGYub3JkZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLiR3YXRjaCgnb3JkZXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcmRlciA9PT0gJ3ByaWNlJykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW1zID0gc2VsZi5pdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnByaWNlIC0gYi5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLm9yZGVyID09PSAnLXByaWNlJykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW1zID0gc2VsZi5pdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiLnByaWNlIC0gYS5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLm9yZGVyID09PSAnc2NvcmUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXMgPSBzZWxmLml0ZW1zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuc2NvcmUgLSBiLnNjb3JlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYub3JkZXIgPT09ICctc2NvcmUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXMgPSBzZWxmLml0ZW1zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuc2NvcmUgLSBhLnNjb3JlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYub3JkZXIgPT09ICdudW0nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXMgPSBzZWxmLml0ZW1zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEubnVtIC0gYi5udW07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2VsZi5vcmRlciA9PT0gJy1udW0nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXRlbXMgPSBzZWxmLml0ZW1zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIubnVtIC0gYS5udW07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBsb2FkIGJhc2tldCBkYXRhXG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogXCIvcmVjb21tZW5kb3JkZXIvYXBpL3YxL2Jhc2tldFwiLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgZGF0YXR5cGU6IFwianNvbnBcIixcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXNrZXQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGJhc2tldCk7XG4gICAgICAgICAgICAgICAgICAgIGJhc2tldC5mb3JFYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZF9pdGVtc1tkLmlkXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBkLml0ZW1faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtOiBkLnJlY29tbWVuZF9udW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U6IGQucHJpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZEl0ZW1zKHNlbGYuY2F0X25hbWUsIHNlbGYuc291cmNlLCBzZWxmLm9yZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWZyZXNoU2VsZWN0ZWRJdGVtcyhzZWxmLml0ZW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBtZXRob2RzOiB7XG4gICAgICAgICAgICB0b0l0ZW1TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMuc2VsZWN0ZWRfaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgdGhpcy5zZWxlY3RlZF9pdGVtc1trXS5pdGVtX2lkICsgJywnICsgIHRoaXMuc2VsZWN0ZWRfaXRlbXNba10ubnVtICsgJ3wnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlZnJlc2hTZWxlY3RlZEl0ZW1zOiBmdW5jdGlvbihpdGVtcykge1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlLnNlbGVjdGVkX251bSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZF9pdGVtc1tlbGUuaWRdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IGVsZS5pdGVtX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bTogZWxlLnNlbGVjdGVkX251bSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogZWxlLnByaWNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZS5pZCBpbiBzZWxmLnNlbGVjdGVkX2l0ZW1zKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZF9pdGVtc1tlbGUuaWRdLm51bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmb290ZXIudG90YWwgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZWxmLnNlbGVjdGVkX2l0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5zZWxlY3RlZF9pdGVtc1trZXldXG4gICAgICAgICAgICAgICAgICAgIGZvb3Rlci50b3RhbCArPSBpdGVtLm51bSAqIGl0ZW0ucHJpY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG51bUNoYW5nZTogZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpLnNlbGVjdGVkX251bSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codHlwZW9mIGkuc3RvY2tfbnVtKTtcbiAgICAgICAgICAgICAgICBpLnNlbGVjdGVkX251bT1wYXJzZUludChpLnNlbGVjdGVkX251bSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codHlwZW9mIGkuc2VsZWN0ZWRfbnVtKTtcbiAgICAgICAgICAgICAgICBpZiAoaS5zZWxlY3RlZF9udW0gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFbXB0eSEnKTtcbiAgICAgICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW0gPSAwO1xuICAgICAgICAgICAgICAgIH1lbHNlIGlmKGkuc2VsZWN0ZWRfbnVtPmkuc3RvY2tfbnVtKXtcbiAgICAgICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW09aS5zdG9ja19udW07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFNlbGVjdGVkSXRlbXModGhpcy5pdGVtcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVkdWNlQ2xpY2tlZDogZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWR1Y2UnKTtcbiAgICAgICAgICAgICAgICAkKCcucmVkdWNlJykub24oJ3RvdWNoc3RhcnQnLCcuYXJlYScsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMTAwKTtcbiAgICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdvcGFjaXR5JywnMC41Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJCgnLnJlZHVjZScpLm9uKCd0b3VjaGVuZCcsJy5hcmVhJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygyMDApO1xuICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcxJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGkuc2VsZWN0ZWRfbnVtIC0gMSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGkuc2VsZWN0ZWRfbnVtID0gcGFyc2VJbnQoaS5zZWxlY3RlZF9udW0pIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2VsZWN0ZWRJdGVtcyh0aGlzLml0ZW1zKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwbHVzQ2xpY2tlZDogZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQbHVzIGNsaWNrZWQhJyk7XG4gICAgICAgICAgICAgICAgJCgnLnBsdXMnKS5vbigndG91Y2hzdGFydCcsJy5hcmVhJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygxMDApO1xuICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcwLjUnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKCcucGx1cycpLm9uKCd0b3VjaGVuZCcsJy5hcmVhJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygyMDApO1xuICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcxJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW0gPSBwYXJzZUludChpLnNlbGVjdGVkX251bSkgKyAxO1xuICAgICAgICAgICAgICAgIGlmKGkuc2VsZWN0ZWRfbnVtPmkuc3RvY2tfbnVtKXtcbiAgICAgICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW09aS5zdG9ja19udW07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFNlbGVjdGVkSXRlbXModGhpcy5pdGVtcyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBpdGVtRmlsdGVyOiBmdW5jdGlvbihpdGVtcykge1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlLmlkIGluIHNlbGYuc2VsZWN0ZWRfaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5zZWxlY3RlZF9udW0gPSBzZWxmLnNlbGVjdGVkX2l0ZW1zW2VsZS5pZF0ubnVtO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlLnNlbGVjdGVkX251bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxlLnByaWNlID0gcGFyc2VGbG9hdChlbGUucHJpY2UpO1xuICAgICAgICAgICAgICAgICAgICBlbGUuZGlzcGxheV9wcmljZSA9IGVsZS5wcmljZS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkSXRlbXM6IGZ1bmN0aW9uKGNhdF9uYW1lLCBzb3VyY2UsIG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHNlbGYuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoY2F0X25hbWUgPT09ICdyZWMnKSB7XG4gICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6XCIvcmVjb21tZW5kb3JkZXIvYXBpL3YxL2l0ZW1zX2V4dGVuZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOidnZXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXR5cGU6J2pzb25wJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3JkZXJcIjogJ3NvcnRfbGV2ZWxfb25lLHNvcnRfbGV2ZWxfdHdvLCcgKyBzZWxmLm9yZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGltaXRcIjogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW1zID0gc2VsZi5pdGVtRmlsdGVyKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOmZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDonL3JlY29tbWVuZG9yZGVyL2FwaS92MS9pdGVtc19leHRlbmRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOidnZXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXR5cGU6J2pzb25wJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9yZGVyXCI6IHNlbGYub3JkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NhdGVnb3J5JzogY2F0X25hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pdGVtcyA9IHNlbGYuaXRlbUZpbHRlcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgc2VhcmNoVnVlID0gbmV3IFZ1ZSh7XG4gICAgICAgIGVsOiAnI3NlYXJjaC1yZXN1bHRzJywgXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgICAgIHF1ZXJ5OiAnJ1xuICAgICAgICB9LFxuICAgICAgICBtZXRob2RzOiB7XG4gICAgICAgICAgICByZWR1Y2VDbGlja2VkOiBmdW5jdGlvbihpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlZHVjZScpO1xuICAgICAgICAgICAgICAgICQoJy5yZWR1Y2UnKS5vbigndG91Y2hzdGFydCcsJy5hcmVhJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygxMDApO1xuICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcwLjUnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKCcucmVkdWNlJykub24oJ3RvdWNoZW5kJywnLmFyZWEnLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDIwMCk7XG4gICAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcygnb3BhY2l0eScsJzEnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoaS5zZWxlY3RlZF9udW0gLSAxID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW0gPSBpLnNlbGVjdGVkX251bSAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcC5yZWZyZXNoU2VsZWN0ZWRJdGVtcyh0aGlzLml0ZW1zKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBsdXNDbGlja2VkOiBmdW5jdGlvbihpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BsdXMgY2xpY2tlZCEnKTtcbiAgICAgICAgICAgICAgICAkKCcucGx1cycpLm9uKCd0b3VjaHN0YXJ0JywnLmFyZWEnLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDEwMCk7XG4gICAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcygnb3BhY2l0eScsJzAuNScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICQoJy5wbHVzJykub24oJ3RvdWNoZW5kJywnLmFyZWEnLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDIwMCk7XG4gICAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcygnb3BhY2l0eScsJzEnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpLnN0b2NrX251bSk7XG4gICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW0gPSBwYXJzZUludChpLnNlbGVjdGVkX251bSkgKyAxO1xuICAgICAgICAgICAgICAgIGlmKGkuc2VsZWN0ZWRfbnVtPmkuc3RvY2tfbnVtKXtcbiAgICAgICAgICAgICAgICAgICAgaS5zZWxlY3RlZF9udW09aS5zdG9ja19udW07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcC5yZWZyZXNoU2VsZWN0ZWRJdGVtcyh0aGlzLml0ZW1zKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBudW1DaGFuZ2U6IGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgICAgICAgICBpLnNlbGVjdGVkX251bT1wYXJzZUludChpLnNlbGVjdGVkX251bSk7XG4gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHR5cGVvZiBpLnNlbGVjdGVkX251bSk7XG4gICAgICAgICAgICAgICAgaWYoaS5zZWxlY3RlZF9udW0+aS5zdG9ja19udW0pe1xuICAgICAgICAgICAgICAgICAgICBpLnNlbGVjdGVkX251bT1pLnN0b2NrX251bTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXBwLnJlZnJlc2hTZWxlY3RlZEl0ZW1zKHRoaXMuaXRlbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZWFkeTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWFyY2ggdnVlIG1vdW50ZWQnKTtcbiAgICAgICAgICAgIHNlbGYuJHdhdGNoKCdxdWVyeScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdRdWVyeSBjaGFuZ2VkOiAnICsgc2VsZi5xdWVyeSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYucXVlcnkubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoaW5nLi4uJyk7XG4gICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL3JlY29tbWVuZG9yZGVyL2FwaS92MS9zZWFyY2hfaXRlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJnZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGF0eXBlOiBcImpzb25wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHNlbGYucXVlcnlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLml0ZW1zID0gYXBwLml0ZW1GaWx0ZXIoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoIGVycm9yJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgICQoJy5wcmljZScpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgbGlzdCgpO1xuICAgIH0pO1xuICAgICB2YXIgbnVtPTA7XG4gICAgZnVuY3Rpb24gbGlzdCgpe1xuICAgICAgIC8vIGFsZXJ0KG51bSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpYyBhcnJvdyBjbGlja2VkJyk7XG4gICAgICAgIG51bSsrO1xuICAgICAgICBjb25zb2xlLmxvZyhudW0pO1xuICAgICAgICBpZiAobnVtICUgMiA9PT0gMCl7XG4gICAgICAgICAgICBhcHAub3JkZXIgPSAncHJpY2UnO1xuICAgICAgICAgICAgJCgnLmljLWFycm93JykuY3NzKHtcbiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZCc6J3VybCgvc3RhdGljL2ltYWdlcy9yZWNvbW1lbmRvcmRlci9pY19hcnJvd19kb3duLnBuZykgbm8tcmVwZWF0IGNlbnRlcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXBwLm9yZGVyID0gJy1wcmljZSc7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygyMjIyMik7XG4gICAgICAgICAgICAkKCcuaWMtYXJyb3cnKS5jc3Moe1xuICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kJzondXJsKC9zdGF0aWMvaW1hZ2VzL3JlY29tbWVuZG9yZGVyL2ljX2Fycm93X3VwLnBuZykgbm8tcmVwZWF0IGNlbnRlcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgXG5cblxuICAgICQoJyNieS1zY29yZScpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnYnkgc2NvcmUgY2xpY2tlZCcpO1xuICAgICAgICBpZiAoYXBwLm9yZGVyID09PSAnLXNjb3JlJykge1xuICAgICAgICAgICAgYXBwLm9yZGVyID0gJ3Njb3JlJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFwcC5vcmRlciA9ICctc2NvcmUnO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkKCcjYnktbnVtJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdieSBzY29yZSBjbGlja2VkJyk7XG4gICAgICAgIGlmIChhcHAub3JkZXIgPT09ICctbnVtJykge1xuICAgICAgICAgICAgYXBwLm9yZGVyID0gJ251bSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcHAub3JkZXIgPSAnLW51bSc7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgICQoJy5uYXYtaXRlbScpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIC8v5pS55Y+Y5a+86Iiq55qE6YCJ5Lit54q25oCBXG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB2YXIgY2F0X25hbWUgPSAkKHRoaXMpLmF0dHIoXCJjYXRfbmFtZVwiKTtcbiAgICAgICAgYXBwLmNhdF9uYW1lID0gY2F0X25hbWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDYXRlZ29yeSBuYW1lJyArIGNhdF9uYW1lICsgJ29mIHNvdXJjZSAnICsgc291cmNlKTtcbiAgICB9KTtcblxuICAgIC8v54K55Ye755S16K+d5oyJ6ZKuXG4gICAgJCgnLmhvbWUtaW5mby1uYXYtYicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnNvbGUubG9nKDEwMDApO1xuICAgICAgICAkKCcubW9kZWwnKS5jc3Moe1xuICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaydcbiAgICAgICAgfSk7XG4gICAgICAgICQoJy5tb2RlbCAuY2FsbCcpLmNzcyh7XG4gICAgICAgICAgICAnZGlzcGxheSc6J2Jsb2NrJ1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICAvL+eCueWHu+WPlua2iOaMiemSruaooeaAgea2iOWksVxuICAgICQoJy5jYW5jZWwnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBjb25zb2xlLmxvZyg5OSk7XG4gICAgICAgICQoJy5tb2RlbCcpLmNzcyh7XG4gICAgICAgICAgICAnZGlzcGxheSc6J25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgICAkKCcubW9kZWwgLmNhbGwnKS5jc3Moe1xuICAgICAgICAgICAgJ2Rpc3BsYXknOidub25lJ1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8v54K55Ye756Gu5a6a5oyJ6ZKu5Y+v5Lul5omT55S16K+dXG4gICAgJCgnLm1vZGVsIC5zdXJlJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgY29uc29sZS5sb2coOTk0KTtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9XCJ0ZWw6Ly84MzA2NjAwMlwiO1xuICAgIH0pO1xuICAgIC8v54K55Ye75re75Yqg5qih5oCB5Ye6546wXG4gICAgJCgnLm1vbmV5JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgY29uc29sZS5sb2coMTAwMCk7XG4gICAgICAgICQoJy5hZGQnKS5jc3Moe1xuICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaydcbiAgICAgICAgfSk7XG4gICAgICAgICQoJy5hZGQgLmNhbGwnKS5jc3Moe1xuICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaydcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgLy/ngrnlh7vnu6fnu63otK3nianmjInpkq7mqKHmgIHmtojlpLHmraTml7bllYblk4HkuIDnu4/mt7vliqDlnKjotK3nianovabkuK1cbiAgICAkKCcuYWRkIC5jYW5jZWwnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBjb25zb2xlLmxvZyg5OSk7XG4gICAgICAgICQoJy5hZGQnKS5jc3Moe1xuICAgICAgICAgICAgJ2Rpc3BsYXknOidub25lJ1xuICAgICAgICB9KTtcbiAgICAgICAgJCgnLmFkZCAuY2FsbCcpLmNzcyh7XG4gICAgICAgICAgICAnZGlzcGxheSc6J25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgICAgdmFyIGl0ZW1TdHIgPSBhcHAudG9JdGVtU3RyaW5nKCk7XG4gICAgICAgIHZhciBuZXh0X2hyZWYgPSAnL3JlY29tbWVuZG9yZGVyL3JlY29tbWVuZG9yZGVyLW9yZGVyP29yZGVyPScgKyBpdGVtU3RyO1xuICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24uaHJlZj1uZXh0X2hyZWY7XG4gICAgICAgICQoJy5ob21lLWluZm8tbmF2LWEnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPW5leHRfaHJlZjtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvL+eCueWHu+WOu+i0reeJqei9puaMiemSrumhtemdoui3s+i9rOWcqOi0reeJqei9pumhtemdouWQjOaXtuWVhuWTgeWHuueOsOWcqOi0reeJqei9puS4rVxuICAgICQoJy5hZGQgLnN1cmUnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgY29uc29sZS5sb2coJ1BsYWNlIG9yZGVyIGNsaWNrZWQnKTtcbiAgICAgICAgdmFyIGl0ZW1TdHIgPSBhcHAudG9JdGVtU3RyaW5nKCk7XG4gICAgICAgIHZhciBuZXdfaHJlZiA9ICcvcmVjb21tZW5kb3JkZXIvcmVjb21tZW5kb3JkZXItb3JkZXI/dGFiPWJhc2tldCZvcmRlcj0nICsgaXRlbVN0cjtcbiAgICAgICAgY29uc29sZS5sb2cobmV3X2hyZWYpO1xuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG5ld19ocmVmO1xuICAgICAgICBjb25zb2xlLmxvZygnanVtcGVkJyk7XG4gICAgfSk7XG5cbiAgICAvL+eCueWHu+i/lOWbnuaMiemSrijnu5nlkIzkuIDkuKrov5Tlm57mjInpkq7kvYbkuI3lkIznmoTmg4XlhrXkuIvnu5nkuI3lkIznmoTov5Tlm57nlYzpnaIpXG4gICAgdmFyIG1tPSQoJy5zZWFyY2gnKS52YWwoKS5sZW5ndGg7XG4gICAgY29uc29sZS5sb2cobW0pO1xuICAgICQoJy5ob21lLWluZm8tbmF2LWEnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICBpZihtbT09MCl7XG4gICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9XCJyZWNvbW1lbmRvcmRlci1vcmRlclwiO1xuICAgICAgICB9ICAgIFxuICAgIH0pO1xuICAgICAkKCcuc2VhcmNoJykuYmluZCgnaW5wdXQgcHJvcGVydHljaGFuZ2UnLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZigkKCcuc2VhcmNoJykudmFsKCkubGVuZ3RoIT0wKXtcbiAgICAgICAgICAgICAgICAkKCcuaG9tZS1pbmZvLW5hdi1hJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9J3JlY29tbWVuZG9yZGVyLXdob2xlc2FsZS1kZXBhcnRtZW50JztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gICAgXG4gICAgIH0pO1xuXG5cbiAgICAgJCgnLmxpc3QnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncygpLmNoaWxkcmVuKCcubGlzdCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgfSk7XG5cbiAgICAgLy/ngrnlh7vlm77niYflh7rnjrDmqKHmgIHmmL7npLrlpKflm75cbiAgICAkKCcubGlzdCcpLm9uKCdjbGljaycsJy5pbWdCaWcnLGZ1bmN0aW9uKGV2KXtcbiAgICAgICAgdmFyIGJpZ0ltZ1NyYyA9ICQoZXYudGFyZ2V0KS5hdHRyKFwiYmlnc3JjXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhiaWdJbWdTcmMpO1xuICAgICAgICAkKCcuaW1nQmlnU2hvdyBpbWcnKS5hdHRyKFwic3JjXCIsIGJpZ0ltZ1NyYyk7XG4gICAgICAgICQoJy5tb2RlbEltZycpLmNzcyh7XG4gICAgICAgICAgICAnZGlzcGxheSc6J2Jsb2NrJ1xuICAgICAgICB9KTtcbiAgICAgICAgJCgnLmltZ0JpZ1Nob3cgaW1nJykuY3NzKHtcbiAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgICAvL+eCueWHu+S7u+aEj+aMiemSruaooeaAgea2iOWksVxuICAgICAkKCcubW9kZWxJbWcnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBjb25zb2xlLmxvZyg3Nyk7XG4gICAgICAgICQodGhpcykuY3NzKHtcbiAgICAgICAgICAgICdkaXNwbGF5Jzonbm9uZSdcbiAgICAgICAgfSk7XG4gICAgIH0pO1xuICAgICAvL+agueaNruaQnOe0ouahhueahOWGheWuueWIpOaWreaYr+WQpuWHuueOsOaQnOe0ouWVhuWTgVxuICAgICAkKCcuc2VhcmNoJykuYmluZCgnaW5wdXQgcHJvcGVydHljaGFuZ2UnLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZigkKCcuc2VhcmNoJykudmFsKCkubGVuZ3RoPT0wKXtcbiAgICAgICAgICAgICAgICAkKCcuc2hvdycpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJCgnLmhpZGUnKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAnZGlzcGxheSc6J25vbmUnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAkKCcuc2hvdycpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdkaXNwbGF5Jzonbm9uZSdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKCcuaGlkZScpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9ICAgIFxuICAgICB9KTtcblxuICAgICAvL+W9k+eCueWHu1jml7bmlofmnKzmoYbnmoTlgLzkuLow77ybXG4gICAgICQoJy5ubycpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnNvbGUubG9nKDY2Nik7XG4gICAgICAgICQoJy5zZWFyY2gnKS52YWwoJycpO1xuICAgICB9KTtcblxuXG4gICAgZnVuY3Rpb24gcXVlcnlfY2hhbmdlZCgpIHtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gJCgnI3NlYXJjaCcpLnZhbCgpO1xuICAgICAgICBpZihxdWVyeS5sZW5ndGg9PTApe1xuICAgICAgICAgICAgJCgnLnNob3cnKS5jc3Moe1xuICAgICAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoJy5oaWRlJykuY3NzKHtcbiAgICAgICAgICAgICAgICAnZGlzcGxheSc6J25vbmUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAkKCcuc2hvdycpLmNzcyh7XG4gICAgICAgICAgICAgICAgJ2Rpc3BsYXknOidub25lJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKCcuaGlkZScpLmNzcyh7XG4gICAgICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9ICAgIFxuICAgICAgICBzZWFyY2hWdWUucXVlcnkgPSBxdWVyeTtcbiAgICB9XG5cbiAgICAvL+agueaNruaQnOe0ouahhueahOWGheWuueWIpOaWreaYr+WQpuWHuueOsOaQnOe0ouWVhuWTgVxuICAgICQoJyNzZWFyY2gnKS5iaW5kKCdpbnB1dCBwcm9wZXJ0eWNoYW5nZScsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHF1ZXJ5X2NoYW5nZWQoKTtcbiAgICB9KTtcblxuICAgIC8v5b2T54K55Ye7WOaXtuaWh+acrOahhueahOWAvOS4ujDvvJtcbiAgICAkKCcubm8nKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKCcjc2VhcmNoJykudmFsKCcnKTtcbiAgICAgICAgcXVlcnlfY2hhbmdlZCgpO1xuICAgIH0pO1xuICAgICQoJyNiYW5uZXItaW1nJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJy5zZWFyY2gnKS52YWwoJ+eHleS6rCcpO1xuICAgICAgICBxdWVyeV9jaGFuZ2VkKCk7XG4gICAgfSk7XG4gICAgJCgnI2Jhbm5lci1pbWcxJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJy5zZWFyY2gnKS52YWwoJ+WBt+WQg+eGiicpO1xuICAgICAgICBxdWVyeV9jaGFuZ2VkKCk7XG4gICAgfSk7XG4gICAgXG4gICAgbm9kb3VibGV0YXB6b29tKCk7XG59KTtcblxuIl19
