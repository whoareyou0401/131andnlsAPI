$(document).ready(function(){"use strict";function o(o){return decodeURIComponent((new RegExp("[?|&]"+o+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}function s(){$("#placeorder").removeClass("add"),$("#placeorder").addClass("rec"),$("#placeorder").html("添加")}function e(){$("#placeorder").removeClass("rec"),$("#placeorder").addClass("add"),$("#placeorder").html("下单")}function t(){console.log("unloading page"),console.log("Saving basket before leaving");var o=r(),s=(o[0],o[1]),e=o[2];$.ajax({url:"/recommendorder/api/v1/customer/"+window.customer_id+"/basket",type:"post",datatype:"jsonp",data:{basket:s,rec:e},success:function(o){console.log(o)}})}function n(){$(".money_mo").each(function(){a+=parseFloat($(this).html().split("¥")[1]),$(".xiadan_sum").html("¥"+a.toFixed(2))}),a=0}function i(){$(".money_mo").each(function(){$(this).html().split("¥")[1]>0&&$(this).html().split("¥")[1]<300?($(this).siblings(".send_no").css("display","inline-block"),$(this).siblings(".send_ok").css("display","none"),$(this).siblings(".send_no").html("还差¥ "+(300-$(this).html().split("¥")[1]).toFixed(2))):$(this).html().split("¥")[1]>=300?($(this).siblings(".send_no").css("display","none"),$(this).siblings(".send_ok").css("display","inline-block")):"0.00"===$(this).html().split("¥")[1]&&($(this).siblings(".send_no").css("display","inline-block"),$(this).siblings(".send_ok").css("display","none"),$(this).siblings(".send_no").html("¥ 300起送"))}),t()}function r(){console.log("place order clicked");var o=!0,s="",e="";return $(".order_food_choose").each(function(){console.log($(this).attr("src"));var t=$(this).parent(),n=t.find(".item_name"),i=n.html(),r=n.attr("item_id"),d=t.find(".num_lack").attr("stock_num"),a=t.find(".num_value").val();if($(this).hasClass("selected")){if(console.log("Found selected item"),console.log(i+","+r+","+d+","+a),parseInt(a)>parseInt(d))return alert(i+"库存不足 ("+a+"/"+d+")"),o=!1,!1;s=s+r+","+a+"|"}else $(this).hasClass("rec")&&(parseInt(a)>parseInt(d)&&(a=d),e=e+r+","+a+"|")}),[o,s,e]}setupCSRF(),document.addEventListener("gesturestart",function(o){o.preventDefault()}),$(document).ready(function(){var s=o("tab");console.log(s);var e=$(".order_foodrecom").find(".order_food_li").length>0;"basket"!==s&&e||$(".order_add").click(),console.log("clicking"),$(".order_foodadd").find(".order_food_choose").click()}),$(".shop").each(function(o,t){$(t).children(".orec").find(".home-store-info").children("span").click(function(o){var n=o.target;"推荐商品"==$(n).html()?($(t).children(".orec").css("display","block"),$(t).children(".newadd").css("display","none"),s()):"购 物 车"==$(n).html()&&($(t).children(".orec").css("display","none"),$(t).children(".newadd").css("display","block"),e())}),$(t).children(".newadd").find(".home-store-info").children("span").click(function(o){var n=o.target;"推荐商品"==$(n).html()?($(t).children(".orec").css("display","block"),$(t).children(".newadd").css("display","none"),s()):"购 物 车"==$(n).html()&&($(t).children(".orec").css("display","none"),$(t).children(".newadd").css("display","block"),e())})});var d=0,a=0,l=0;$(document).on("change",".num_value",function(){isNaN(parseInt($(this).val()))?isNaN(parseInt($(this).val()))&&$(this).val(1):"0"===$(this).val()?($(this).parents(".order_food_li").find(".order_food_choose").attr("src")==assistor&&($(this).parents(".shop").find(".order_food_choose").each(function(){$(this).attr("src")==assistor&&(d+=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val()),$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+d.toFixed(2)))}),d=0,n()),$(this).parents(".order_food_li").remove()):$(this).val()>0?$(this).parents(".order_food_li").find(".order_food_choose").attr("src")==assistor&&($(this).parents(".shop").find(".order_food_choose").each(function(){$(this).attr("src")==assistor&&(d+=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val()),$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+d.toFixed(2)))}),d=0,n()):($(this).val()<0||""===$(this).val())&&$(this).val(1);var o=$(this).val(),s=$(this).parents(".order_food_num").find(".num_lack").attr("stock_num");o>s?($(this).val(s),$(this).parents(".order_food_num").find(".num_lack").css("display","block")):$(this).parents(".order_food_num").find(".num_lack").css("display","none"),i()}),$(document).on("touchstart",".num_add",function(){var o=$(this).siblings(".num_value").val(),s=$(this).parents(".order_food_num").find(".num_lack").attr("stock_num");o>s-1?($(this).siblings(".num_value").val(s-1),$(this).parents(".order_food_num").find(".num_lack").css("display","block")):$(this).parents(".order_food_num").find(".num_lack").css("display","none"),$(this).siblings(".num_value").val(parseInt($(this).siblings(".num_value").val())+1),$(this).parents(".order_food_li").find(".order_food_choose").attr("src")==assistor&&($(this).parents(".shop").find(".order_food_choose").each(function(){$(this).attr("src")==assistor&&(d+=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val()),$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+d.toFixed(2)))}),d=0,n()),i()}),$(".num_add").on("touchstart",function(){$(this).css("opacity","0.5")}),$(".num_add").on("touchend",function(){$(this).css("opacity","1")}),$(document).on("touchstart",".num_minus",function(){if("0"===$(this).siblings(".num_value").val()?$(this).siblings(".num_value").parents(".order_food_li").remove():$(this).siblings(".num_value").val(parseInt($(this).siblings(".num_value").val())-1),$(this).parents(".order_food_num").find(".num_lack").css("display","none"),"0"===$(this).siblings(".num_value").val()){if($(this).parents(".order_food_li").find(".order_food_choose").attr("src")==assistor){var o=parseFloat($(this).parents(".shop").find(".money").find(".money_mo").html().split("¥")[1]),s=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1]);$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+(o-s).toFixed(2)),n()}$(this).siblings(".num_value").parents(".order_food_li").remove()}else if($(this).siblings(".num_value").val()>0&&$(this).parents(".order_food_li").find(".order_food_choose").attr("src")==assistor){var e=parseFloat($(this).parents(".shop").find(".money").find(".money_mo").html().split("¥")[1]),t=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1]);$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+(e-t).toFixed(2)),n()}i()}),$(".num_minus").on("touchstart",function(){$(this).css("opacity","0.5")}),$(".num_minus").on("touchend",function(){$(this).css("opacity","1")}),$(document).on("click",".order_choose",function(){$(this).attr("src")==ic_un_choose?($(this).attr("src",assistor),$(this).parents(".home-store").siblings(".order_food").find(".order_food_choose").attr("src",assistor),$(this).parents(".shop").find(".order_food_choose").each(function(){$(this).attr("src")==assistor&&(d+=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val()),$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+d.toFixed(2)))}),d=0):$(this).attr("src")==assistor&&($(this).attr("src",ic_un_choose),$(this).parents(".home-store").siblings(".order_food").find(".order_food_choose").attr("src",ic_un_choose),$(this).parents(".shop").find(".order_food_choose").each(function(){$(this).attr("src")==assistor&&(d+=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val())),$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+d.toFixed(2))}),d=0),n(),i()}),$(document).on("click",".order_food_choose",function(){if($(this).toggleClass("selected"),$(this).attr("src")==ic_un_choose){$(this).attr("src",assistor),l=parseFloat($(this).parents(".shop").find(".money").find(".money_mo").html().split("¥")[1]);var o=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val());$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+(l+o).toFixed(2))}else if($(this).attr("src")==assistor){$(this).attr("src",ic_un_choose),$(this).parents(".order_food").siblings(".home-store").find(".order_choose").attr("src",ic_un_choose),l=parseFloat($(this).parents(".shop").find(".money").find(".money_mo").html().split("¥")[1]);var s=parseFloat($(this).parents(".order_food_li").find(".order_food_mo").html().split("¥")[1])*parseInt($(this).parents(".order_food_li").find(".num_value").val());$(this).parents(".shop").find(".money").find(".money_mo").html("¥"+(l-s).toFixed(2))}n(),i()}),$("#placeorder").click(function(){if($("#placeorder").hasClass("rec"))console.log("place order"),$(".order_add").click();else{var o=r(),s=o[0],e=o[1];if(s){console.log("Orders: "+e);var t="/recommendorder/customer/"+window.customer_id+"/confirm-order?orders="+e;window.location.href=t}}}),$("#todealer").click(function(){console.log("to dealer"),window.location.href="/recommendorder/dealer/1/customer/"+window.customer_id+"/add-item"}),nodoubletapzoom()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY29tbWVuZG9yZGVyL3JlY29tbWVuZG9yZGVyX29yZGVyLmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiZ2V0VVJMUGFyYW1ldGVyIiwibmFtZSIsImRlY29kZVVSSUNvbXBvbmVudCIsIlJlZ0V4cCIsImV4ZWMiLCJsb2NhdGlvbiIsInNlYXJjaCIsInJlcGxhY2UiLCJzZXRUb1JlY1BhZ2UiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiaHRtbCIsInNldFRvQWRkUGFnZSIsInNhdmVCYXNrZXQiLCJjb25zb2xlIiwibG9nIiwib3JkZXIiLCJwcm9jZXNzT3JkZXIiLCJvcmRlcl9zdHIiLCJyZWNfc3RyIiwiYWpheCIsInVybCIsIndpbmRvdyIsImN1c3RvbWVyX2lkIiwidHlwZSIsImRhdGF0eXBlIiwiZGF0YSIsImJhc2tldCIsInJlYyIsInN1Y2Nlc3MiLCJzdW1fbW9uZXkiLCJlYWNoIiwiaiIsInBhcnNlRmxvYXQiLCJ0aGlzIiwic3BsaXQiLCJ0b0ZpeGVkIiwic2VuZCIsInNpYmxpbmdzIiwiY3NzIiwic2FuaXR5IiwiYXR0ciIsImN1cl9saSIsInBhcmVudCIsIml0ZW0iLCJmaW5kIiwiaXRlbV9uYW1lIiwiaXRlbV9pZCIsImludmVudG9yeSIsIm51bV9zZWxlY3RlZCIsInZhbCIsImhhc0NsYXNzIiwicGFyc2VJbnQiLCJhbGVydCIsInNldHVwQ1NSRiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YWIiLCJoYXNSZWMiLCJsZW5ndGgiLCJjbGljayIsImluZGV4IiwiZWxlIiwiY2hpbGRyZW4iLCJlbCIsInRhcmdldCIsIm1vIiwiayIsIm9uIiwiaXNOYU4iLCJwYXJlbnRzIiwiYXNzaXN0b3IiLCJyZW1vdmUiLCJ2YWwxIiwidmFsMiIsIm01IiwibjUiLCJtNiIsIm42IiwiaWNfdW5fY2hvb3NlIiwidG9nZ2xlQ2xhc3MiLCJrMSIsImsyIiwibmV4dF9ocmVmIiwiaHJlZiIsIm5v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QUFLLElBQUlpQixTQUFTdkQsRUFBRXFDLE1BQU1xQyxRQUFRLGtCQUFrQjFCLEtBQUssY0FBY0ssTUFDL0pyRCxHQUFFcUMsTUFBTXFDLFFBQVEsU0FBUzFCLEtBQUssVUFBVUEsS0FBSyxhQUFhbEMsS0FBSyxLQUFLeUQsRUFBRWUsR0FBSS9DLFFBQVEsSUFHdEZOLElBRUFPLE1Bb0VKeEMsRUFBRSxlQUFlZ0UsTUFBTSxXQUNuQixHQUFJaEUsRUFBRSxlQUFlc0QsU0FBUyxPQUMxQnJDLFFBQVFDLElBQUksZUFDWmxCLEVBQUUsY0FBY2dFLFlBQ2IsQ0FDSCxHQUFJN0MsR0FBUUMsSUFDUnVCLEVBQVN4QixFQUFNLEdBQ2ZFLEVBQVlGLEVBQU0sRUFDdEIsSUFBSXdCLEVBQVEsQ0FDUjFCLFFBQVFDLElBQUksV0FBYUcsRUFDekIsSUFBSWtFLEdBQVksNEJBQThCOUQsT0FBT0MsWUFBYyx5QkFBMkJMLENBQzlGSSxRQUFPakIsU0FBU2dGLEtBQU9ELE1BS25DdkYsRUFBRSxhQUFhZ0UsTUFBTSxXQUNqQi9DLFFBQVFDLElBQUksYUFFWk8sT0FBT2pCLFNBQVNnRixLQUFPLHFDQUF1Qy9ELE9BQU9DLFlBQWMsY0FHdkYrRCIsImZpbGUiOiJyZWNvbW1lbmRvcmRlci9yZWNvbW1lbmRvcmRlcl9vcmRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBzZXR1cENTUkYoKTtcblxuICAgIGZ1bmN0aW9uIGdldFVSTFBhcmFtZXRlcihuYW1lKSB7XG4gICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoKG5ldyBSZWdFeHAoJ1s/fCZdJyArIG5hbWUgKyAnPScgKyAnKFteJjtdKz8pKCZ8I3w7fCQpJykuZXhlYyhsb2NhdGlvbi5zZWFyY2gpIHx8IFtudWxsLCAnJ10pWzFdLnJlcGxhY2UoL1xcKy9nLCAnJTIwJykpIHx8IG51bGw7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZ2VzdHVyZXN0YXJ0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG5cbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHRhYiA9IGdldFVSTFBhcmFtZXRlcigndGFiJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRhYik7XG4gICAgICAgIHZhciBoYXNSZWMgPSAkKCcub3JkZXJfZm9vZHJlY29tJykuZmluZCgnLm9yZGVyX2Zvb2RfbGknKS5sZW5ndGggPiAwO1xuICAgICAgICBpZiAodGFiID09PSAnYmFza2V0JyB8fCAhaGFzUmVjKSB7XG4gICAgICAgICAgICAkKCcub3JkZXJfYWRkJykuY2xpY2soKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tpbmcnKTtcbiAgICAgICAgJCgnLm9yZGVyX2Zvb2RhZGQnKS5maW5kKCcub3JkZXJfZm9vZF9jaG9vc2UnKS5jbGljaygpO1xuICAgIH0pO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRUb1JlY1BhZ2UoKSB7XG4gICAgICAgICQoJyNwbGFjZW9yZGVyJykucmVtb3ZlQ2xhc3MoJ2FkZCcpO1xuICAgICAgICAkKCcjcGxhY2VvcmRlcicpLmFkZENsYXNzKCdyZWMnKTtcbiAgICAgICAgJCgnI3BsYWNlb3JkZXInKS5odG1sKCfmt7vliqAnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRUb0FkZFBhZ2UoKSB7XG4gICAgICAgICQoJyNwbGFjZW9yZGVyJykucmVtb3ZlQ2xhc3MoJ3JlYycpO1xuICAgICAgICAkKCcjcGxhY2VvcmRlcicpLmFkZENsYXNzKCdhZGQnKTtcbiAgICAgICAgJCgnI3BsYWNlb3JkZXInKS5odG1sKCfkuIvljZUnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzYXZlQmFza2V0KCkge1xuICAgICAgICBjb25zb2xlLmxvZygndW5sb2FkaW5nIHBhZ2UnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmluZyBiYXNrZXQgYmVmb3JlIGxlYXZpbmcnKTtcblxuICAgICAgICB2YXIgb3JkZXIgPSBwcm9jZXNzT3JkZXIoKTtcbiAgICAgICAgdmFyIHNhbml0eSA9IG9yZGVyWzBdO1xuICAgICAgICB2YXIgb3JkZXJfc3RyID0gb3JkZXJbMV07XG4gICAgICAgIHZhciByZWNfc3RyID0gb3JkZXJbMl07XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogXCIvcmVjb21tZW5kb3JkZXIvYXBpL3YxL2N1c3RvbWVyL1wiICsgd2luZG93LmN1c3RvbWVyX2lkICsgXCIvYmFza2V0XCIsXG4gICAgICAgICAgICB0eXBlOiBcInBvc3RcIixcbiAgICAgICAgICAgIGRhdGF0eXBlOiBcImpzb25wXCIsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgJ2Jhc2tldCc6IG9yZGVyX3N0cixcbiAgICAgICAgICAgICAgICAncmVjJzogcmVjX3N0clxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8g5o6o6I2Q5ZKM5paw5aKe5ZWG5ZOBXG4gICAgJCgnLnNob3AnKS5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZSl7XG4gICAgICAgICQoZWxlKS5jaGlsZHJlbignLm9yZWMnKS5maW5kKCcuaG9tZS1zdG9yZS1pbmZvJykuY2hpbGRyZW4oJ3NwYW4nKS5jbGljayhmdW5jdGlvbihlKXtcbiAgICAgICAgICAgIHZhciBlbD1lLnRhcmdldDtcbiAgICAgICAgICAgIGlmKCQoZWwpLmh0bWwoKT09J+aOqOiNkOWVhuWTgScpe1xuICAgICAgICAgICAgICAgICQoZWxlKS5jaGlsZHJlbignLm9yZWMnKS5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgICAgICAgICAgICAgICQoZWxlKS5jaGlsZHJlbignLm5ld2FkZCcpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICAgICAgICAgICAgICBzZXRUb1JlY1BhZ2UoKTtcbiAgICAgICAgICAgIH1lbHNlIGlmKCQoZWwpLmh0bWwoKT09J+i0rSDniakg6L2mJyl7XG4gICAgICAgICAgICAgICAgJChlbGUpLmNoaWxkcmVuKCcub3JlYycpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAkKGVsZSkuY2hpbGRyZW4oJy5uZXdhZGQnKS5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgICAgICAgICAgICAgIHNldFRvQWRkUGFnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJChlbGUpLmNoaWxkcmVuKCcubmV3YWRkJykuZmluZCgnLmhvbWUtc3RvcmUtaW5mbycpLmNoaWxkcmVuKCdzcGFuJykuY2xpY2soZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICB2YXIgZWw9ZS50YXJnZXQ7XG4gICAgICAgICAgICBpZigkKGVsKS5odG1sKCk9PSfmjqjojZDllYblk4EnKXtcbiAgICAgICAgICAgICAgICAkKGVsZSkuY2hpbGRyZW4oJy5vcmVjJykuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICAgICAgICAgICAgICAkKGVsZSkuY2hpbGRyZW4oJy5uZXdhZGQnKS5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgICAgICAgICAgICAgc2V0VG9SZWNQYWdlKCk7XG4gICAgICAgICAgICB9ZWxzZSBpZigkKGVsKS5odG1sKCk9PSfotK0g54mpIOi9picpe1xuICAgICAgICAgICAgICAgICQoZWxlKS5jaGlsZHJlbignLm9yZWMnKS5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgICAgICAgICAgICAgJChlbGUpLmNoaWxkcmVuKCcubmV3YWRkJykuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICAgICAgICAgICAgICBzZXRUb0FkZFBhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB2YXIgbW89MDtcbiAgICB2YXIgaj0wO1xuICAgIHZhciBrPTA7XG4gICAgdmFyIHA9MDtcblxuICAgIC8vIOWkseeEplxuICAgICQoZG9jdW1lbnQpLm9uKCdjaGFuZ2UnLCcubnVtX3ZhbHVlJyxmdW5jdGlvbigpe1xuICAgICAgICBpZighaXNOYU4ocGFyc2VJbnQoJCh0aGlzKS52YWwoKSkpKXtcbiAgICAgICAgICAgIGlmKCQodGhpcykudmFsKCk9PT0nMCcpe1xuICAgICAgICAgICAgICAgIGlmKCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9jaG9vc2UnKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vKz1wYXJzZUZsb2F0KCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9tbycpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSkqcGFyc2VJbnQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5tb25leScpLmZpbmQoJy5tb25leV9tbycpLmh0bWwoJ8KlJyttby50b0ZpeGVkKDIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbW89MDtcbiAgICAgICAgICAgICAgICAgICAgLy8g5ZCI6K6h5Lu36ZKxXG4gICAgICAgICAgICAgICAgICAgIHN1bV9tb25leSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykucmVtb3ZlKCk7XG4gICAgICAgICAgICB9ZWxzZSBpZigkKHRoaXMpLnZhbCgpPjApe1xuICAgICAgICAgICAgICAgIGlmKCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9jaG9vc2UnKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgICAgICAgICAvL+WNleS4quW6l+mTuuS7t+mSsVxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vKz1wYXJzZUZsb2F0KCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9tbycpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSkqcGFyc2VJbnQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5tb25leScpLmZpbmQoJy5tb25leV9tbycpLmh0bWwoJ8KlJyttby50b0ZpeGVkKDIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBtbz0wO1xuICAgICAgICAgICAgICAgICAgICAvLyDlkIjorqHku7fpkrFcbiAgICAgICAgICAgICAgICAgICAgc3VtX21vbmV5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfWVsc2UgaWYoJCh0aGlzKS52YWwoKTwwfHwkKHRoaXMpLnZhbCgpPT09Jycpe1xuICAgICAgICAgICAgICAgICQodGhpcykudmFsKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZSBpZihpc05hTihwYXJzZUludCgkKHRoaXMpLnZhbCgpKSkpe1xuICAgICAgICAgICAgJCh0aGlzKS52YWwoMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL+i2hei/h+W6k+WtmOWkseaViFxuICAgICAgICB2YXIgdmFsMT0kKHRoaXMpLnZhbCgpO1xuICAgICAgICB2YXIgdmFsMj0kKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX251bScpLmZpbmQoJy5udW1fbGFjaycpLmF0dHIoJ3N0b2NrX251bScpO1xuICAgICAgICBpZih2YWwxID4gdmFsMikge1xuICAgICAgICAgICAgJCh0aGlzKS52YWwodmFsMik7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX251bScpLmZpbmQoJy5udW1fbGFjaycpLmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9udW0nKS5maW5kKCcubnVtX2xhY2snKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8g5rS+6YCBXG4gICAgICAgIHNlbmQoKTtcbiAgICB9KTtcblxuXG4gICAgLy8g5aKe5YqgXG4gICAgJChkb2N1bWVudCkub24oJ3RvdWNoc3RhcnQnLCcubnVtX2FkZCcsZnVuY3Rpb24oKXtcbiAgICAgICAgLy/otoXov4flupPlrZjlpLHmlYhcbiAgICAgICAgdmFyIHZhbDE9JCh0aGlzKS5zaWJsaW5ncygnLm51bV92YWx1ZScpLnZhbCgpO1xuICAgICAgICB2YXIgdmFsMj0kKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX251bScpLmZpbmQoJy5udW1fbGFjaycpLmF0dHIoJ3N0b2NrX251bScpO1xuICAgICAgICBpZih2YWwxPih2YWwyLTEpKXtcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5udW1fdmFsdWUnKS52YWwodmFsMi0xKTtcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbnVtJykuZmluZCgnLm51bV9sYWNrJykuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX251bScpLmZpbmQoJy5udW1fbGFjaycpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQodGhpcykuc2libGluZ3MoJy5udW1fdmFsdWUnKS52YWwocGFyc2VJbnQoJCh0aGlzKS5zaWJsaW5ncygnLm51bV92YWx1ZScpLnZhbCgpKSsxKTtcbiAgICAgICAgaWYoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5vcmRlcl9mb29kX2Nob29zZScpLmF0dHIoJ3NyYycpPT1hc3Npc3Rvcil7XG4gICAgICAgICAgICAvL+WNleS4quW6l+mTuuS7t+mSsVxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5vcmRlcl9mb29kX2Nob29zZScpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZigkKHRoaXMpLmF0dHIoJ3NyYycpPT1hc3Npc3Rvcil7XG4gICAgICAgICAgICAgICAgICAgIG1vKz1wYXJzZUZsb2F0KCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9tbycpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSkqcGFyc2VJbnQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLnNob3AnKS5maW5kKCcubW9uZXknKS5maW5kKCcubW9uZXlfbW8nKS5odG1sKCfCpScrbW8udG9GaXhlZCgyKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW89MDtcbiAgICAgICAgICAgIC8vIOWQiOiuoeS7t+mSsVxuICAgICAgICAgICAgc3VtX21vbmV5KCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8g5rS+6YCBXG4gICAgICAgIHNlbmQoKTtcbiAgICB9KTtcbiAgICAkKCcubnVtX2FkZCcpLm9uKCd0b3VjaHN0YXJ0JyxmdW5jdGlvbigpe1xuICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcwLjUnKTtcbiAgfSk7XG4gICAgJCgnLm51bV9hZGQnKS5vbigndG91Y2hlbmQnLGZ1bmN0aW9uKCl7XG4gICAgICAkKHRoaXMpLmNzcygnb3BhY2l0eScsJzEnKTtcbiAgfSk7XG5cblxuICAgIC8vIOWHj+WwkVxuICAgICQoZG9jdW1lbnQpLm9uKCd0b3VjaHN0YXJ0JywnLm51bV9taW51cycsZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoJCh0aGlzKS5zaWJsaW5ncygnLm51bV92YWx1ZScpLnZhbCgpPT09JzAnKXtcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5udW1fdmFsdWUnKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLnJlbW92ZSgpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5udW1fdmFsdWUnKS52YWwocGFyc2VJbnQoJCh0aGlzKS5zaWJsaW5ncygnLm51bV92YWx1ZScpLnZhbCgpKS0xKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5L2O5LqO5bqT5a2Y5o+Q56S65raI5aSxXG4gICAgICAgICQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbnVtJykuZmluZCgnLm51bV9sYWNrJykuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuXG4gICAgICAgIGlmKCQodGhpcykuc2libGluZ3MoJy5udW1fdmFsdWUnKS52YWwoKT09PScwJyl7XG4gICAgICAgICAgICBpZigkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykuZmluZCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuYXR0cignc3JjJyk9PWFzc2lzdG9yKXtcbiAgICAgICAgICAgICAgICB2YXIgbTU9cGFyc2VGbG9hdCgkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm1vbmV5JykuZmluZCgnLm1vbmV5X21vJykuaHRtbCgpLnNwbGl0KCfCpScpWzFdKTtcbiAgICAgICAgICAgICAgICB2YXIgbjU9cGFyc2VGbG9hdCgkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykuZmluZCgnLm9yZGVyX2Zvb2RfbW8nKS5odG1sKCkuc3BsaXQoJ8KlJylbMV0pO1xuXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5tb25leScpLmZpbmQoJy5tb25leV9tbycpLmh0bWwoJ8KlJysobTUtbjUpLnRvRml4ZWQoMikpO1xuICAgICAgICAgICAgICAgIC8vIOWQiOiuoeS7t+mSsVxuICAgICAgICAgICAgICAgIHN1bV9tb25leSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCcubnVtX3ZhbHVlJykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5yZW1vdmUoKTtcbiAgICAgICAgfWVsc2UgaWYoJCh0aGlzKS5zaWJsaW5ncygnLm51bV92YWx1ZScpLnZhbCgpPjApe1xuICAgICAgICAgICAgaWYoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5vcmRlcl9mb29kX2Nob29zZScpLmF0dHIoJ3NyYycpPT1hc3Npc3Rvcil7XG4gICAgICAgICAgICAgICAgdmFyIG02PXBhcnNlRmxvYXQoJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5tb25leScpLmZpbmQoJy5tb25leV9tbycpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSk7XG4gICAgICAgICAgICAgICAgdmFyIG42PXBhcnNlRmxvYXQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5vcmRlcl9mb29kX21vJykuaHRtbCgpLnNwbGl0KCfCpScpWzFdKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm1vbmV5JykuZmluZCgnLm1vbmV5X21vJykuaHRtbCgnwqUnKyhtNi1uNikudG9GaXhlZCgyKSk7XG4gICAgICAgICAgICAgICAgLy8g5ZCI6K6h5Lu36ZKxXG4gICAgICAgICAgICAgICAgc3VtX21vbmV5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8g5rS+6YCBXG4gICAgICAgIHNlbmQoKTtcbiAgICB9KTtcbiAgICAkKCcubnVtX21pbnVzJykub24oJ3RvdWNoc3RhcnQnLGZ1bmN0aW9uKCl7XG4gICAgICAkKHRoaXMpLmNzcygnb3BhY2l0eScsJzAuNScpO1xuICB9KTtcbiAgICAkKCcubnVtX21pbnVzJykub24oJ3RvdWNoZW5kJyxmdW5jdGlvbigpe1xuICAgICAgJCh0aGlzKS5jc3MoJ29wYWNpdHknLCcxJyk7XG4gIH0pO1xuXG4gICAgLy8g5YWo6YCJ5ZKM5YWo5LiN6YCJXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywnLm9yZGVyX2Nob29zZScsZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoJCh0aGlzKS5hdHRyKCdzcmMnKT09aWNfdW5fY2hvb3NlKXtcbiAgICAgICAgICAgICQodGhpcykuYXR0cignc3JjJyxhc3Npc3Rvcik7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5ob21lLXN0b3JlJykuc2libGluZ3MoJy5vcmRlcl9mb29kJykuZmluZCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuYXR0cignc3JjJyxhc3Npc3Rvcik7XG5cbiAgICAgICAgICAgIC8v5Y2V5Liq5bqX6ZO65Lu36ZKxXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmKCQodGhpcykuYXR0cignc3JjJyk9PWFzc2lzdG9yKXtcbiAgICAgICAgICAgICAgICAgICAgbW8rPXBhcnNlRmxvYXQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5vcmRlcl9mb29kX21vJykuaHRtbCgpLnNwbGl0KCfCpScpWzFdKSpwYXJzZUludCgkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykuZmluZCgnLm51bV92YWx1ZScpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuc2hvcCcpLmZpbmQoJy5tb25leScpLmZpbmQoJy5tb25leV9tbycpLmh0bWwoJ8KlJyttby50b0ZpeGVkKDIpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtbz0wO1xuXG4gICAgICAgIH1lbHNlIGlmKCQodGhpcykuYXR0cignc3JjJyk9PWFzc2lzdG9yKXtcbiAgICAgICAgICAgICQodGhpcykuYXR0cignc3JjJyxpY191bl9jaG9vc2UpO1xuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuaG9tZS1zdG9yZScpLnNpYmxpbmdzKCcub3JkZXJfZm9vZCcpLmZpbmQoJy5vcmRlcl9mb29kX2Nob29zZScpLmF0dHIoJ3NyYycsaWNfdW5fY2hvb3NlKTtcblxuICAgICAgICAgICAgLy/ljZXkuKrlupfpk7rku7fpkrFcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLnNob3AnKS5maW5kKCcub3JkZXJfZm9vZF9jaG9vc2UnKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgICAgICAgICBtbys9cGFyc2VGbG9hdCgkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykuZmluZCgnLm9yZGVyX2Zvb2RfbW8nKS5odG1sKCkuc3BsaXQoJ8KlJylbMV0pKnBhcnNlSW50KCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcubnVtX3ZhbHVlJykudmFsKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm1vbmV5JykuZmluZCgnLm1vbmV5X21vJykuaHRtbCgnwqUnK21vLnRvRml4ZWQoMikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtbz0wO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8g5ZCI6K6h5Lu36ZKxXG4gICAgICAgIHN1bV9tb25leSgpO1xuXG4gICAgICAgIC8vIOa0vumAgVxuICAgICAgICBzZW5kKCk7XG4gICAgfSk7XG5cblxuXG5cbiAgICAvLyDljZXpgIlcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCcub3JkZXJfZm9vZF9jaG9vc2UnLGZ1bmN0aW9uKCl7XG4gICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgIGlmKCQodGhpcykuYXR0cignc3JjJyk9PWljX3VuX2Nob29zZSl7XG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ3NyYycsYXNzaXN0b3IpO1xuICAgICAgICAgICAgLy/ljZXkuKrlupfpk7rku7fpkrFcbiAgICAgICAgICAgIGs9cGFyc2VGbG9hdCgkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm1vbmV5JykuZmluZCgnLm1vbmV5X21vJykuaHRtbCgpLnNwbGl0KCfCpScpWzFdKTtcbiAgICAgICAgICAgIHZhciBrMT1wYXJzZUZsb2F0KCQodGhpcykucGFyZW50cygnLm9yZGVyX2Zvb2RfbGknKS5maW5kKCcub3JkZXJfZm9vZF9tbycpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSkqcGFyc2VJbnQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5udW1fdmFsdWUnKS52YWwoKSk7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5zaG9wJykuZmluZCgnLm1vbmV5JykuZmluZCgnLm1vbmV5X21vJykuaHRtbCgnwqUnKyhrK2sxKS50b0ZpeGVkKDIpKTtcbiAgICAgICAgfWVsc2UgaWYoJCh0aGlzKS5hdHRyKCdzcmMnKT09YXNzaXN0b3Ipe1xuICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdzcmMnLGljX3VuX2Nob29zZSk7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kJykuc2libGluZ3MoJy5ob21lLXN0b3JlJykuZmluZCgnLm9yZGVyX2Nob29zZScpLmF0dHIoJ3NyYycsaWNfdW5fY2hvb3NlKTtcbiAgICAgICAgICAgIC8vIOWNleS4quW6l+mTuuS7t+mSsVxuICAgICAgICAgICAgaz1wYXJzZUZsb2F0KCQodGhpcykucGFyZW50cygnLnNob3AnKS5maW5kKCcubW9uZXknKS5maW5kKCcubW9uZXlfbW8nKS5odG1sKCkuc3BsaXQoJ8KlJylbMV0pO1xuICAgICAgICAgICAgdmFyIGsyPXBhcnNlRmxvYXQoJCh0aGlzKS5wYXJlbnRzKCcub3JkZXJfZm9vZF9saScpLmZpbmQoJy5vcmRlcl9mb29kX21vJykuaHRtbCgpLnNwbGl0KCfCpScpWzFdKSpwYXJzZUludCgkKHRoaXMpLnBhcmVudHMoJy5vcmRlcl9mb29kX2xpJykuZmluZCgnLm51bV92YWx1ZScpLnZhbCgpKTtcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLnNob3AnKS5maW5kKCcubW9uZXknKS5maW5kKCcubW9uZXlfbW8nKS5odG1sKCfCpScrKGstazIpLnRvRml4ZWQoMikpO1xuICAgICAgICB9XG4gICAgICAgIC8vIOWQiOiuoeS7t+mSsVxuICAgICAgICBzdW1fbW9uZXkoKTtcbiAgICAgICAgLy8g5rS+6YCBXG4gICAgICAgIHNlbmQoKTtcbiAgICB9KTtcblxuXG4gICAgLy8g5ZCI6K6h5Lu36ZKxXG4gICAgZnVuY3Rpb24gc3VtX21vbmV5KCl7XG4gICAgICAgICQoJy5tb25leV9tbycpLmVhY2goZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgaiA9IGorcGFyc2VGbG9hdCgkKHRoaXMpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSk7XG4gICAgICAgICAgICAkKCcueGlhZGFuX3N1bScpLmh0bWwoJ8KlJytqLnRvRml4ZWQoMikpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBqID0gMDtcbiAgICB9XG5cbiAgICAvLyDmtL7pgIFcbiAgICBmdW5jdGlvbiBzZW5kKCl7XG4gICAgICAgICQoJy5tb25leV9tbycpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKCQodGhpcykuaHRtbCgpLnNwbGl0KCfCpScpWzFdPjAmJiQodGhpcykuaHRtbCgpLnNwbGl0KCfCpScpWzFdPDMwMCl7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5zaWJsaW5ncygnLnNlbmRfbm8nKS5jc3MoJ2Rpc3BsYXknLCdpbmxpbmUtYmxvY2snKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCcuc2VuZF9vaycpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCcuc2VuZF9ubycpLmh0bWwoJ+i/mOW3rsKlICcrKDMwMC0kKHRoaXMpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXSkudG9GaXhlZCgyKSk7XG4gICAgICAgICAgICB9ZWxzZSBpZigkKHRoaXMpLmh0bWwoKS5zcGxpdCgnwqUnKVsxXT49MzAwKXtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCcuc2VuZF9ubycpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCcuc2VuZF9vaycpLmNzcygnZGlzcGxheScsJ2lubGluZS1ibG9jaycpO1xuICAgICAgICAgICAgfWVsc2UgaWYoJCh0aGlzKS5odG1sKCkuc3BsaXQoJ8KlJylbMV09PT0nMC4wMCcpe1xuICAgICAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5zZW5kX25vJykuY3NzKCdkaXNwbGF5JywnaW5saW5lLWJsb2NrJyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5zaWJsaW5ncygnLnNlbmRfb2snKS5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5zaWJsaW5ncygnLnNlbmRfbm8nKS5odG1sKCfCpSAzMDDotbfpgIEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHNhdmVCYXNrZXQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcm9jZXNzT3JkZXIoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwbGFjZSBvcmRlciBjbGlja2VkJyk7XG4gICAgICAgIHZhciBzYW5pdHkgPSB0cnVlO1xuXG4gICAgICAgIHZhciBvcmRlcl9zdHIgPSAnJztcbiAgICAgICAgdmFyIHJlY19zdHIgPSAnJztcbiAgICAgICAgJCgnLm9yZGVyX2Zvb2RfY2hvb3NlJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCQodGhpcykuYXR0cihcInNyY1wiKSk7XG4gICAgICAgICAgICB2YXIgY3VyX2xpID0gJCh0aGlzKS5wYXJlbnQoKTtcbiAgICAgICAgICAgIHZhciBpdGVtID0gY3VyX2xpLmZpbmQoXCIuaXRlbV9uYW1lXCIpO1xuICAgICAgICAgICAgdmFyIGl0ZW1fbmFtZSA9IGl0ZW0uaHRtbCgpO1xuICAgICAgICAgICAgdmFyIGl0ZW1faWQgPSBpdGVtLmF0dHIoXCJpdGVtX2lkXCIpO1xuICAgICAgICAgICAgdmFyIGludmVudG9yeSA9IGN1cl9saS5maW5kKFwiLm51bV9sYWNrXCIpLmF0dHIoXCJzdG9ja19udW1cIik7XG4gICAgICAgICAgICB2YXIgbnVtX3NlbGVjdGVkID0gY3VyX2xpLmZpbmQoXCIubnVtX3ZhbHVlXCIpLnZhbCgpO1xuICAgICAgICAgICAgaWYoJCh0aGlzKS5oYXNDbGFzcyhcInNlbGVjdGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIHNlbGVjdGVkIGl0ZW0nKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtX25hbWUgKyBcIixcIiArICBpdGVtX2lkICsgXCIsXCIgKyBpbnZlbnRvcnkgKyBcIixcIiArIG51bV9zZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG51bV9zZWxlY3RlZCkgPiBwYXJzZUludChpbnZlbnRvcnkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KGl0ZW1fbmFtZSArICflupPlrZjkuI3otrMgKCcgKyBudW1fc2VsZWN0ZWQgKyAnLycgKyBpbnZlbnRvcnkgKyAnKScpO1xuICAgICAgICAgICAgICAgICAgICBzYW5pdHkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcmRlcl9zdHIgPSBvcmRlcl9zdHIgKyBpdGVtX2lkICsgJywnICsgbnVtX3NlbGVjdGVkICsgJ3wnO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdyZWMnKSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChudW1fc2VsZWN0ZWQpID4gcGFyc2VJbnQoaW52ZW50b3J5KSkge1xuICAgICAgICAgICAgICAgICAgICBudW1fc2VsZWN0ZWQgPSBpbnZlbnRvcnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlY19zdHIgPSByZWNfc3RyICsgaXRlbV9pZCArICcsJyArIG51bV9zZWxlY3RlZCArICd8JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbc2FuaXR5LCBvcmRlcl9zdHIsIHJlY19zdHJdO1xuICAgIH1cblxuXG4gICAgJCgnI3BsYWNlb3JkZXInKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCQoJyNwbGFjZW9yZGVyJykuaGFzQ2xhc3MoJ3JlYycpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGxhY2Ugb3JkZXInKTtcbiAgICAgICAgICAgICQoJy5vcmRlcl9hZGQnKS5jbGljaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9yZGVyID0gcHJvY2Vzc09yZGVyKCk7XG4gICAgICAgICAgICB2YXIgc2FuaXR5ID0gb3JkZXJbMF07XG4gICAgICAgICAgICB2YXIgb3JkZXJfc3RyID0gb3JkZXJbMV07XG4gICAgICAgICAgICBpZiAoc2FuaXR5KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ09yZGVyczogJyArIG9yZGVyX3N0cik7XG4gICAgICAgICAgICAgICAgdmFyIG5leHRfaHJlZiA9ICcvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvJyArIHdpbmRvdy5jdXN0b21lcl9pZCArICcvY29uZmlybS1vcmRlcj9vcmRlcnM9JyArIG9yZGVyX3N0cjtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG5leHRfaHJlZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgJCgnI3RvZGVhbGVyJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0byBkZWFsZXInKTtcbiAgICAgICAgLy8gVE9ETzogZG9uJ3QgaGFyZGNvZGUgZGVhbGVyMSwgZ28gdG8gdGhlIGRlYWxlciBzZWxlY3Rpb24gcGFnZVxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvcmVjb21tZW5kb3JkZXIvZGVhbGVyLzEvY3VzdG9tZXIvJyArIHdpbmRvdy5jdXN0b21lcl9pZCArICcvYWRkLWl0ZW0nO1xuICAgIH0pO1xuXG4gICAgbm9kb3VibGV0YXB6b29tKCk7XG59KTtcbiJdfQ==
