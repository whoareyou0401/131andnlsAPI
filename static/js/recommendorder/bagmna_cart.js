!function(e){"use strict";setupCSRF();var t="/api/v1.2/recommendorder/bagman/customer/"+window.customer_id+"/cart";Vue.filter("toFixed",function(e,t){return Number(Number(e).toFixed(t))});var r=(new Vue({el:"header",beforeCreate:function(){var e=getCookie("user_role");this.isSalesman="salesman"===e},data:{addGifts:""},methods:{back:function(){window.location.href="/recommendorder/salesman/customer-status"},addGift:function(){window.location.href="/recommendorder/customer/"+window.customer_id+"/add-gift"}}}),new Vue({el:"#cart-items",data:{dealers:[],insufficient_items:[],bus_hr_from:"",bus_hr_to:"",sum:0,recommendUrl:"/recommendorder/customer/"+window.customer_id+"/recommend",customerProfile:"/recommendorder/customer/"+window.customer_id+"/profile",dealerListUrl:"/recommendorder/customer/"+window.customer_id+"/dealer-list"},watch:{sum:function(e,t){e>0?$("#placeorder").css("background","#ff4a0c"):0===e&&$("#placeorder").css("background","#dbdbdb")}},methods:{init:function(){var e=this;$.ajax({url:t,type:"get",success:function(t){e.dealers=t.items,e.sum=t.sum,0===e.dealers.length?$(".blank").show():$(".dealers-con").show(),e.sum>0?$("#placeorder").css("background","#ff4a0c"):0===e.sum&&$("#placeorder").css("background","#dbdbdb")}})},add:function(e,t){var r=this,i={};i[e.item_id]=t;var s="/api/v1.2/recommendorder/bagman/customer/"+window.customer_id+"/cart";$.ajax({url:s,type:"put",data:i,success:function(e){r.init()}})},set:function(e,t){var r=this,i={};i[t.item_id]=event.target.value,console.log(t.is_giveaway);var s="/api/v1.2/recommendorder/bagman/customer/"+window.customer_id+"/cart";$.ajax({url:s,type:"post",data:i,success:function(e){r.init()}})},dAllSelected:function(e){for(var t=0;t<this.dealers.length;t++)if(this.dealers[t].id===e||void 0===e)for(var r=0;r<this.dealers[t].items.length;r++)if(this.dealers[t].items[r].selected===!1)return!1;return!0},dSelectAll:function(e,r){var i=this,s={};s.items=[];var o,d,n=!0;for(o=0;o<this.dealers.length;o++)if(this.dealers[o].id===r||void 0===r)for(d=0;d<this.dealers[o].items.length;d++)if(this.dealers[o].items[d].selected===!1){n=!1;break}for(o=0;o<this.dealers.length;o++)if(this.dealers[o].id===r||void 0===r)for(d=0;d<this.dealers[o].items.length;d++)this.dealers[o].items[d].selected===n&&s.items.push(this.dealers[o].items[d].item_id);$.ajax({url:t,type:"patch",data:s,success:function(e){i.init()}})},select:function(e,r){var i=this,s={};s.items=[r],$.ajax({url:t,type:"patch",data:s,success:function(e){i.init()}})},sendChecked:function(e,t){return{send_no:e>t,send_checked:e<=t}},dhref:function(e){return"/recommendorder/dealer/"+e+"/customer/"+window.customer_id+"/add-item"},confirmOrder:function(){var e=this;if(0!==this.dealers.length&&0!==e.sum){for(var t=0;t<this.dealers.length;t++){if(this.dealers[t].amount<this.dealers[t].initial_price&&0!=this.dealers[t].amount)return void alert("在"+this.dealers[t].name+"的订单未达到起送金额!");var r=new Date,i=r.getMinutes()+60*r.getHours(),s=this.dealers[t].bus_hr_from,o=this.dealers[t].bus_hr_to;if(null!==s&&null!==o&&0!=this.dealers[t].amount){if(s<o&&(i<s||i>o))return void alert("每日"+intPad(Math.floor(o/60),2)+":"+intPad(o%60,2)+" ~ 次日"+intPad(Math.floor(s/60),2)+":"+intPad(s%60,2)+this.dealers[t].name+"下单系统升级， 不能提供网购下单服务，敬请谅解 ");if(s>o&&i>o&&i<s)return void alert("每日"+intPad(Math.floor(o/60),2)+":"+intPad(o%60,2)+" ~ "+intPad(Math.floor(s/60),2)+":"+intPad(s%60,2)+this.dealers[t].name+"下单系统升级， 不能提供网购下单服务，敬请谅解 ")}}$.ajax({url:"/api/v1.1/recommendorder/customer/"+window.customer_id+"/check-cart",type:"get",success:function(t){return t.items.length>0?(e.insufficient_items=t.items,$(".del-understock-model").show(),void $("footer").addClass("gs-blur")):void(window.location.href="/recommendorder/customer/"+window.customer_id+"/confirm-order")}})}},giveawayIconSrc:function(e){return"/static/images/recommendorder/full_"+Number(e).toFixed(0)+".png"},closeDeleteInsItems:function(){$("footer").removeClass("gs-blur"),$(".del-understock-model").hide()},clearUnderstock:function(){var e=this;$("footer").removeClass("gs-blur"),$(".del-understock-model").hide();var r,i,s={items:[]};for(r=0;r<this.insufficient_items.length;r++)for(i=0;i<this.insufficient_items[r].items.length;i++)s.items.push(this.insufficient_items[r].items[i].id);$.ajax({url:t,type:"delete",data:s,success:function(t){$(".understock-model").show(),setTimeout(function(){$(".understock-model").hide()},1e3),e.init()}})},addProduct:function(){window.location.href="/recommendorder/customer/"+window.customer_id+"/dealer-list"}}}));r.init()}(window.cmApp=window.cmApp||{});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlY29tbWVuZG9yZGVyL2JhZ21uYV9jYXJ0LmpzIl0sIm5hbWVzIjpbImNtQXBwIiwic2V0dXBDU1JGIiwidXJsIiwid2luZG93IiwiY3VzdG9tZXJfaWQiLCJWdWUiLCJmaWx0ZXIiLCJudW0iLCJwcmVjaXNpb24iLCJOdW1iZXIiLCJ0b0ZpeGVkIiwiYmluZCIsImVsIiwiYmVmb3JlQ3JlYXRlIiwidXNlcl9yb2xlIiwiZ2V0Q29va2llIiwidGhpcyIsImlzU2FsZXNtYW4iLCJkYXRhIiwiYWRkR2lmdHMiLCJtZXRob2RzIiwiYmFjayIsImxvY2F0aW9uIiwiaHJlZiIsImFkZEdpZnQiLCJkZWFsZXJzIiwiaW5zdWZmaWNpZW50X2l0ZW1zIiwiYnVzX2hyX2Zyb20iLCJidXNfaHJfdG8iLCJzdW0iLCJyZWNvbW1lbmRVcmwiLCJjdXN0b21lclByb2ZpbGUiLCJkZWFsZXJMaXN0VXJsIiwid2F0Y2giLCJuZXdfdmFsdWUiLCJvbGRfdmFsdWUiLCIkIiwiY3NzIiwiaW5pdCIsIl90aGlzIiwiYWpheCIsInR5cGUiLCJzdWNjZXNzIiwiaXRlbXMiLCJsZW5ndGgiLCJzaG93IiwiYWRkIiwiaXRlbSIsImRhdGFUb1NlbmQiLCJpdGVtX2lkIiwiX3VybCIsInNldCIsIiRldmVudCIsImV2ZW50IiwidGFyZ2V0IiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwiaXNfZ2l2ZWF3YXkiLCJkQWxsU2VsZWN0ZWQiLCJkaWQiLCJpIiwiaWQiLCJ1bmRlZmluZWQiLCJqIiwic2VsZWN0ZWQiLCJkU2VsZWN0QWxsIiwiY3VycmVudCIsInB1c2giLCJzZWxlY3QiLCJzZW5kQ2hlY2tlZCIsImluaXRpYWxfcHJpY2UiLCJhbW91bnQiLCJzZW5kX25vIiwic2VuZF9jaGVja2VkIiwiZGhyZWYiLCJjb25maXJtT3JkZXIiLCJhbGVydCIsIm5hbWUiLCJkIiwiRGF0ZSIsIm1pbl9vZl9kYXkiLCJnZXRNaW51dGVzIiwiZ2V0SG91cnMiLCJmcm9tIiwidG8iLCJpbnRQYWQiLCJNYXRoIiwiZmxvb3IiLCJhZGRDbGFzcyIsImdpdmVhd2F5SWNvblNyYyIsInByaWNlIiwiY2xvc2VEZWxldGVJbnNJdGVtcyIsInJlbW92ZUNsYXNzIiwiaGlkZSIsImNsZWFyVW5kZXJzdG9jayIsInNldFRpbWVvdXQiLCJhZGRQcm9kdWN0Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFVQSxHQUNOLFlBRUFDLFlBQ0EsSUFBSUMsR0FBTyw0Q0FBOENDLE9BQU9DLFlBQWMsT0FFOUVDLEtBQUlDLE9BQU8sVUFBVyxTQUFVQyxFQUFLQyxHQUNqQyxNQUFPQyxRQUFPQSxPQUFPRixHQUFLRyxRQUFRRixLQUd0QyxJQW1CSUcsSUFuQlksR0FBSU4sTUFDaEJPLEdBQUksU0FDSkMsYUFBYyxXQUNWLEdBQUlDLEdBQVlDLFVBQVUsWUFDMUJDLE1BQUtDLFdBQTJCLGFBQWRILEdBRXRCSSxNQUNJQyxTQUFVLElBRWRDLFNBQ0lDLEtBQU0sV0FDRmxCLE9BQU9tQixTQUFTQyxLQUFPLDRDQUUzQkMsUUFBUyxXQUNMckIsT0FBT21CLFNBQVNDLEtBQU8sNEJBQThCcEIsT0FBT0MsWUFBYyxnQkFLM0UsR0FBSUMsTUFDWE8sR0FBSSxjQUNKTSxNQUNJTyxXQUNBQyxzQkFDQUMsWUFBYSxHQUNiQyxVQUFXLEdBQ1hDLElBQUssRUFDTEMsYUFBYyw0QkFBOEIzQixPQUFPQyxZQUFjLGFBQ2pFMkIsZ0JBQWlCLDRCQUE4QjVCLE9BQU9DLFlBQWMsV0FDcEU0QixjQUFnQiw0QkFBOEI3QixPQUFPQyxZQUFjLGdCQUV2RTZCLE9BQ0lKLElBQUssU0FBU0ssRUFBVUMsR0FDaEJELEVBQVksRUFDWkUsRUFBRSxlQUFlQyxJQUFJLGFBQWEsV0FDZixJQUFkSCxHQUNMRSxFQUFFLGVBQWVDLElBQUksYUFBYSxhQUk5Q2pCLFNBQ0lrQixLQUFNLFdBQ0YsR0FBSUMsR0FBUXZCLElBQ1pvQixHQUFFSSxNQUNFdEMsSUFBS0EsRUFDTHVDLEtBQU0sTUFDTkMsUUFBUyxTQUFTeEIsR0FDZHFCLEVBQU1kLFFBQVVQLEVBQUt5QixNQUNy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MUZPLEdBQUsyQixRQUVGbkMsT0FBT0gsTUFBUUcsT0FBT0giLCJmaWxlIjoicmVjb21tZW5kb3JkZXIvYmFnbW5hX2NhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oY21BcHApIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBzZXR1cENTUkYoKTtcbiAgICB2YXIgdXJsID0gIFwiL2FwaS92MS4yL3JlY29tbWVuZG9yZGVyL2JhZ21hbi9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL2NhcnRcIjtcblxuICAgIFZ1ZS5maWx0ZXIoJ3RvRml4ZWQnLCBmdW5jdGlvbiAobnVtLCBwcmVjaXNpb24pIHtcbiAgICAgICAgcmV0dXJuIE51bWJlcihOdW1iZXIobnVtKS50b0ZpeGVkKHByZWNpc2lvbikpO1xuICAgIH0pO1xuXG4gICAgdmFyIGhlYWRlclZ1ZSA9IG5ldyBWdWUoe1xuICAgICAgICBlbDogXCJoZWFkZXJcIixcbiAgICAgICAgYmVmb3JlQ3JlYXRlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHVzZXJfcm9sZSA9IGdldENvb2tpZSgndXNlcl9yb2xlJyk7XG4gICAgICAgICAgICB0aGlzLmlzU2FsZXNtYW4gPSB1c2VyX3JvbGUgPT09IFwic2FsZXNtYW5cIjtcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYWRkR2lmdHM6IFwiXCJcbiAgICAgICAgfSxcbiAgICAgICAgbWV0aG9kczoge1xuICAgICAgICAgICAgYmFjazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3JlY29tbWVuZG9yZGVyL3NhbGVzbWFuL2N1c3RvbWVyLXN0YXR1c1wiO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFkZEdpZnQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9yZWNvbW1lbmRvcmRlci9jdXN0b21lci9cIiArIHdpbmRvdy5jdXN0b21lcl9pZCArIFwiL2FkZC1naWZ0XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBiaW5kID0gbmV3IFZ1ZSh7XG4gICAgICAgIGVsOiAnI2NhcnQtaXRlbXMnLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBkZWFsZXJzOiBbXSxcbiAgICAgICAgICAgIGluc3VmZmljaWVudF9pdGVtczogW10sXG4gICAgICAgICAgICBidXNfaHJfZnJvbTogXCJcIixcbiAgICAgICAgICAgIGJ1c19ocl90bzogXCJcIixcbiAgICAgICAgICAgIHN1bTogMCxcbiAgICAgICAgICAgIHJlY29tbWVuZFVybDogXCIvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9yZWNvbW1lbmRcIixcbiAgICAgICAgICAgIGN1c3RvbWVyUHJvZmlsZTogXCIvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9wcm9maWxlXCIsXG4gICAgICAgICAgICBkZWFsZXJMaXN0VXJsIDogXCIvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9kZWFsZXItbGlzdFwiLFxuICAgICAgICB9LFxuICAgICAgICB3YXRjaDoge1xuICAgICAgICAgICAgc3VtOiBmdW5jdGlvbihuZXdfdmFsdWUsb2xkX3ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ld192YWx1ZSA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJyNwbGFjZW9yZGVyJykuY3NzKCdiYWNrZ3JvdW5kJywnI2ZmNGEwYycpO1xuICAgICAgICAgICAgICAgIH1lbHNlIGlmKG5ld192YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAkKCcjcGxhY2VvcmRlcicpLmNzcygnYmFja2dyb3VuZCcsJyNkYmRiZGInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG1ldGhvZHM6IHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGVhbGVycyA9IGRhdGEuaXRlbXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdW0gPSBkYXRhLnN1bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF90aGlzLmRlYWxlcnMubGVuZ3RoID09PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuYmxhbmsnKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuZGVhbGVycy1jb24nKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3VtID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcGxhY2VvcmRlcicpLmNzcygnYmFja2dyb3VuZCcsJyNmZjRhMGMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKF90aGlzLnN1bSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNwbGFjZW9yZGVyJykuY3NzKCdiYWNrZ3JvdW5kJywnI2RiZGJkYicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFkZDogZnVuY3Rpb24oaXRlbSwgbnVtKXtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVG9TZW5kID0ge307XG4gICAgICAgICAgICAgICAgZGF0YVRvU2VuZFtpdGVtLml0ZW1faWRdID0gbnVtO1xuICAgICAgICAgICAgICAgIHZhciBfdXJsID0gXCIvYXBpL3YxLjIvcmVjb21tZW5kb3JkZXIvYmFnbWFuL2N1c3RvbWVyL1wiICsgd2luZG93LmN1c3RvbWVyX2lkICsgXCIvY2FydFwiO1xuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogX3VybCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3B1dCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFUb1NlbmQsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5pdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbigkZXZlbnQsIGl0ZW0pe1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFUb1NlbmQgPSB7fTtcbiAgICAgICAgICAgICAgICBkYXRhVG9TZW5kW2l0ZW0uaXRlbV9pZF0gPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbS5pc19naXZlYXdheSk7XG4gICAgICAgICAgICAgICAgdmFyIF91cmwgPSBcIi9hcGkvdjEuMi9yZWNvbW1lbmRvcmRlci9iYWdtYW4vY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9jYXJ0XCI7XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBfdXJsLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFUb1NlbmQsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5pdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZEFsbFNlbGVjdGVkOiBmdW5jdGlvbihkaWQpe1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmRlYWxlcnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWFsZXJzW2ldLmlkICE9PSBkaWQgJiYgZGlkICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IHRoaXMuZGVhbGVyc1tpXS5pdGVtcy5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWFsZXJzW2ldLml0ZW1zW2pdLnNlbGVjdGVkID09PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRTZWxlY3RBbGw6IGZ1bmN0aW9uKCRldmVudCwgZGlkKXtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVG9TZW5kID0ge307XG4gICAgICAgICAgICAgICAgZGF0YVRvU2VuZC5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgaSwgajtcbiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCB0aGlzLmRlYWxlcnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWFsZXJzW2ldLmlkICE9PSBkaWQgJiYgZGlkICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGogPSAwOyBqIDwgdGhpcy5kZWFsZXJzW2ldLml0ZW1zLmxlbmd0aDsgaisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlYWxlcnNbaV0uaXRlbXNbal0uc2VsZWN0ZWQgPT09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdGhpcy5kZWFsZXJzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVhbGVyc1tpXS5pZCAhPT0gZGlkICYmIGRpZCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGZvcihqID0gMDsgaiA8IHRoaXMuZGVhbGVyc1tpXS5pdGVtcy5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWFsZXJzW2ldLml0ZW1zW2pdLnNlbGVjdGVkID09PSBjdXJyZW50KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVG9TZW5kLml0ZW1zLnB1c2godGhpcy5kZWFsZXJzW2ldLml0ZW1zW2pdLml0ZW1faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGF0Y2gnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhVG9TZW5kLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdDogZnVuY3Rpb24oJGV2ZW50LCBpdGVtX2lkKXtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVG9TZW5kID0ge307XG4gICAgICAgICAgICAgICAgZGF0YVRvU2VuZC5pdGVtcyA9IFtpdGVtX2lkXTtcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BhdGNoJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVRvU2VuZCxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbml0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZW5kQ2hlY2tlZDogZnVuY3Rpb24oaW5pdGlhbF9wcmljZSwgYW1vdW50KXtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzZW5kX25vOiBpbml0aWFsX3ByaWNlID4gYW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBzZW5kX2NoZWNrZWQ6IGluaXRpYWxfcHJpY2UgPD0gYW1vdW50XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaHJlZjogZnVuY3Rpb24oZGlkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIvcmVjb21tZW5kb3JkZXIvZGVhbGVyL1wiICsgZGlkICsgXCIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgK1wiL2FkZC1pdGVtXCI7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8g5peg55So55qEXG4gICAgICAgICAgICBjb25maXJtT3JkZXI6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpc1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlYWxlcnMubGVuZ3RoID09PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxlcnQoXCLml6DllYblk4FcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoX3RoaXMuc3VtID09PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gJCgnI3BsYWNlb3JkZXInKS5jc3MoJ2JhY2tncm91bmQnLCcjZGJkYmRiJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuZGVhbGVycy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZGVhbGVyc1tpXS5hbW91bnQgPCB0aGlzLmRlYWxlcnNbaV0uaW5pdGlhbF9wcmljZSAmJiB0aGlzLmRlYWxlcnNbaV0uYW1vdW50IT0wKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5ZyoXCIgKyB0aGlzLmRlYWxlcnNbaV0ubmFtZSArIFwi55qE6K6i5Y2V5pyq6L6+5Yiw6LW36YCB6YeR6aKdIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbl9vZl9kYXkgPSBkLmdldE1pbnV0ZXMoKSArIGQuZ2V0SG91cnMoKSAqIDYwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IHRoaXMuZGVhbGVyc1tpXS5idXNfaHJfZnJvbTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvID0gdGhpcy5kZWFsZXJzW2ldLmJ1c19ocl90bztcbiAgICAgICAgICAgICAgICAgICAgaWYoZnJvbSAhPT0gbnVsbCAmJiB0byAhPT0gbnVsbCAmJiB0aGlzLmRlYWxlcnNbaV0uYW1vdW50ICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmcm9tIDwgdG8gJiYgKG1pbl9vZl9kYXkgPCBmcm9tIHx8IG1pbl9vZl9kYXkgPiB0bykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIuavj+aXpVwiICsgaW50UGFkKE1hdGguZmxvb3IodG8gLyA2MCksIDIpICsgXCI6XCIgKyBpbnRQYWQodG8gJSA2MCwgMikgKyBcIiB+IOasoeaXpVwiICsgaW50UGFkKE1hdGguZmxvb3IoZnJvbSAvIDYwKSwgMikgKyBcIjpcIiArIGludFBhZChmcm9tICUgNjAsIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdGhpcy5kZWFsZXJzW2ldLm5hbWUgKyBcIuS4i+WNleezu+e7n+WNh+e6p++8jCDkuI3og73mj5DkvpvnvZHotK3kuIvljZXmnI3liqHvvIzmlazor7fosIXop6MgXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbSA+IHRvICYmIChtaW5fb2ZfZGF5PiB0byAmJiBtaW5fb2ZfZGF5IDwgZnJvbSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5q+P5pelXCIgKyBpbnRQYWQoTWF0aC5mbG9vcih0byAvIDYwKSwgMikgKyBcIjpcIiArIGludFBhZCh0byAlIDYwLCAyKSArIFwiIH4gXCIgKyBpbnRQYWQoTWF0aC5mbG9vcihmcm9tIC8gNjApLCAyKSArIFwiOlwiICsgaW50UGFkKGZyb20gJSA2MCwgMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0aGlzLmRlYWxlcnNbaV0ubmFtZSArIFwi5LiL5Y2V57O757uf5Y2H57qn77yMIOS4jeiDveaPkOS+m+e9kei0reS4i+WNleacjeWKoe+8jOaVrOivt+iwheinoyBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvdjEuMS9yZWNvbW1lbmRvcmRlci9jdXN0b21lci8nICsgd2luZG93LmN1c3RvbWVyX2lkICsgJy9jaGVjay1jYXJ0JyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaXRlbXMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5zdWZmaWNpZW50X2l0ZW1zID0gZGF0YS5pdGVtcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuZGVsLXVuZGVyc3RvY2stbW9kZWwnKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnZm9vdGVyJykuYWRkQ2xhc3MoJ2dzLWJsdXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGVydChcIumDqOWIhuWVhuWTgeaaguaXtue8uui0p++8jOivt+S/ruaUueaVsOmHj+WQjuWGjei/m+ihjOS4i+WNleOAglwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvcmVjb21tZW5kb3JkZXIvY3VzdG9tZXIvXCIgKyB3aW5kb3cuY3VzdG9tZXJfaWQgKyBcIi9jb25maXJtLW9yZGVyXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gY2FuY2VsRGVsZXRlSW5zSXRlbXM6IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIC8vICAgICAkKCcubW9kZWwgJykuY3NzKHtcbiAgICAgICAgICAgIC8vICAgICAgICAgJ2Rpc3BsYXknOidub25lJ1xuICAgICAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgLy8gfSxcbiAgICAgICAgICAgIC8vIGRlbGV0ZUluc0l0ZW1zOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvLyAgICAgJCgnLm1vZGVsICcpLmNzcyh7XG4gICAgICAgICAgICAvLyAgICAgICAgICdkaXNwbGF5Jzonbm9uZSdcbiAgICAgICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIC8vICAgICB2YXIgZGF0YVRvU2VuZCA9IHsnaXRlbXMnOiBbXX07XG4gICAgICAgICAgICAvLyAgICAgdmFyIGksIGo7XG4gICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2codGhpcy5pbnN1ZmZpY2llbnRfaXRlbXMpO1xuICAgICAgICAgICAgLy8gICAgIGZvcihpID0gMDsgaSA8IHRoaXMuaW5zdWZmaWNpZW50X2l0ZW1zLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIC8vICAgICAgICAgZm9yKGogPSAwOyBqIDwgdGhpcy5pbnN1ZmZpY2llbnRfaXRlbXNbaV0uaXRlbXMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgZGF0YVRvU2VuZC5pdGVtcy5wdXNoKHRoaXMuaW5zdWZmaWNpZW50X2l0ZW1zW2ldLml0ZW1zW2pdLmlkKTtcbiAgICAgICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgLy8gICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIC8vICAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAvLyAgICAgICAgIGRhdGE6IGRhdGFUb1NlbmQsXG4gICAgICAgICAgICAvLyAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgX3RoaXMuaW5pdCgpO1xuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICAvLyB9LFxuICAgICAgICAgICAgLy8g5peg55SoXG4gICAgICAgICAgICBnaXZlYXdheUljb25TcmM6IGZ1bmN0aW9uKHByaWNlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIvc3RhdGljL2ltYWdlcy9yZWNvbW1lbmRvcmRlci9mdWxsX1wiICsgTnVtYmVyKHByaWNlKS50b0ZpeGVkKDApICsgXCIucG5nXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjbG9zZURlbGV0ZUluc0l0ZW1zOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICQoJ2Zvb3RlcicpLnJlbW92ZUNsYXNzKCdncy1ibHVyJyk7XG4gICAgICAgICAgICAgICAgJCgnLmRlbC11bmRlcnN0b2NrLW1vZGVsJykuaGlkZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsZWFyVW5kZXJzdG9jazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICQoJ2Zvb3RlcicpLnJlbW92ZUNsYXNzKCdncy1ibHVyJyk7XG4gICAgICAgICAgICAgICAgJCgnLmRlbC11bmRlcnN0b2NrLW1vZGVsJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVG9TZW5kID0geydpdGVtcyc6IFtdfTtcbiAgICAgICAgICAgICAgICB2YXIgaSwgajtcbiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCB0aGlzLmluc3VmZmljaWVudF9pdGVtcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcihqID0gMDsgaiA8IHRoaXMuaW5zdWZmaWNpZW50X2l0ZW1zW2ldLml0ZW1zLmxlbmd0aDsgaisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUb1NlbmQuaXRlbXMucHVzaCh0aGlzLmluc3VmZmljaWVudF9pdGVtc1tpXS5pdGVtc1tqXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhVG9TZW5kLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy51bmRlcnN0b2NrLW1vZGVsJykuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcudW5kZXJzdG9jay1tb2RlbCcpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sMTAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFkZFByb2R1Y3Q6ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3JlY29tbWVuZG9yZGVyL2N1c3RvbWVyL1wiICsgd2luZG93LmN1c3RvbWVyX2lkICsgXCIvZGVhbGVyLWxpc3RcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG5iaW5kLmluaXQoKTtcblxufSkod2luZG93LmNtQXBwID0gd2luZG93LmNtQXBwIHx8IHt9KTtcblxuIl19
