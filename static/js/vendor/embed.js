!function(e,n,o,t){"use strict";n="undefined"!=typeof n&&n.Math==Math?n:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.embed=function(o){var r,a=e(this),i=a.selector||"",c=(new Date).getTime(),l=[],d=arguments[0],u="string"==typeof d,s=[].slice.call(arguments,1);return a.each(function(){var m,p=e.isPlainObject(o)?e.extend(!0,{},e.fn.embed.settings,o):e.extend({},e.fn.embed.settings),f=p.selector,h=p.className,b=p.sources,g=p.error,v=p.metadata,y=p.namespace,w=p.templates,P="."+y,C="module-"+y,E=(e(n),e(this)),U=E.find(f.placeholder),j=E.find(f.icon),S=E.find(f.embed),T=this,x=E.data(C);m={initialize:function(){m.debug("Initializing embed"),m.determine.autoplay(),m.create(),m.bind.events(),m.instantiate()},instantiate:function(){m.verbose("Storing instance of module",m),x=m,E.data(C,m)},destroy:function(){m.verbose("Destroying previous instance of embed"),m.reset(),E.removeData(C).off(P)},refresh:function(){m.verbose("Refreshing selector cache"),U=E.find(f.placeholder),j=E.find(f.icon),S=E.find(f.embed)},bind:{events:function(){m.has.placeholder()&&(m.debug("Adding placeholder events"),E.on("click"+P,f.placeholder,m.createAndShow).on("click"+P,f.icon,m.createAndShow))}},create:function(){var e=m.get.placeholder();e?m.createPlaceholder():m.createAndShow()},createPlaceholder:function(e){var n=m.get.icon(),o=m.get.url();m.generate.embed(o);e=e||m.get.placeholder(),E.html(w.placeholder(e,n)),m.debug("Creating placeholder for embed",e,n)},createEmbed:function(n){m.refresh(),n=n||m.get.url(),S=e("<div/>").addClass(h.embed).html(m.generate.embed(n)).appendTo(E),p.onCreate.call(T,n),m.debug("Creating embed object",S)},changeEmbed:function(e){S.html(m.generate.embed(e))},createAndShow:function(){m.createEmbed(),m.show()},change:function(e,n,o){m.debug("Changing video to ",e,n,o),E.data(v.source,e).data(v.id,n),o?E.data(v.url,o):E.removeData(v.url),m.has.embed()?m.changeEmbed():m.create()},reset:function(){m.debug("Clearing embed and showing placeholder"),m.remove.active(),m.remove.embed(),m.showPlaceholder(),p.onReset.call(T)},show:function(){m.debug("Showing embed"),m.set.active(),p.onDisplay.call(T)},hide:function(){m.debug("Hiding embed"),m.showPlaceholder()},showPlaceholder:function(){m.debug("Showing placeholder image"),m.remove.active(),p.onPlaceholderDisplay.call(T)},get:{id:function(){return p.id||E.data(v.id)},placeholder:function(){return p.placeholder||E.data(v.placeholder)},icon:function(){return p.icon?p.icon:E.data(v.icon)!==t?E.data(v.icon):m.determine.icon()},source:function(e){return p.source?p.source:E.data(v.source)!==t?E.data(v.source):m.determine.source()},type:function(){var e=m.get.source();return b[e]!==t&&b[e].type},url:function(){return p.url?p.url:E.data(v.url)!==t?E.data(v.url):m.determine.url()}},determine:{autoplay:function(){m.should.autoplay()&&(p.autoplay=!0)},source:function(n){var o=!1;return n=n||m.get.url(),n&&e.each(b,function(e,t){if(n.search(t.domain)!==-1)return o=e,!1}),o},icon:function(){var e=m.get.source();return b[e]!==t&&b[e].icon},url:function(){var e,n=p.id||E.data(v.id),o=p.source||E.data(v.source);return e=b[o]!==t&&b[o].url.replace("{id}",n),e&&E.data(v.url,e),e}},set:{active:function(){E.addClass(h.active)}},remove:{active:function(){E.removeClass(h.active)},embed:function(){S.empty()}},encode:{parameters:function(e){var n,o=[];for(n in e)o.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return o.join("&amp;")}},generate:{embed:function(e){m.debug("Generating embed html");var n,o,t=m.get.source();return e=m.get.url(e),e?(o=m.generate.parameters(t),n=w.iframe(e,o)):m.error(g.noURL,E),n},parameters:function(n,o){var r=b[n]&&b[n].parameters!==t?b[n].parameters(p):{};return o=o||p.parameters,o&&(r=e.extend({},r,o)),r=p.onEmbed(r),m.encode.parameters(r)}},has:{embed:function(){return S.length>0},placeholder:function(){return p.placeholder||E.data(v.placeholder)}},should:{autoplay:function(){return"auto"===p.autoplay?p.placeholder||E.data(v.placeholder)!==t:p.autoplay}},is:{video:function(){return"video"==m.get.type()}},setting:function(n,o){if(m.debug("Changing setting",n,o),e.isPlainObject(n))e.extend(!0,p,n);else{if(o===t)return p[n];e.isPlainObject(p[n])?e.extend(!0,p[n],o):p[n]=o}},internal:function(n,o){if(e.isPlainObject(n))e.extend(!0,m,n);else{if(o===t)return m[n];m[n]=o}},debug:function(){!p.silent&&p.debug&&(p.performance?m.performance.log(arguments):(m.debug=Function.prototype.bind.call(console.info,console,p.name+":"),m.debug.apply(console,arguments)))},verbose:function(){!p.silent&&p.verbose&&p.debug&&(p.performance?m.performance.log(arguments):(m.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),m.verbose.apply(console,arguments)))},error:function(){p.silent||(m.error=Function.prototype.bind.call(console.error,console,p.name+":"),m.error.apply(console,arguments))},performance:{log:function(e){var n,o,t;p.performance&&(n=(new Date).getTime(),t=c||n,o=n-t,c=n,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:T,"Execution Time":o})),clearTimeout(m.performance.timer),m.performance.timer=setTimeout(m.performance.display,500)},display:function(){var n=p.name+":",o=0;c=!1,clearTimeout(m.performance.timer),e.each(l,function(e,n){o+=n["Execution Time"]}),n+=" "+o+"ms",i&&(n+=" '"+i+"'"),a.length>1&&(n+=" ("+a.length+")"),(console.group!==t||console.table!==t)&&l.length>0&&(console.groupCollapsed(n),console.table?console.table(l):e.each(l,function(e,n){console.log(n.Name+": "+n["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(n,o,a){var i,c,l,d=x;return o=o||s,a=T||a,"string"==typeof n&&d!==t&&(n=n.split(/[\. ]/),i=n.length-1,e.each(n,function(o,r){var a=o!=i?r+n[o+1].charAt(0).toUpperCase()+n[o+1].slice(1):n;if(e.isPlainObject(d[a])&&o!=i)d=d[a];else{if(d[a]!==t)return c=d[a],!1;if(!e.isPlainObject(d[r])||o==i)return d[r]!==t?(c=d[r],!1):(m.error(g.method,n),!1);d=d[r]}})),e.isFunction(c)?l=c.apply(a,o):c!==t&&(l=c),e.isArray(r)?r.push(l):r!==t?r=[r,l]:l!==t&&(r=l),c}},u?(x===t&&m.initialize(),m.invoke(d)):(x!==t&&x.invoke("destroy"),m.initialize())}),r!==t?r:this},e.fn.embed.settings={name:"Embed",namespace:"embed",silent:!1,debug:!1,verbose:!1,performance:!0,icon:!1,source:!1,url:!1,id:!1,autoplay:"auto",color:"#444444",hd:!0,brandedUI:!1,parameters:!1,onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(e){},onEmbed:function(e){return e},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},error:{noURL:"No URL specified",method:"The method you called is not defined"},className:{active:"active",embed:"embed"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(e){return{autohide:!e.brandedUI,autoplay:e.autoplay,color:e.color||t,hq:e.hd,jsapi:e.api,modestbranding:!e.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(e){return{api:e.api,autoplay:e.autoplay,byline:e.brandedUI,color:e.color||t,portrait:e.brandedUI,title:e.brandedUI}}}},templates:{iframe:function(e,n){var o=e;return n&&(o+="?"+n),'<iframe src="'+o+'" width="100%" height="100%" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(e,n){var o="";return n&&(o+='<i class="'+n+' icon"></i>'),e&&(o+='<img class="placeholder" src="'+e+'">'),o}},api:!1,onPause:function(){},onPlay:function(){},onStop:function(){}}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlbmRvci9lbWJlZC5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwiZG9jdW1lbnQiLCJ1bmRlZmluZWQiLCJNYXRoIiwic2VsZiIsIkZ1bmN0aW9uIiwiZm4iLCJlbWJlZCIsInBhcmFtZXRlcnMiLCJyZXR1cm5lZFZhbHVlIiwiJGFsbE1vZHVsZXMiLCJ0aGlzIiwibW9kdWxlU2VsZWN0b3IiLCJzZWxlY3RvciIsInRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsInBlcmZvcm1hbmNlIiwicXVlcnkiLCJhcmd1bWVudHMiLCJtZXRob2RJbnZva2VkIiwicXVlcnlBcmd1bWVudHMiLCJzbGljZSIsImNhbGwiLCJlYWNoIiwibW9kdWxlIiwic2V0dGluZ3MiLCJpc1BsYWluT2JqZWN0IiwiZXh0ZW5kIiwiY2xhc3NOYW1lIiwic291cmNlcyIsImVycm9yIiwibWV0YWRhdGEiLCJuYW1lc3BhY2UiLCJ0ZW1wbGF0ZXMiLCJldmVudE5hbWVzcGFjZSIsIm1vZHVsZU5hbWVzcGFjZSIsIiRtb2R1bGUiLCIkcGxhY2Vob2xkZXIiLCJmaW5kIiwicGxhY2Vob2xkZXIiLCIkaWNvbiIsImljb24iLCIkZW1iZWQiLCJlbGVtZW50IiwiaW5zdGFuY2UiLCJkYXRhIiwiaW5pdGlhbGl6ZSIsImRlYnVnIiwiZGV0ZXJtaW5lIiwiYXV0b3BsYXkiLCJjcmVhdGUiLCJiaW5kIiwiZXZlbnRzIiwiaW5zdGFudGlhdGUiLCJ2ZXJib3NlIiwiZGVzdHJveSIsInJlc2V0IiwicmVtb3ZlRGF0YSIsIm9mZiIsInJlZnJlc2giLCJoYXMiLCJvbiIsImNyZWF0ZUFuZFNob3ciLCJnZXQiLCJjcmVhdGVQbGFjZWhvbGRlciIsInVybCIsImdlbmVyYXRlIiwiaHRtbCIsImNyZWF0ZUVtYmVkIiwiYWRkQ2xhc3MiLCJhcHBlbmRUbyIsIm9uQ3JlYXRlIiwiY2hhbmdlRW1iZWQiLCJzaG93IiwiY2hhbmdlIiwic291cmNlIiwiaWQiLCJyZW1vdmUiLCJhY3RpdmUiLCJzaG93UGxhY2Vob2xkZXIiLCJvblJlc2V0Iiwic2V0Iiwib25EaXNwbGF5IiwiaGlkZSIsIm9uUGxhY2Vob2xkZXJEaXNwbGF5IiwidHlwZSIsInNob3VsZCIsIm1hdGNoZWRTb3VyY2UiLCJuYW1lIiwic2VhcmNoIiwiZG9tYWluIiwicmVwbGFjZSIsInJlbW92ZUNsYXNzIiwiZW1wdHkiLCJlbmNvZGUiLCJpbmRleCIsInVybFN0cmluZyIsInB1c2giLCJlbmNvZGVVUklDb21wb25lbnQiLCJqb2luIiwiaWZyYW1lIiwibm9VUkwiLCJleHRyYVBhcmFtZXRlcnMiLCJvbkVtYmVkIiwibGVuZ3RoIiwiaXMiLCJ2aWRlbyIsInNldHRpbmciLCJ2YWx1ZSIsImludGVybmFsIiwic2lsZW50IiwibG9nIiwicHJvdG90eXBlIiwiY29uc29sZSIsImluZm8iLCJhcHBseSIsIm1lc3NhZ2UiLCJjdXJyZW50VGltZSIsImV4ZWN1dGlvblRpbWUiLCJwcmV2aW91c1RpbWUiLCJOYW1lIiwiQXJndW1lbnRzIiwiRWxlbWVudCIsIkV4ZWN1dGlvbiBUaW1lIiwiY2xlYXJUaW1lb3V0IiwidGltZXIiLCJzZXRUaW1lb3V0IiwiZGlzcGxheSIsInRpdGxlIiwidG90YWxUaW1lIiwiZ3JvdXAiLCJ0YWJsZSIsImdyb3VwQ29sbGFwc2VkIiwiZ3JvdXBFbmQiLCJpbnZva2UiLCJwYXNzZWRBcmd1bWVudHMiLCJjb250ZXh0IiwibWF4RGVwdGgiLCJmb3VuZCIsInJlc3BvbnNlIiwib2JqZWN0Iiwic3BsaXQiLCJkZXB0aCIsImNhbWVsQ2FzZVZhbHVlIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJtZXRob2QiLCJpc0Z1bmN0aW9uIiwiaXNBcnJheSIsImNvbG9yIiwiaGQiLCJicmFuZGVkVUkiLCJ5b3V0dWJlIiwiYXV0b2hpZGUiLCJocSIsImpzYXBpIiwiYXBpIiwibW9kZXN0YnJhbmRpbmciLCJ2aW1lbyIsImJ5bGluZSIsInBvcnRyYWl0Iiwic3JjIiwiaW1hZ2UiLCJvblBhdXNlIiwib25QbGF5Iiwib25TdG9wIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FVQyxTQUFXQSxFQUFHQyxFQUFRQyxFQUFVQyxHQUVqQyxZQUVBRixHQUEyQixtQkFBVkEsSUFBeUJBLEVBQU9HLE1BQVFBLEtBQ3JESCxFQUNnQixtQkFBUkksT0FBdUJBLEtBQUtELE1BQVFBLEtBQzFDQyxLQUNBQyxTQUFTLGlCQUdmTixFQUFFTyxHQUFHQyxNQUFRLFNBQVNDLEdBRXBCLEdBWUVDLEdBWEFDLEVBQWtCWCxFQUFFWSxNQUVwQkMsRUFBa0JGLEVBQVlHLFVBQVksR0FFMUNDLEdBQWtCLEdBQUlDLE9BQU9DLFVBQzdCQyxLQUVBQyxFQUFrQkMsVUFBVSxHQUM1QkMsRUFBbUMsZ0JBQVRGLEdBQzFCRyxLQUFxQkMsTUFBTUMsS0FBS0osVUFBVyxFQStnQjdDLE9BMWdCQVQsR0FDR2MsS0FBSyxXQUNKLEdBd0JFQyxHQXZCQUMsRUFBb0IzQixFQUFFNEIsY0FBY25CLEdBQ2hDVCxFQUFFNkIsUUFBTyxLQUFVN0IsRUFBRU8sR0FBR0MsTUFBTW1CLFNBQVVsQixHQUN4Q1QsRUFBRTZCLFVBQVc3QixFQUFFTyxHQUFHQyxNQUFNbUIsVUFFNUJiLEVBQWtCYSxFQUFTYixTQUMzQmdCLEVBQWtCSCxFQUFTRyxVQUMzQkMsRUFBa0JKLEVBQVNJLFFBQzNCQyxFQUFrQkwsRUFBU0ssTUFDM0JDLEVBQWtCTixFQUFTTSxTQUMzQkMsRUFBa0JQLEVBQVNPLFVBQzNCQyxFQUFrQlIsRUFBU1EsVUFFM0JDLEVBQWtCLElBQU1GLEVBQ3hCRyxFQUFrQixVQUFZSCxFQUc5QkksR0FEa0J0QyxFQUFFQyxHQUNGRCxFQUFFWSxPQUNwQjJCLEVBQWtCRCxFQUFRRSxLQUFLMUIsRUFBUzJCLGFBQ3hDQyxFQUFrQkosRUFBUUUsS0FBSzFCLEVBQVM2QixNQUN4Q0MsRUFBa0JOLEVBQVFFLEtBQUsxQixFQUFTTixPQUV4Q3FDLEVBQWtCakMsS0FDbEJrQyxFQUFrQlIsRUFBUVMsS0FBS1YsRUFJakNYLElBRUVzQixXQUFZLFdBQ1Z0QixFQUFPdUIsTUFBTSxzQkFDYnZCLEVBQU93QixVQUFVQyxXQUNqQnpCLEVBQU8wQixTQUNQMUIsRUFBTzJCLEtBQUtDLFNBQ1o1QixFQUFPNkIsZUFHVEEsWUFBYSxXQUNYN0IsRUFBTzhCLFFBQVEsNkJBQThCOUIsR0FDN0NvQixFQUFXcEIsRUFDWFksRUFDR1MsS0FBS1YsRUFBaUJYLElBSTNCK0IsUUFBUyxXQUNQL0IsRUFBTzhCLFFBQVEseUNBQ2Y5QixFQUFPZ0MsUUFDUHBCLEVBQ0dxQixXQUFXdEIsR0FDWHVCLElBQUl4QixJQUlUeUIsUUFBUyxXQUNQbkMsRUFBTzhCLFFBQVEsNkJBQ2ZqQixFQUFlRCxFQUFRRSxLQUFLMUIsRUFBUzJCLGFBQ3JDQyxFQUFlSixFQUFRRSxLQUFLMUIsRUFBUzZCLE1BQ3JDQyxFQUFlTixFQUFRRSxLQUFLMUIsRUFBU04sUUFHdkM2QyxNQUNFQyxPQUFRLFdBQ0Y1QixFQUFPb0MsSUFBSXJCLGdCQUNiZixFQUFPdUIsTUFBTSw2QkFDYlgsRUFDR3lCLEdBQUcsUUFBVTNCLEVBQWdCdEIsRUFBUzJCLFlBQWFmLEVBQU9zQyxlQUMxREQsR0FBRyxRQUFVM0IsRUFBZ0J0QixFQUFTNkIsS0FBTWpCLEVBQU9zQyxrQkFNNURaLE9BQVEsV0FDTixHQUNFWCxHQUFjZixFQUFPdUMsSUFBSXhCLGFBRXhCQSxHQUNEZixFQUFPd0Msb0JBR1B4QyxFQUFPc0MsaUJBSVhFLGtCQUFtQixTQUFTekIsR0FDMUIsR0FDRUUsR0FBUWpCLEVBQU91QyxJQUFJdEIsT0FDbkJ3QixFQUFRekMsRUFBT3VDLElBQUlFLEtBQ1h6QyxHQUFPMEMsU0FBUzVELE1BQU0yRCxFQUVoQzFCLEdBQWNBLEdBQWVmLEVBQU91QyxJQUFJeEIsY0FDeENILEVBQVErQixLQUFNbEMsRUFBVU0sWUFBWUEsRUFBYUUsSUFDakRqQixFQUFPdUIsTUFBTSxpQ0FBa0NSLEVBQWFFLElBRzlEMkIsWUFBYSxTQUFTSCxHQUNwQnpDLEVBQU9tQyxVQUNQTSxFQUFNQSxHQUFPekMsRUFBT3VDLElBQUlFLE1BQ3hCdkIsRUFBUzVDLEVBQUUsVUFDUnVFLFNBQVN6QyxFQUFVdEIsT0FDbkI2RCxLQUFNM0MsRUFBTzBDLFNBQVM1RCxNQUFNMkQsSUFDNUJLLFNBQVNsQyxHQUVaWCxFQUFTOEMsU0FBU2pELEtBQUtxQixFQUFTc0IsR0FDaEN6QyxFQUFPdUIsTUFBTSx3QkFBeUJMLElBR3hDOEIsWUFBYSxTQUFTUCxHQUNwQnZCLEVBQ0d5QixLQUFNM0MsRUFBTzBDLFNBQVM1RCxNQUFNMkQsS0FJakNILGNBQWUsV0FDYnRDLEVBQU80QyxjQUNQNUMsRUFBT2lELFFBSVRDLE9BQVEsU0FBU0MsRUFBUUMsRUFBSVgsR0FDM0J6QyxFQUFPdUIsTUFBTSxxQkFBc0I0QixFQUFRQyxFQUFJWCxHQUMvQzdCLEVBQ0dTLEtBQUtkLEVBQVM0QyxPQUFRQSxHQUN0QjlCLEtBQUtkLEVBQVM2QyxHQUFJQSxHQUVsQlgsRUFDRDdCLEVBQVFTLEtBQUtkLEVBQVNrQyxJQUFLQSxHQUczQjdCLEVBQVFxQixXQUFXMUIsRUFBU2tDLEtBRTNCekMsRUFBT29DLElBQUl0RCxRQUNaa0IsRUFBT2dELGNBR1BoRCxFQUFPMEIsVUFLWE0sTUFBTyxXQUNMaEMsRUFBT3VCLE1BQU0sMENBQ2J2QixFQUFPcUQsT0FBT0MsU0FDZHRELEVBQU9xRCxPQUFPdkUsUUFDZGtCLEVBQU91RCxrQkFDUHRELEVBQVN1RCxRQUFRMUQsS0FBS3FCLElBSXhCOEIsS0FBTSxXQUNKakQsRUFBT3VCLE1BQU0saUJBQ2J2QixFQUFPeUQsSUFBSUgsU0FDWHJELEVBQVN5RCxVQUFVNUQsS0FBS3FCLElBRzFCd0MsS0FBTSxXQUNKM0QsRUFBT3VCLE1BQU0sZ0JBQ2J2QixFQUFPdUQsbUJBR1RBLGdCQUFpQixXQUNmdkQsRUFBT3VCLE1BQU0sNkJBQ2J2QixFQUFPcUQsT0FBT0MsU0FDZHJELEVBQVMyRCxxQkFBcUI5RCxLQUFLcUIsSUFHckNvQixLQUNFYSxHQUFJLFdBQ0YsTUFBT25ELEdBQVNtRCxJQUFNeEMsRUFBUVMsS0FBS2QsRUFBUzZDLEtBRTlDckMsWUFBYSxXQUNYLE1BQU9kLEdBQVNjLGFBQWVILEVBQVFTLEtBQUtkLEVBQVNRLGNBRXZERSxLQUFNLFdBQ0osTUFBUWhCLEdBQWEsS0FDakJBLEVBQVNnQixLQUNSTCxFQUFRUyxLQUFLZCxFQUFTVSxRQUFVeEMsRUFDL0JtQyxFQUFRUyxLQUFLZCxFQUFTVSxNQUN0QmpCLEVBQU93QixVQUFVUCxRQUd6QmtDLE9BQVEsU0FBU1YsR0FDZixNQUFReEMsR0FBZSxPQUNuQkEsRUFBU2tELE9BQ1J2QyxFQUFRUyxLQUFLZCxFQUFTNEMsVUFBWTFFLEVBQ2pDbUMsRUFBUVMsS0FBS2QsRUFBUzRDLFFBQ3RCbkQsRUFBT3dCLFVBQVUyQixVQUd6QlUsS0FBTSxXQUNKLEdBQUlWLEdBQVNuRCxFQUFPdUMsSUFBSVksUUFDeEIsT0FBUTlDLEdBQVE4QyxLQUFZMUUsR0FDeEI0QixFQUFROEMsR0FBUVUsTUFJdEJwQixJQUFLLFdBQ0gsTUFBUXhDLEdBQVksSUFDaEJBLEVBQVN3QyxJQUNSN0IsRUFBUVMsS0FBS2QsRUFBU2tDLE9BQVNoRSxFQUM5Qm1DLEVBQVFTLEtBQUtkLEVBQVNrQyxLQUN0QnpDLEVBQU93QixVQUFVaUIsUUFLM0JqQixXQUNFQyxTQUFVLFdBQ0x6QixFQUFPOEQsT0FBT3JDLGFBQ2Z4QixFQUFTd0IsVUFBVyxJQUd4QjBCLE9BQVEsU0FBU1YsR0FDZixHQUNFc0IsSUFBZ0IsQ0FXbEIsT0FUQXRCLEdBQU1BLEdBQU96QyxFQUFPdUMsSUFBSUUsTUFDckJBLEdBQ0RuRSxFQUFFeUIsS0FBS00sRUFBUyxTQUFTMkQsRUFBTWIsR0FDN0IsR0FBR1YsRUFBSXdCLE9BQU9kLEVBQU9lLGFBRW5CLE1BREFILEdBQWdCQyxHQUNULElBSU5ELEdBRVQ5QyxLQUFNLFdBQ0osR0FDRWtDLEdBQVNuRCxFQUFPdUMsSUFBSVksUUFFdEIsT0FBUTlDLEdBQVE4QyxLQUFZMUUsR0FDeEI0QixFQUFROEMsR0FBUWxDLE1BSXRCd0IsSUFBSyxXQUNILEdBR0VBLEdBRkFXLEVBQVNuRCxFQUFTbUQsSUFBVXhDLEVBQVFTLEtBQUtkLEVBQVM2QyxJQUNsREQsRUFBU2xELEVBQVNrRCxRQUFVdkMsRUFBUVMsS0FBS2QsRUFBUzRDLE9BVXBELE9BUEFWLEdBQU9wQyxFQUFROEMsS0FBWTFFLEdBQ3ZCNEIsRUFBUThDLEdBQVFWLElBQUkwQixRQUFRLE9BQVFmLEdBR3JDWCxHQUNEN0IsRUFBUVMsS0FBS2QsRUFBU2tDLElBQUtBLEdBRXRCQSxJQUtYZ0IsS0FDRUgsT0FBUSxXQUNOMUMsRUFBUWlDLFNBQVN6QyxFQUFVa0QsVUFJL0JELFFBQ0VDLE9BQVEsV0FDTjFDLEVBQVF3RCxZQUFZaEUsRUFBVWtELFNBRWhDeEUsTUFBTyxXQUNMb0MsRUFBT21ELFVBSVhDLFFBQ0V2RixXQUFZLFNBQVNBLEdBQ25CLEdBRUV3RixHQURBQyxJQUdGLEtBQUtELElBQVN4RixHQUNaeUYsRUFBVUMsS0FBTUMsbUJBQW1CSCxHQUFTLElBQU1HLG1CQUFvQjNGLEVBQVd3RixJQUVuRixPQUFPQyxHQUFVRyxLQUFLLFdBSTFCakMsVUFDRTVELE1BQU8sU0FBUzJELEdBQ2R6QyxFQUFPdUIsTUFBTSx3QkFDYixJQUVFb0IsR0FDQTVELEVBRkFvRSxFQUFTbkQsRUFBT3VDLElBQUlZLFFBWXRCLE9BUkFWLEdBQU16QyxFQUFPdUMsSUFBSUUsSUFBSUEsR0FDbEJBLEdBQ0QxRCxFQUFhaUIsRUFBTzBDLFNBQVMzRCxXQUFXb0UsR0FDeENSLEVBQWFsQyxFQUFVbUUsT0FBT25DLEVBQUsxRCxJQUduQ2lCLEVBQU9NLE1BQU1BLEVBQU11RSxNQUFPakUsR0FFckIrQixHQUVUNUQsV0FBWSxTQUFTb0UsRUFBUTJCLEdBQzNCLEdBQ0UvRixHQUFjc0IsRUFBUThDLElBQVc5QyxFQUFROEMsR0FBUXBFLGFBQWVOLEVBQzVENEIsRUFBUThDLEdBQVFwRSxXQUFXa0IsS0FRakMsT0FMQTZFLEdBQWtCQSxHQUFtQjdFLEVBQVNsQixXQUMzQytGLElBQ0QvRixFQUFhVCxFQUFFNkIsVUFBV3BCLEVBQVkrRixJQUV4Qy9GLEVBQWFrQixFQUFTOEUsUUFBUWhHLEdBQ3ZCaUIsRUFBT3NFLE9BQU92RixXQUFXQSxLQUlwQ3FELEtBQ0V0RCxNQUFPLFdBQ0wsTUFBUW9DLEdBQU84RCxPQUFTLEdBRTFCakUsWUFBYSxXQUNYLE1BQU9kLEdBQVNjLGFBQWVILEVBQVFTLEtBQUtkLEVBQVNRLGVBSXpEK0MsUUFDRXJDLFNBQVUsV0FDUixNQUE4QixTQUF0QnhCLEVBQVN3QixTQUNaeEIsRUFBU2MsYUFBZUgsRUFBUVMsS0FBS2QsRUFBU1EsZUFBaUJ0QyxFQUNoRXdCLEVBQVN3QixXQUtqQndELElBQ0VDLE1BQU8sV0FDTCxNQUE0QixTQUFyQmxGLEVBQU91QyxJQUFJc0IsU0FJdEJzQixRQUFTLFNBQVNuQixFQUFNb0IsR0FFdEIsR0FEQXBGLEVBQU91QixNQUFNLG1CQUFvQnlDLEVBQU1vQixHQUNuQzlHLEVBQUU0QixjQUFjOEQsR0FDbEIxRixFQUFFNkIsUUFBTyxFQUFNRixFQUFVK0QsT0FFdEIsQ0FBQSxHQUFHb0IsSUFBVTNHLEVBU2hCLE1BQU93QixHQUFTK0QsRUFSYjFGLEdBQUU0QixjQUFjRCxFQUFTK0QsSUFDMUIxRixFQUFFNkIsUUFBTyxFQUFNRixFQUFTK0QsR0FBT29CLEdBRy9CbkYsRUFBUytELEdBQVFvQixJQU92QkMsU0FBVSxTQUFTckIsRUFBTW9CLEdBQ3ZCLEdBQUk5RyxFQUFFNEIsY0FBYzhELEdBQ2xCMUYsRUFBRTZCLFFBQU8sRUFBTUgsRUFBUWdFLE9BRXBCLENBQUEsR0FBR29CLElBQVUzRyxFQUloQixNQUFPdUIsR0FBT2dFLEVBSGRoRSxHQUFPZ0UsR0FBUW9CLElBTW5CN0QsTUFBTyxZQUNEdEIsRUFBU3FGLFFBQVVyRixFQUFTc0IsUUFDM0J0QixFQUFTVCxZQUNWUSxFQUFPUixZQUFZK0YsSUFBSTdGLFlBR3ZCTSxFQUFPdUIsTUFBUTNDLFNBQVM0RyxVQUFVN0QsS0FBSzdCLEtBQUsyRixRQUFRQyxLQUFNRCxRQUFTeEYsRUFBUytELEtBQU8sS0FDbkZoRSxFQUFPdUIsTUFBTW9FLE1BQU1GLFFBQVMvRixjQUlsQ29DLFFBQVMsWUFDSDdCLEVBQVNxRixRQUFVckYsRUFBUzZCLFNBQVc3QixFQUFTc0IsUUFDL0N0QixFQUFTVCxZQUNWUSxFQUFPUixZQUFZK0YsSUFBSTdGLFlBR3ZCTSxFQUFPOEIsUUFBVWxELFNBQVM0RyxVQUFVN0QsS0FBSzdCLEtBQUsyRixRQUFRQyxLQUFNRCxRQUFTeEYsRUFBUytELEtBQU8sS0FDckZoRSxFQUFPOEIsUUFBUTZELE1BQU1GLFFBQVMvRixjQUlwQ1ksTUFBTyxXQUNETCxFQUFTcUYsU0FDWHRGLEVBQU9NLE1BQVExQixTQUFTNEcsVUFBVTdELEtBQUs3QixLQUFLMkYsUUFBUW5GLE1BQU9tRixRQUFTeEYsRUFBUytELEtBQU8sS0FDcEZoRSxFQUFPTSxNQUFNcUYsTUFBTUYsUUFBUy9GLGFBR2hDRixhQUNFK0YsSUFBSyxTQUFTSyxHQUNaLEdBQ0VDLEdBQ0FDLEVBQ0FDLENBRUM5RixHQUFTVCxjQUNWcUcsR0FBZ0IsR0FBSXZHLE9BQU9DLFVBQzNCd0csRUFBZ0IxRyxHQUFRd0csRUFDeEJDLEVBQWdCRCxFQUFjRSxFQUM5QjFHLEVBQWdCd0csRUFDaEJyRyxFQUFZaUYsTUFDVnVCLEtBQW1CSixFQUFRLEdBQzNCSyxhQUFzQnBHLE1BQU1DLEtBQUs4RixFQUFTLElBQU0sR0FDaERNLFFBQW1CL0UsRUFDbkJnRixpQkFBbUJMLEtBR3ZCTSxhQUFhcEcsRUFBT1IsWUFBWTZHLE9BQ2hDckcsRUFBT1IsWUFBWTZHLE1BQVFDLFdBQVd0RyxFQUFPUixZQUFZK0csUUFBUyxNQUVwRUEsUUFBUyxXQUNQLEdBQ0VDLEdBQVF2RyxFQUFTK0QsS0FBTyxJQUN4QnlDLEVBQVksQ0FFZHBILElBQU8sRUFDUCtHLGFBQWFwRyxFQUFPUixZQUFZNkcsT0FDaEMvSCxFQUFFeUIsS0FBS1AsRUFBYSxTQUFTK0UsRUFBT2xELEdBQ2xDb0YsR0FBYXBGLEVBQUssb0JBRXBCbUYsR0FBUyxJQUFNQyxFQUFZLEtBQ3hCdEgsSUFDRHFILEdBQVMsS0FBUXJILEVBQWlCLEtBRWpDRixFQUFZK0YsT0FBUyxJQUN0QndCLEdBQVMsS0FBWXZILEVBQVkrRixPQUFTLE1BRXZDUyxRQUFRaUIsUUFBVWpJLEdBQWFnSCxRQUFRa0IsUUFBVWxJLElBQWNlLEVBQVl3RixPQUFTLElBQ3ZGUyxRQUFRbUIsZUFBZUosR0FDcEJmLFFBQVFrQixNQUNUbEIsUUFBUWtCLE1BQU1uSCxHQUdkbEIsRUFBRXlCLEtBQUtQLEVBQWEsU0FBUytFLEVBQU9sRCxHQUNsQ29FLFFBQVFGLElBQUlsRSxFQUFXLEtBQUksS0FBT0EsRUFBSyxrQkFBa0IsUUFHN0RvRSxRQUFRb0IsWUFFVnJILE9BR0pzSCxPQUFRLFNBQVNySCxFQUFPc0gsRUFBaUJDLEdBQ3ZDLEdBRUVDLEdBQ0FDLEVBQ0FDLEVBSEFDLEVBQVNoRyxDQWtEWCxPQTdDQTJGLEdBQWtCQSxHQUFtQm5ILEVBQ3JDb0gsRUFBa0I3RixHQUFtQjZGLEVBQ2xCLGdCQUFUdkgsSUFBcUIySCxJQUFXM0ksSUFDeENnQixFQUFXQSxFQUFNNEgsTUFBTSxTQUN2QkosRUFBV3hILEVBQU11RixPQUFTLEVBQzFCMUcsRUFBRXlCLEtBQUtOLEVBQU8sU0FBUzZILEVBQU9sQyxHQUM1QixHQUFJbUMsR0FBa0JELEdBQVNMLEVBQzNCN0IsRUFBUTNGLEVBQU02SCxFQUFRLEdBQUdFLE9BQU8sR0FBR0MsY0FBZ0JoSSxFQUFNNkgsRUFBUSxHQUFHekgsTUFBTSxHQUMxRUosQ0FFSixJQUFJbkIsRUFBRTRCLGNBQWVrSCxFQUFPRyxLQUFzQkQsR0FBU0wsRUFDekRHLEVBQVNBLEVBQU9HLE9BRWIsQ0FBQSxHQUFJSCxFQUFPRyxLQUFvQjlJLEVBRWxDLE1BREF5SSxHQUFRRSxFQUFPRyxJQUNSLENBRUosS0FBSWpKLEVBQUU0QixjQUFla0gsRUFBT2hDLEtBQWFrQyxHQUFTTCxFQUdsRCxNQUFJRyxHQUFPaEMsS0FBVzNHLEdBQ3pCeUksRUFBUUUsRUFBT2hDLElBQ1IsSUFHUHBGLEVBQU9NLE1BQU1BLEVBQU1vSCxPQUFRakksSUFDcEIsRUFSUDJILEdBQVNBLEVBQU9oQyxPQVlqQjlHLEVBQUVxSixXQUFZVCxHQUNqQkMsRUFBV0QsRUFBTXZCLE1BQU1xQixFQUFTRCxHQUUxQkcsSUFBVXpJLElBQ2hCMEksRUFBV0QsR0FFVjVJLEVBQUVzSixRQUFRNUksR0FDWEEsRUFBY3lGLEtBQUswQyxHQUVibkksSUFBa0JQLEVBQ3hCTyxHQUFpQkEsRUFBZW1JLEdBRTFCQSxJQUFhMUksSUFDbkJPLEVBQWdCbUksR0FFWEQsSUFJUnZILEdBQ0V5QixJQUFhM0MsR0FDZHVCLEVBQU9zQixhQUVUdEIsRUFBTzhHLE9BQU9ySCxLQUdYMkIsSUFBYTNDLEdBQ2QyQyxFQUFTMEYsT0FBTyxXQUVsQjlHLEVBQU9zQixnQkFJTHRDLElBQWtCUCxFQUN0Qk8sRUFDQUUsTUFJTlosRUFBRU8sR0FBR0MsTUFBTW1CLFVBRVQrRCxLQUFjLFFBQ2R4RCxVQUFjLFFBRWQ4RSxRQUFjLEVBQ2QvRCxPQUFjLEVBQ2RPLFNBQWMsRUFDZHRDLGFBQWMsRUFFZHlCLE1BQVcsRUFDWGtDLFFBQVcsRUFDWFYsS0FBVyxFQUNYVyxJQUFXLEVBR1gzQixTQUFZLE9BQ1pvRyxNQUFZLFVBQ1pDLElBQVksRUFDWkMsV0FBWSxFQUdaaEosWUFBWSxFQUVaMkUsVUFBdUIsYUFDdkJFLHFCQUF1QixhQUN2QkosUUFBdUIsYUFDdkJULFNBQXVCLFNBQVNOLEtBQ2hDc0MsUUFBdUIsU0FBU2hHLEdBQzlCLE1BQU9BLElBR1R3QixVQUNFNkMsR0FBYyxLQUNkbkMsS0FBYyxPQUNkRixZQUFjLGNBQ2RvQyxPQUFjLFNBQ2RWLElBQWMsT0FHaEJuQyxPQUNFdUUsTUFBUyxtQkFDVDZDLE9BQVMsd0NBR1h0SCxXQUNFa0QsT0FBUyxTQUNUeEUsTUFBUyxTQUdYTSxVQUNFTixNQUFjLFNBQ2RpQyxZQUFjLGVBQ2RFLEtBQWMsU0FHaEJaLFNBQ0UySCxTQUNFaEUsS0FBUyxVQUNUSCxLQUFTLFFBQ1Q1QyxLQUFTLGFBQ1RpRCxPQUFTLGNBQ1R6QixJQUFTLCtCQUNUMUQsV0FBWSxTQUFTa0IsR0FDbkIsT0FDRWdJLFVBQWtCaEksRUFBUzhILFVBQzNCdEcsU0FBaUJ4QixFQUFTd0IsU0FDMUJvRyxNQUFpQjVILEVBQVM0SCxPQUFTcEosRUFDbkN5SixHQUFpQmpJLEVBQVM2SCxHQUMxQkssTUFBaUJsSSxFQUFTbUksSUFDMUJDLGdCQUFrQnBJLEVBQVM4SCxhQUlqQ08sT0FDRXRFLEtBQVMsUUFDVEgsS0FBUyxRQUNUNUMsS0FBUyxhQUNUaUQsT0FBUyxZQUNUekIsSUFBUyxnQ0FDVDFELFdBQVksU0FBU2tCLEdBQ25CLE9BQ0VtSSxJQUFXbkksRUFBU21JLElBQ3BCM0csU0FBV3hCLEVBQVN3QixTQUNwQjhHLE9BQVd0SSxFQUFTOEgsVUFDcEJGLE1BQVc1SCxFQUFTNEgsT0FBU3BKLEVBQzdCK0osU0FBV3ZJLEVBQVM4SCxVQUNwQnZCLE1BQVd2RyxFQUFTOEgsY0FNNUJ0SCxXQUNFbUUsT0FBUyxTQUFTbkMsRUFBSzFELEdBQ3JCLEdBQUkwSixHQUFNaEcsQ0FJVixPQUhJMUQsS0FDQTBKLEdBQU8sSUFBTTFKLEdBRVYsZ0JBQ2UwSixFQUFNLGtJQUs5QjFILFlBQWMsU0FBUzJILEVBQU96SCxHQUM1QixHQUNFMEIsR0FBTyxFQVFULE9BTkcxQixLQUNEMEIsR0FBUSxhQUFlMUIsRUFBTyxlQUU3QnlILElBQ0QvRixHQUFRLGlDQUFtQytGLEVBQVEsTUFFOUMvRixJQUtYeUYsS0FBVSxFQUNWTyxRQUFVLGFBQ1ZDLE9BQVUsYUFDVkMsT0FBVSxlQU1SQyxPQUFRdkssT0FBUUMiLCJmaWxlIjoidmVuZG9yL2VtYmVkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiAjIFNlbWFudGljIFVJIDIuMi43IC0gRW1iZWRcbiAqIGh0dHA6Ly9naXRodWIuY29tL3NlbWFudGljLW9yZy9zZW1hbnRpYy11aS9cbiAqXG4gKlxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUXG4gKlxuICovXG5cbjsoZnVuY3Rpb24gKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuXG5cInVzZSBzdHJpY3RcIjtcblxud2luZG93ID0gKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aClcbiAgPyB3aW5kb3dcbiAgOiAodHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGgpXG4gICAgPyBzZWxmXG4gICAgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpXG47XG5cbiQuZm4uZW1iZWQgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7XG5cbiAgdmFyXG4gICAgJGFsbE1vZHVsZXMgICAgID0gJCh0aGlzKSxcblxuICAgIG1vZHVsZVNlbGVjdG9yICA9ICRhbGxNb2R1bGVzLnNlbGVjdG9yIHx8ICcnLFxuXG4gICAgdGltZSAgICAgICAgICAgID0gbmV3IERhdGUoKS5nZXRUaW1lKCksXG4gICAgcGVyZm9ybWFuY2UgICAgID0gW10sXG5cbiAgICBxdWVyeSAgICAgICAgICAgPSBhcmd1bWVudHNbMF0sXG4gICAgbWV0aG9kSW52b2tlZCAgID0gKHR5cGVvZiBxdWVyeSA9PSAnc3RyaW5nJyksXG4gICAgcXVlcnlBcmd1bWVudHMgID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLFxuXG4gICAgcmV0dXJuZWRWYWx1ZVxuICA7XG5cbiAgJGFsbE1vZHVsZXNcbiAgICAuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgIHZhclxuICAgICAgICBzZXR0aW5ncyAgICAgICAgPSAoICQuaXNQbGFpbk9iamVjdChwYXJhbWV0ZXJzKSApXG4gICAgICAgICAgPyAkLmV4dGVuZCh0cnVlLCB7fSwgJC5mbi5lbWJlZC5zZXR0aW5ncywgcGFyYW1ldGVycylcbiAgICAgICAgICA6ICQuZXh0ZW5kKHt9LCAkLmZuLmVtYmVkLnNldHRpbmdzKSxcblxuICAgICAgICBzZWxlY3RvciAgICAgICAgPSBzZXR0aW5ncy5zZWxlY3RvcixcbiAgICAgICAgY2xhc3NOYW1lICAgICAgID0gc2V0dGluZ3MuY2xhc3NOYW1lLFxuICAgICAgICBzb3VyY2VzICAgICAgICAgPSBzZXR0aW5ncy5zb3VyY2VzLFxuICAgICAgICBlcnJvciAgICAgICAgICAgPSBzZXR0aW5ncy5lcnJvcixcbiAgICAgICAgbWV0YWRhdGEgICAgICAgID0gc2V0dGluZ3MubWV0YWRhdGEsXG4gICAgICAgIG5hbWVzcGFjZSAgICAgICA9IHNldHRpbmdzLm5hbWVzcGFjZSxcbiAgICAgICAgdGVtcGxhdGVzICAgICAgID0gc2V0dGluZ3MudGVtcGxhdGVzLFxuXG4gICAgICAgIGV2ZW50TmFtZXNwYWNlICA9ICcuJyArIG5hbWVzcGFjZSxcbiAgICAgICAgbW9kdWxlTmFtZXNwYWNlID0gJ21vZHVsZS0nICsgbmFtZXNwYWNlLFxuXG4gICAgICAgICR3aW5kb3cgICAgICAgICA9ICQod2luZG93KSxcbiAgICAgICAgJG1vZHVsZSAgICAgICAgID0gJCh0aGlzKSxcbiAgICAgICAgJHBsYWNlaG9sZGVyICAgID0gJG1vZHVsZS5maW5kKHNlbGVjdG9yLnBsYWNlaG9sZGVyKSxcbiAgICAgICAgJGljb24gICAgICAgICAgID0gJG1vZHVsZS5maW5kKHNlbGVjdG9yLmljb24pLFxuICAgICAgICAkZW1iZWQgICAgICAgICAgPSAkbW9kdWxlLmZpbmQoc2VsZWN0b3IuZW1iZWQpLFxuXG4gICAgICAgIGVsZW1lbnQgICAgICAgICA9IHRoaXMsXG4gICAgICAgIGluc3RhbmNlICAgICAgICA9ICRtb2R1bGUuZGF0YShtb2R1bGVOYW1lc3BhY2UpLFxuICAgICAgICBtb2R1bGVcbiAgICAgIDtcblxuICAgICAgbW9kdWxlID0ge1xuXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnSW5pdGlhbGl6aW5nIGVtYmVkJyk7XG4gICAgICAgICAgbW9kdWxlLmRldGVybWluZS5hdXRvcGxheSgpO1xuICAgICAgICAgIG1vZHVsZS5jcmVhdGUoKTtcbiAgICAgICAgICBtb2R1bGUuYmluZC5ldmVudHMoKTtcbiAgICAgICAgICBtb2R1bGUuaW5zdGFudGlhdGUoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpbnN0YW50aWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbW9kdWxlLnZlcmJvc2UoJ1N0b3JpbmcgaW5zdGFuY2Ugb2YgbW9kdWxlJywgbW9kdWxlKTtcbiAgICAgICAgICBpbnN0YW5jZSA9IG1vZHVsZTtcbiAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAuZGF0YShtb2R1bGVOYW1lc3BhY2UsIG1vZHVsZSlcbiAgICAgICAgICA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbW9kdWxlLnZlcmJvc2UoJ0Rlc3Ryb3lpbmcgcHJldmlvdXMgaW5zdGFuY2Ugb2YgZW1iZWQnKTtcbiAgICAgICAgICBtb2R1bGUucmVzZXQoKTtcbiAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAucmVtb3ZlRGF0YShtb2R1bGVOYW1lc3BhY2UpXG4gICAgICAgICAgICAub2ZmKGV2ZW50TmFtZXNwYWNlKVxuICAgICAgICAgIDtcbiAgICAgICAgfSxcblxuICAgICAgICByZWZyZXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBtb2R1bGUudmVyYm9zZSgnUmVmcmVzaGluZyBzZWxlY3RvciBjYWNoZScpO1xuICAgICAgICAgICRwbGFjZWhvbGRlciA9ICRtb2R1bGUuZmluZChzZWxlY3Rvci5wbGFjZWhvbGRlcik7XG4gICAgICAgICAgJGljb24gICAgICAgID0gJG1vZHVsZS5maW5kKHNlbGVjdG9yLmljb24pO1xuICAgICAgICAgICRlbWJlZCAgICAgICA9ICRtb2R1bGUuZmluZChzZWxlY3Rvci5lbWJlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmluZDoge1xuICAgICAgICAgIGV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiggbW9kdWxlLmhhcy5wbGFjZWhvbGRlcigpICkge1xuICAgICAgICAgICAgICBtb2R1bGUuZGVidWcoJ0FkZGluZyBwbGFjZWhvbGRlciBldmVudHMnKTtcbiAgICAgICAgICAgICAgJG1vZHVsZVxuICAgICAgICAgICAgICAgIC5vbignY2xpY2snICsgZXZlbnROYW1lc3BhY2UsIHNlbGVjdG9yLnBsYWNlaG9sZGVyLCBtb2R1bGUuY3JlYXRlQW5kU2hvdylcbiAgICAgICAgICAgICAgICAub24oJ2NsaWNrJyArIGV2ZW50TmFtZXNwYWNlLCBzZWxlY3Rvci5pY29uLCBtb2R1bGUuY3JlYXRlQW5kU2hvdylcbiAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhclxuICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBtb2R1bGUuZ2V0LnBsYWNlaG9sZGVyKClcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYocGxhY2Vob2xkZXIpIHtcbiAgICAgICAgICAgIG1vZHVsZS5jcmVhdGVQbGFjZWhvbGRlcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1vZHVsZS5jcmVhdGVBbmRTaG93KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVBsYWNlaG9sZGVyOiBmdW5jdGlvbihwbGFjZWhvbGRlcikge1xuICAgICAgICAgIHZhclxuICAgICAgICAgICAgaWNvbiAgPSBtb2R1bGUuZ2V0Lmljb24oKSxcbiAgICAgICAgICAgIHVybCAgID0gbW9kdWxlLmdldC51cmwoKSxcbiAgICAgICAgICAgIGVtYmVkID0gbW9kdWxlLmdlbmVyYXRlLmVtYmVkKHVybClcbiAgICAgICAgICA7XG4gICAgICAgICAgcGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlciB8fCBtb2R1bGUuZ2V0LnBsYWNlaG9sZGVyKCk7XG4gICAgICAgICAgJG1vZHVsZS5odG1sKCB0ZW1wbGF0ZXMucGxhY2Vob2xkZXIocGxhY2Vob2xkZXIsIGljb24pICk7XG4gICAgICAgICAgbW9kdWxlLmRlYnVnKCdDcmVhdGluZyBwbGFjZWhvbGRlciBmb3IgZW1iZWQnLCBwbGFjZWhvbGRlciwgaWNvbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlRW1iZWQ6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICAgIG1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgdXJsID0gdXJsIHx8IG1vZHVsZS5nZXQudXJsKCk7XG4gICAgICAgICAgJGVtYmVkID0gJCgnPGRpdi8+JylcbiAgICAgICAgICAgIC5hZGRDbGFzcyhjbGFzc05hbWUuZW1iZWQpXG4gICAgICAgICAgICAuaHRtbCggbW9kdWxlLmdlbmVyYXRlLmVtYmVkKHVybCkgKVxuICAgICAgICAgICAgLmFwcGVuZFRvKCRtb2R1bGUpXG4gICAgICAgICAgO1xuICAgICAgICAgIHNldHRpbmdzLm9uQ3JlYXRlLmNhbGwoZWxlbWVudCwgdXJsKTtcbiAgICAgICAgICBtb2R1bGUuZGVidWcoJ0NyZWF0aW5nIGVtYmVkIG9iamVjdCcsICRlbWJlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hhbmdlRW1iZWQ6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICAgICRlbWJlZFxuICAgICAgICAgICAgLmh0bWwoIG1vZHVsZS5nZW5lcmF0ZS5lbWJlZCh1cmwpIClcbiAgICAgICAgICA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQW5kU2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbW9kdWxlLmNyZWF0ZUVtYmVkKCk7XG4gICAgICAgICAgbW9kdWxlLnNob3coKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBzZXRzIG5ldyBlbWJlZFxuICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uKHNvdXJjZSwgaWQsIHVybCkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnQ2hhbmdpbmcgdmlkZW8gdG8gJywgc291cmNlLCBpZCwgdXJsKTtcbiAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAuZGF0YShtZXRhZGF0YS5zb3VyY2UsIHNvdXJjZSlcbiAgICAgICAgICAgIC5kYXRhKG1ldGFkYXRhLmlkLCBpZClcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYodXJsKSB7XG4gICAgICAgICAgICAkbW9kdWxlLmRhdGEobWV0YWRhdGEudXJsLCB1cmwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICRtb2R1bGUucmVtb3ZlRGF0YShtZXRhZGF0YS51cmwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihtb2R1bGUuaGFzLmVtYmVkKCkpIHtcbiAgICAgICAgICAgIG1vZHVsZS5jaGFuZ2VFbWJlZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1vZHVsZS5jcmVhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gY2xlYXJzIGVtYmVkXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBtb2R1bGUuZGVidWcoJ0NsZWFyaW5nIGVtYmVkIGFuZCBzaG93aW5nIHBsYWNlaG9sZGVyJyk7XG4gICAgICAgICAgbW9kdWxlLnJlbW92ZS5hY3RpdmUoKTtcbiAgICAgICAgICBtb2R1bGUucmVtb3ZlLmVtYmVkKCk7XG4gICAgICAgICAgbW9kdWxlLnNob3dQbGFjZWhvbGRlcigpO1xuICAgICAgICAgIHNldHRpbmdzLm9uUmVzZXQuY2FsbChlbGVtZW50KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBzaG93cyBjdXJyZW50IGVtYmVkXG4gICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnU2hvd2luZyBlbWJlZCcpO1xuICAgICAgICAgIG1vZHVsZS5zZXQuYWN0aXZlKCk7XG4gICAgICAgICAgc2V0dGluZ3Mub25EaXNwbGF5LmNhbGwoZWxlbWVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbW9kdWxlLmRlYnVnKCdIaWRpbmcgZW1iZWQnKTtcbiAgICAgICAgICBtb2R1bGUuc2hvd1BsYWNlaG9sZGVyKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd1BsYWNlaG9sZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBtb2R1bGUuZGVidWcoJ1Nob3dpbmcgcGxhY2Vob2xkZXIgaW1hZ2UnKTtcbiAgICAgICAgICBtb2R1bGUucmVtb3ZlLmFjdGl2ZSgpO1xuICAgICAgICAgIHNldHRpbmdzLm9uUGxhY2Vob2xkZXJEaXNwbGF5LmNhbGwoZWxlbWVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0OiB7XG4gICAgICAgICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzLmlkIHx8ICRtb2R1bGUuZGF0YShtZXRhZGF0YS5pZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gc2V0dGluZ3MucGxhY2Vob2xkZXIgfHwgJG1vZHVsZS5kYXRhKG1ldGFkYXRhLnBsYWNlaG9sZGVyKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGljb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIChzZXR0aW5ncy5pY29uKVxuICAgICAgICAgICAgICA/IHNldHRpbmdzLmljb25cbiAgICAgICAgICAgICAgOiAoJG1vZHVsZS5kYXRhKG1ldGFkYXRhLmljb24pICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgPyAkbW9kdWxlLmRhdGEobWV0YWRhdGEuaWNvbilcbiAgICAgICAgICAgICAgICA6IG1vZHVsZS5kZXRlcm1pbmUuaWNvbigpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzb3VyY2U6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICAgICAgcmV0dXJuIChzZXR0aW5ncy5zb3VyY2UpXG4gICAgICAgICAgICAgID8gc2V0dGluZ3Muc291cmNlXG4gICAgICAgICAgICAgIDogKCRtb2R1bGUuZGF0YShtZXRhZGF0YS5zb3VyY2UpICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgPyAkbW9kdWxlLmRhdGEobWV0YWRhdGEuc291cmNlKVxuICAgICAgICAgICAgICAgIDogbW9kdWxlLmRldGVybWluZS5zb3VyY2UoKVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdHlwZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gbW9kdWxlLmdldC5zb3VyY2UoKTtcbiAgICAgICAgICAgIHJldHVybiAoc291cmNlc1tzb3VyY2VdICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgID8gc291cmNlc1tzb3VyY2VdLnR5cGVcbiAgICAgICAgICAgICAgOiBmYWxzZVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdXJsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAoc2V0dGluZ3MudXJsKVxuICAgICAgICAgICAgICA/IHNldHRpbmdzLnVybFxuICAgICAgICAgICAgICA6ICgkbW9kdWxlLmRhdGEobWV0YWRhdGEudXJsKSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgID8gJG1vZHVsZS5kYXRhKG1ldGFkYXRhLnVybClcbiAgICAgICAgICAgICAgICA6IG1vZHVsZS5kZXRlcm1pbmUudXJsKClcbiAgICAgICAgICAgIDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGV0ZXJtaW5lOiB7XG4gICAgICAgICAgYXV0b3BsYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYobW9kdWxlLnNob3VsZC5hdXRvcGxheSgpKSB7XG4gICAgICAgICAgICAgIHNldHRpbmdzLmF1dG9wbGF5ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHNvdXJjZTogZnVuY3Rpb24odXJsKSB7XG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgbWF0Y2hlZFNvdXJjZSA9IGZhbHNlXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICB1cmwgPSB1cmwgfHwgbW9kdWxlLmdldC51cmwoKTtcbiAgICAgICAgICAgIGlmKHVybCkge1xuICAgICAgICAgICAgICAkLmVhY2goc291cmNlcywgZnVuY3Rpb24obmFtZSwgc291cmNlKSB7XG4gICAgICAgICAgICAgICAgaWYodXJsLnNlYXJjaChzb3VyY2UuZG9tYWluKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgIG1hdGNoZWRTb3VyY2UgPSBuYW1lO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlZFNvdXJjZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGljb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIHNvdXJjZSA9IG1vZHVsZS5nZXQuc291cmNlKClcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHJldHVybiAoc291cmNlc1tzb3VyY2VdICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgID8gc291cmNlc1tzb3VyY2VdLmljb25cbiAgICAgICAgICAgICAgOiBmYWxzZVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdXJsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBpZCAgICAgPSBzZXR0aW5ncy5pZCAgICAgfHwgJG1vZHVsZS5kYXRhKG1ldGFkYXRhLmlkKSxcbiAgICAgICAgICAgICAgc291cmNlID0gc2V0dGluZ3Muc291cmNlIHx8ICRtb2R1bGUuZGF0YShtZXRhZGF0YS5zb3VyY2UpLFxuICAgICAgICAgICAgICB1cmxcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHVybCA9IChzb3VyY2VzW3NvdXJjZV0gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgPyBzb3VyY2VzW3NvdXJjZV0udXJsLnJlcGxhY2UoJ3tpZH0nLCBpZClcbiAgICAgICAgICAgICAgOiBmYWxzZVxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgaWYodXJsKSB7XG4gICAgICAgICAgICAgICRtb2R1bGUuZGF0YShtZXRhZGF0YS51cmwsIHVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuXG4gICAgICAgIHNldDoge1xuICAgICAgICAgIGFjdGl2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbW9kdWxlLmFkZENsYXNzKGNsYXNzTmFtZS5hY3RpdmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmU6IHtcbiAgICAgICAgICBhY3RpdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJG1vZHVsZS5yZW1vdmVDbGFzcyhjbGFzc05hbWUuYWN0aXZlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVtYmVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRlbWJlZC5lbXB0eSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBlbmNvZGU6IHtcbiAgICAgICAgICBwYXJhbWV0ZXJzOiBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgdXJsU3RyaW5nID0gW10sXG4gICAgICAgICAgICAgIGluZGV4XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBmb3IgKGluZGV4IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgdXJsU3RyaW5nLnB1c2goIGVuY29kZVVSSUNvbXBvbmVudChpbmRleCkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoIHBhcmFtZXRlcnNbaW5kZXhdICkgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1cmxTdHJpbmcuam9pbignJmFtcDsnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2VuZXJhdGU6IHtcbiAgICAgICAgICBlbWJlZDogZnVuY3Rpb24odXJsKSB7XG4gICAgICAgICAgICBtb2R1bGUuZGVidWcoJ0dlbmVyYXRpbmcgZW1iZWQgaHRtbCcpO1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIHNvdXJjZSA9IG1vZHVsZS5nZXQuc291cmNlKCksXG4gICAgICAgICAgICAgIGh0bWwsXG4gICAgICAgICAgICAgIHBhcmFtZXRlcnNcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIHVybCA9IG1vZHVsZS5nZXQudXJsKHVybCk7XG4gICAgICAgICAgICBpZih1cmwpIHtcbiAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IG1vZHVsZS5nZW5lcmF0ZS5wYXJhbWV0ZXJzKHNvdXJjZSk7XG4gICAgICAgICAgICAgIGh0bWwgICAgICAgPSB0ZW1wbGF0ZXMuaWZyYW1lKHVybCwgcGFyYW1ldGVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgbW9kdWxlLmVycm9yKGVycm9yLm5vVVJMLCAkbW9kdWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBodG1sO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcGFyYW1ldGVyczogZnVuY3Rpb24oc291cmNlLCBleHRyYVBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gKHNvdXJjZXNbc291cmNlXSAmJiBzb3VyY2VzW3NvdXJjZV0ucGFyYW1ldGVycyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgID8gc291cmNlc1tzb3VyY2VdLnBhcmFtZXRlcnMoc2V0dGluZ3MpXG4gICAgICAgICAgICAgICAgOiB7fVxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgZXh0cmFQYXJhbWV0ZXJzID0gZXh0cmFQYXJhbWV0ZXJzIHx8IHNldHRpbmdzLnBhcmFtZXRlcnM7XG4gICAgICAgICAgICBpZihleHRyYVBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgcGFyYW1ldGVycyA9ICQuZXh0ZW5kKHt9LCBwYXJhbWV0ZXJzLCBleHRyYVBhcmFtZXRlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyYW1ldGVycyA9IHNldHRpbmdzLm9uRW1iZWQocGFyYW1ldGVycyk7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmVuY29kZS5wYXJhbWV0ZXJzKHBhcmFtZXRlcnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBoYXM6IHtcbiAgICAgICAgICBlbWJlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKCRlbWJlZC5sZW5ndGggPiAwKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBsYWNlaG9sZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5wbGFjZWhvbGRlciB8fCAkbW9kdWxlLmRhdGEobWV0YWRhdGEucGxhY2Vob2xkZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzaG91bGQ6IHtcbiAgICAgICAgICBhdXRvcGxheTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKHNldHRpbmdzLmF1dG9wbGF5ID09PSAnYXV0bycpXG4gICAgICAgICAgICAgID8gKHNldHRpbmdzLnBsYWNlaG9sZGVyIHx8ICRtb2R1bGUuZGF0YShtZXRhZGF0YS5wbGFjZWhvbGRlcikgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgOiBzZXR0aW5ncy5hdXRvcGxheVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBpczoge1xuICAgICAgICAgIHZpZGVvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGUuZ2V0LnR5cGUoKSA9PSAndmlkZW8nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzZXR0aW5nOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnQ2hhbmdpbmcgc2V0dGluZycsIG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICBpZiggJC5pc1BsYWluT2JqZWN0KG5hbWUpICkge1xuICAgICAgICAgICAgJC5leHRlbmQodHJ1ZSwgc2V0dGluZ3MsIG5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmKCQuaXNQbGFpbk9iamVjdChzZXR0aW5nc1tuYW1lXSkpIHtcbiAgICAgICAgICAgICAgJC5leHRlbmQodHJ1ZSwgc2V0dGluZ3NbbmFtZV0sIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBzZXR0aW5nc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzZXR0aW5nc1tuYW1lXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGludGVybmFsOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgIGlmKCAkLmlzUGxhaW5PYmplY3QobmFtZSkgKSB7XG4gICAgICAgICAgICAkLmV4dGVuZCh0cnVlLCBtb2R1bGUsIG5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG1vZHVsZVtuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGVbbmFtZV07XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkZWJ1ZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYoIXNldHRpbmdzLnNpbGVudCAmJiBzZXR0aW5ncy5kZWJ1Zykge1xuICAgICAgICAgICAgaWYoc2V0dGluZ3MucGVyZm9ybWFuY2UpIHtcbiAgICAgICAgICAgICAgbW9kdWxlLnBlcmZvcm1hbmNlLmxvZyhhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIG1vZHVsZS5kZWJ1ZyA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5pbmZvLCBjb25zb2xlLCBzZXR0aW5ncy5uYW1lICsgJzonKTtcbiAgICAgICAgICAgICAgbW9kdWxlLmRlYnVnLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2ZXJib3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZighc2V0dGluZ3Muc2lsZW50ICYmIHNldHRpbmdzLnZlcmJvc2UgJiYgc2V0dGluZ3MuZGVidWcpIHtcbiAgICAgICAgICAgIGlmKHNldHRpbmdzLnBlcmZvcm1hbmNlKSB7XG4gICAgICAgICAgICAgIG1vZHVsZS5wZXJmb3JtYW5jZS5sb2coYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBtb2R1bGUudmVyYm9zZSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5pbmZvLCBjb25zb2xlLCBzZXR0aW5ncy5uYW1lICsgJzonKTtcbiAgICAgICAgICAgICAgbW9kdWxlLnZlcmJvc2UuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZighc2V0dGluZ3Muc2lsZW50KSB7XG4gICAgICAgICAgICBtb2R1bGUuZXJyb3IgPSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGNvbnNvbGUuZXJyb3IsIGNvbnNvbGUsIHNldHRpbmdzLm5hbWUgKyAnOicpO1xuICAgICAgICAgICAgbW9kdWxlLmVycm9yLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwZXJmb3JtYW5jZToge1xuICAgICAgICAgIGxvZzogZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGN1cnJlbnRUaW1lLFxuICAgICAgICAgICAgICBleGVjdXRpb25UaW1lLFxuICAgICAgICAgICAgICBwcmV2aW91c1RpbWVcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmKHNldHRpbmdzLnBlcmZvcm1hbmNlKSB7XG4gICAgICAgICAgICAgIGN1cnJlbnRUaW1lICAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgcHJldmlvdXNUaW1lICA9IHRpbWUgfHwgY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgIGV4ZWN1dGlvblRpbWUgPSBjdXJyZW50VGltZSAtIHByZXZpb3VzVGltZTtcbiAgICAgICAgICAgICAgdGltZSAgICAgICAgICA9IGN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICBwZXJmb3JtYW5jZS5wdXNoKHtcbiAgICAgICAgICAgICAgICAnTmFtZScgICAgICAgICAgIDogbWVzc2FnZVswXSxcbiAgICAgICAgICAgICAgICAnQXJndW1lbnRzJyAgICAgIDogW10uc2xpY2UuY2FsbChtZXNzYWdlLCAxKSB8fCAnJyxcbiAgICAgICAgICAgICAgICAnRWxlbWVudCcgICAgICAgIDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICAnRXhlY3V0aW9uIFRpbWUnIDogZXhlY3V0aW9uVGltZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFyVGltZW91dChtb2R1bGUucGVyZm9ybWFuY2UudGltZXIpO1xuICAgICAgICAgICAgbW9kdWxlLnBlcmZvcm1hbmNlLnRpbWVyID0gc2V0VGltZW91dChtb2R1bGUucGVyZm9ybWFuY2UuZGlzcGxheSwgNTAwKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRpc3BsYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIHRpdGxlID0gc2V0dGluZ3MubmFtZSArICc6JyxcbiAgICAgICAgICAgICAgdG90YWxUaW1lID0gMFxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgdGltZSA9IGZhbHNlO1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KG1vZHVsZS5wZXJmb3JtYW5jZS50aW1lcik7XG4gICAgICAgICAgICAkLmVhY2gocGVyZm9ybWFuY2UsIGZ1bmN0aW9uKGluZGV4LCBkYXRhKSB7XG4gICAgICAgICAgICAgIHRvdGFsVGltZSArPSBkYXRhWydFeGVjdXRpb24gVGltZSddO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aXRsZSArPSAnICcgKyB0b3RhbFRpbWUgKyAnbXMnO1xuICAgICAgICAgICAgaWYobW9kdWxlU2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgdGl0bGUgKz0gJyBcXCcnICsgbW9kdWxlU2VsZWN0b3IgKyAnXFwnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCRhbGxNb2R1bGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgdGl0bGUgKz0gJyAnICsgJygnICsgJGFsbE1vZHVsZXMubGVuZ3RoICsgJyknO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIChjb25zb2xlLmdyb3VwICE9PSB1bmRlZmluZWQgfHwgY29uc29sZS50YWJsZSAhPT0gdW5kZWZpbmVkKSAmJiBwZXJmb3JtYW5jZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQodGl0bGUpO1xuICAgICAgICAgICAgICBpZihjb25zb2xlLnRhYmxlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS50YWJsZShwZXJmb3JtYW5jZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJC5lYWNoKHBlcmZvcm1hbmNlLCBmdW5jdGlvbihpbmRleCwgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YVsnTmFtZSddICsgJzogJyArIGRhdGFbJ0V4ZWN1dGlvbiBUaW1lJ10rJ21zJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGVyZm9ybWFuY2UgPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGludm9rZTogZnVuY3Rpb24ocXVlcnksIHBhc3NlZEFyZ3VtZW50cywgY29udGV4dCkge1xuICAgICAgICAgIHZhclxuICAgICAgICAgICAgb2JqZWN0ID0gaW5zdGFuY2UsXG4gICAgICAgICAgICBtYXhEZXB0aCxcbiAgICAgICAgICAgIGZvdW5kLFxuICAgICAgICAgICAgcmVzcG9uc2VcbiAgICAgICAgICA7XG4gICAgICAgICAgcGFzc2VkQXJndW1lbnRzID0gcGFzc2VkQXJndW1lbnRzIHx8IHF1ZXJ5QXJndW1lbnRzO1xuICAgICAgICAgIGNvbnRleHQgICAgICAgICA9IGVsZW1lbnQgICAgICAgICB8fCBjb250ZXh0O1xuICAgICAgICAgIGlmKHR5cGVvZiBxdWVyeSA9PSAnc3RyaW5nJyAmJiBvYmplY3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnkgICAgPSBxdWVyeS5zcGxpdCgvW1xcLiBdLyk7XG4gICAgICAgICAgICBtYXhEZXB0aCA9IHF1ZXJ5Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAkLmVhY2gocXVlcnksIGZ1bmN0aW9uKGRlcHRoLCB2YWx1ZSkge1xuICAgICAgICAgICAgICB2YXIgY2FtZWxDYXNlVmFsdWUgPSAoZGVwdGggIT0gbWF4RGVwdGgpXG4gICAgICAgICAgICAgICAgPyB2YWx1ZSArIHF1ZXJ5W2RlcHRoICsgMV0uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeVtkZXB0aCArIDFdLnNsaWNlKDEpXG4gICAgICAgICAgICAgICAgOiBxdWVyeVxuICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgIGlmKCAkLmlzUGxhaW5PYmplY3QoIG9iamVjdFtjYW1lbENhc2VWYWx1ZV0gKSAmJiAoZGVwdGggIT0gbWF4RGVwdGgpICkge1xuICAgICAgICAgICAgICAgIG9iamVjdCA9IG9iamVjdFtjYW1lbENhc2VWYWx1ZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZiggb2JqZWN0W2NhbWVsQ2FzZVZhbHVlXSAhPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gb2JqZWN0W2NhbWVsQ2FzZVZhbHVlXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZiggJC5pc1BsYWluT2JqZWN0KCBvYmplY3RbdmFsdWVdICkgJiYgKGRlcHRoICE9IG1heERlcHRoKSApIHtcbiAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3RbdmFsdWVdO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2UgaWYoIG9iamVjdFt2YWx1ZV0gIT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IG9iamVjdFt2YWx1ZV07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vZHVsZS5lcnJvcihlcnJvci5tZXRob2QsIHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoICQuaXNGdW5jdGlvbiggZm91bmQgKSApIHtcbiAgICAgICAgICAgIHJlc3BvbnNlID0gZm91bmQuYXBwbHkoY29udGV4dCwgcGFzc2VkQXJndW1lbnRzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihmb3VuZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXNwb25zZSA9IGZvdW5kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZigkLmlzQXJyYXkocmV0dXJuZWRWYWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybmVkVmFsdWUucHVzaChyZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYocmV0dXJuZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm5lZFZhbHVlID0gW3JldHVybmVkVmFsdWUsIHJlc3BvbnNlXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihyZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm5lZFZhbHVlID0gcmVzcG9uc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgaWYobWV0aG9kSW52b2tlZCkge1xuICAgICAgICBpZihpbnN0YW5jZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbW9kdWxlLmluaXRpYWxpemUoKTtcbiAgICAgICAgfVxuICAgICAgICBtb2R1bGUuaW52b2tlKHF1ZXJ5KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZihpbnN0YW5jZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaW5zdGFuY2UuaW52b2tlKCdkZXN0cm95Jyk7XG4gICAgICAgIH1cbiAgICAgICAgbW9kdWxlLmluaXRpYWxpemUoKTtcbiAgICAgIH1cbiAgICB9KVxuICA7XG4gIHJldHVybiAocmV0dXJuZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKVxuICAgID8gcmV0dXJuZWRWYWx1ZVxuICAgIDogdGhpc1xuICA7XG59O1xuXG4kLmZuLmVtYmVkLnNldHRpbmdzID0ge1xuXG4gIG5hbWUgICAgICAgIDogJ0VtYmVkJyxcbiAgbmFtZXNwYWNlICAgOiAnZW1iZWQnLFxuXG4gIHNpbGVudCAgICAgIDogZmFsc2UsXG4gIGRlYnVnICAgICAgIDogZmFsc2UsXG4gIHZlcmJvc2UgICAgIDogZmFsc2UsXG4gIHBlcmZvcm1hbmNlIDogdHJ1ZSxcblxuICBpY29uICAgICA6IGZhbHNlLFxuICBzb3VyY2UgICA6IGZhbHNlLFxuICB1cmwgICAgICA6IGZhbHNlLFxuICBpZCAgICAgICA6IGZhbHNlLFxuXG4gIC8vIHN0YW5kYXJkIHZpZGVvIHNldHRpbmdzXG4gIGF1dG9wbGF5ICA6ICdhdXRvJyxcbiAgY29sb3IgICAgIDogJyM0NDQ0NDQnLFxuICBoZCAgICAgICAgOiB0cnVlLFxuICBicmFuZGVkVUkgOiBmYWxzZSxcblxuICAvLyBhZGRpdGlvbmFsIHBhcmFtZXRlcnMgdG8gaW5jbHVkZSB3aXRoIHRoZSBlbWJlZFxuICBwYXJhbWV0ZXJzOiBmYWxzZSxcblxuICBvbkRpc3BsYXkgICAgICAgICAgICA6IGZ1bmN0aW9uKCkge30sXG4gIG9uUGxhY2Vob2xkZXJEaXNwbGF5IDogZnVuY3Rpb24oKSB7fSxcbiAgb25SZXNldCAgICAgICAgICAgICAgOiBmdW5jdGlvbigpIHt9LFxuICBvbkNyZWF0ZSAgICAgICAgICAgICA6IGZ1bmN0aW9uKHVybCkge30sXG4gIG9uRW1iZWQgICAgICAgICAgICAgIDogZnVuY3Rpb24ocGFyYW1ldGVycykge1xuICAgIHJldHVybiBwYXJhbWV0ZXJzO1xuICB9LFxuXG4gIG1ldGFkYXRhICAgIDoge1xuICAgIGlkICAgICAgICAgIDogJ2lkJyxcbiAgICBpY29uICAgICAgICA6ICdpY29uJyxcbiAgICBwbGFjZWhvbGRlciA6ICdwbGFjZWhvbGRlcicsXG4gICAgc291cmNlICAgICAgOiAnc291cmNlJyxcbiAgICB1cmwgICAgICAgICA6ICd1cmwnXG4gIH0sXG5cbiAgZXJyb3IgOiB7XG4gICAgbm9VUkwgIDogJ05vIFVSTCBzcGVjaWZpZWQnLFxuICAgIG1ldGhvZCA6ICdUaGUgbWV0aG9kIHlvdSBjYWxsZWQgaXMgbm90IGRlZmluZWQnXG4gIH0sXG5cbiAgY2xhc3NOYW1lIDoge1xuICAgIGFjdGl2ZSA6ICdhY3RpdmUnLFxuICAgIGVtYmVkICA6ICdlbWJlZCdcbiAgfSxcblxuICBzZWxlY3RvciA6IHtcbiAgICBlbWJlZCAgICAgICA6ICcuZW1iZWQnLFxuICAgIHBsYWNlaG9sZGVyIDogJy5wbGFjZWhvbGRlcicsXG4gICAgaWNvbiAgICAgICAgOiAnLmljb24nXG4gIH0sXG5cbiAgc291cmNlczoge1xuICAgIHlvdXR1YmU6IHtcbiAgICAgIG5hbWUgICA6ICd5b3V0dWJlJyxcbiAgICAgIHR5cGUgICA6ICd2aWRlbycsXG4gICAgICBpY29uICAgOiAndmlkZW8gcGxheScsXG4gICAgICBkb21haW4gOiAneW91dHViZS5jb20nLFxuICAgICAgdXJsICAgIDogJy8vd3d3LnlvdXR1YmUuY29tL2VtYmVkL3tpZH0nLFxuICAgICAgcGFyYW1ldGVyczogZnVuY3Rpb24oc2V0dGluZ3MpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhdXRvaGlkZSAgICAgICA6ICFzZXR0aW5ncy5icmFuZGVkVUksXG4gICAgICAgICAgYXV0b3BsYXkgICAgICAgOiBzZXR0aW5ncy5hdXRvcGxheSxcbiAgICAgICAgICBjb2xvciAgICAgICAgICA6IHNldHRpbmdzLmNvbG9yIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICBocSAgICAgICAgICAgICA6IHNldHRpbmdzLmhkLFxuICAgICAgICAgIGpzYXBpICAgICAgICAgIDogc2V0dGluZ3MuYXBpLFxuICAgICAgICAgIG1vZGVzdGJyYW5kaW5nIDogIXNldHRpbmdzLmJyYW5kZWRVSVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgdmltZW86IHtcbiAgICAgIG5hbWUgICA6ICd2aW1lbycsXG4gICAgICB0eXBlICAgOiAndmlkZW8nLFxuICAgICAgaWNvbiAgIDogJ3ZpZGVvIHBsYXknLFxuICAgICAgZG9tYWluIDogJ3ZpbWVvLmNvbScsXG4gICAgICB1cmwgICAgOiAnLy9wbGF5ZXIudmltZW8uY29tL3ZpZGVvL3tpZH0nLFxuICAgICAgcGFyYW1ldGVyczogZnVuY3Rpb24oc2V0dGluZ3MpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhcGkgICAgICA6IHNldHRpbmdzLmFwaSxcbiAgICAgICAgICBhdXRvcGxheSA6IHNldHRpbmdzLmF1dG9wbGF5LFxuICAgICAgICAgIGJ5bGluZSAgIDogc2V0dGluZ3MuYnJhbmRlZFVJLFxuICAgICAgICAgIGNvbG9yICAgIDogc2V0dGluZ3MuY29sb3IgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIHBvcnRyYWl0IDogc2V0dGluZ3MuYnJhbmRlZFVJLFxuICAgICAgICAgIHRpdGxlICAgIDogc2V0dGluZ3MuYnJhbmRlZFVJXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHRlbXBsYXRlczoge1xuICAgIGlmcmFtZSA6IGZ1bmN0aW9uKHVybCwgcGFyYW1ldGVycykge1xuICAgICAgdmFyIHNyYyA9IHVybDtcbiAgICAgIGlmIChwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgc3JjICs9ICc/JyArIHBhcmFtZXRlcnM7XG4gICAgICB9XG4gICAgICByZXR1cm4gJydcbiAgICAgICAgKyAnPGlmcmFtZSBzcmM9XCInICsgc3JjICsgJ1wiJ1xuICAgICAgICArICcgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiJ1xuICAgICAgICArICcgZnJhbWVib3JkZXI9XCIwXCIgc2Nyb2xsaW5nPVwibm9cIiB3ZWJraXRBbGxvd0Z1bGxTY3JlZW4gbW96YWxsb3dmdWxsc2NyZWVuIGFsbG93RnVsbFNjcmVlbj48L2lmcmFtZT4nXG4gICAgICA7XG4gICAgfSxcbiAgICBwbGFjZWhvbGRlciA6IGZ1bmN0aW9uKGltYWdlLCBpY29uKSB7XG4gICAgICB2YXJcbiAgICAgICAgaHRtbCA9ICcnXG4gICAgICA7XG4gICAgICBpZihpY29uKSB7XG4gICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwiJyArIGljb24gKyAnIGljb25cIj48L2k+JztcbiAgICAgIH1cbiAgICAgIGlmKGltYWdlKSB7XG4gICAgICAgIGh0bWwgKz0gJzxpbWcgY2xhc3M9XCJwbGFjZWhvbGRlclwiIHNyYz1cIicgKyBpbWFnZSArICdcIj4nO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfVxuICB9LFxuXG4gIC8vIE5PVCBZRVQgSU1QTEVNRU5URURcbiAgYXBpICAgICA6IGZhbHNlLFxuICBvblBhdXNlIDogZnVuY3Rpb24oKSB7fSxcbiAgb25QbGF5ICA6IGZ1bmN0aW9uKCkge30sXG4gIG9uU3RvcCAgOiBmdW5jdGlvbigpIHt9XG5cbn07XG5cblxuXG59KSggalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50ICk7XG4iXX0=
