!function(e,n,t,i){"use strict";n="undefined"!=typeof n&&n.Math==Math?n:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.rating=function(n){var t,a=e(this),o=a.selector||"",r=(new Date).getTime(),s=[],l=arguments[0],c="string"==typeof l,u=[].slice.call(arguments,1);return a.each(function(){var d,g,m=e.isPlainObject(n)?e.extend(!0,{},e.fn.rating.settings,n):e.extend({},e.fn.rating.settings),f=m.namespace,v=m.className,p=m.metadata,b=m.selector,h=(m.error,"."+f),y="module-"+f,x=this,R=e(this).data(y),C=e(this),T=C.find(b.icon);g={initialize:function(){g.verbose("Initializing rating module",m),0===T.length&&g.setup.layout(),m.interactive?g.enable():g.disable(),g.set.initialLoad(),g.set.rating(g.get.initialRating()),g.remove.initialLoad(),g.instantiate()},instantiate:function(){g.verbose("Instantiating module",m),R=g,C.data(y,g)},destroy:function(){g.verbose("Destroying previous instance",R),g.remove.events(),C.removeData(y)},refresh:function(){T=C.find(b.icon)},setup:{layout:function(){var n=g.get.maxRating(),t=e.fn.rating.settings.templates.icon(n);g.debug("Generating icon html dynamically"),C.html(t),g.refresh()}},event:{mouseenter:function(){var n=e(this);n.nextAll().removeClass(v.selected),C.addClass(v.selected),n.addClass(v.selected).prevAll().addClass(v.selected)},mouseleave:function(){C.removeClass(v.selected),T.removeClass(v.selected)},click:function(){var n=e(this),t=g.get.rating(),i=T.index(n)+1,a="auto"==m.clearable?1===T.length:m.clearable;a&&t==i?g.clearRating():g.set.rating(i)}},clearRating:function(){g.debug("Clearing current rating"),g.set.rating(0)},bind:{events:function(){g.verbose("Binding events"),C.on("mouseenter"+h,b.icon,g.event.mouseenter).on("mouseleave"+h,b.icon,g.event.mouseleave).on("click"+h,b.icon,g.event.click)}},remove:{events:function(){g.verbose("Removing events"),C.off(h)},initialLoad:function(){d=!1}},enable:function(){g.debug("Setting rating to interactive mode"),g.bind.events(),C.removeClass(v.disabled)},disable:function(){g.debug("Setting rating to read-only mode"),g.remove.events(),C.addClass(v.disabled)},is:{initialLoad:function(){return d}},get:{initialRating:function(){return C.data(p.rating)!==i?(C.removeData(p.rating),C.data(p.rating)):m.initialRating},maxRating:function(){return C.data(p.maxRating)!==i?(C.removeData(p.maxRating),C.data(p.maxRating)):m.maxRating},rating:function(){var e=T.filter("."+v.active).length;return g.verbose("Current rating retrieved",e),e}},set:{rating:function(e){var n=e-1>=0?e-1:0,t=T.eq(n);C.removeClass(v.selected),T.removeClass(v.selected).removeClass(v.active),e>0&&(g.verbose("Setting current rating to",e),t.prevAll().addBack().addClass(v.active)),g.is.initialLoad()||m.onRate.call(x,e)},initialLoad:function(){d=!0}},setting:function(n,t){if(g.debug("Changing setting",n,t),e.isPlainObject(n))e.extend(!0,m,n);else{if(t===i)return m[n];e.isPlainObject(m[n])?e.extend(!0,m[n],t):m[n]=t}},internal:function(n,t){if(e.isPlainObject(n))e.extend(!0,g,n);else{if(t===i)return g[n];g[n]=t}},debug:function(){!m.silent&&m.debug&&(m.performance?g.performance.log(arguments):(g.debug=Function.prototype.bind.call(console.info,console,m.name+":"),g.debug.apply(console,arguments)))},verbose:function(){!m.silent&&m.verbose&&m.debug&&(m.performance?g.performance.log(arguments):(g.verbose=Function.prototype.bind.call(console.info,console,m.name+":"),g.verbose.apply(console,arguments)))},error:function(){m.silent||(g.error=Function.prototype.bind.call(console.error,console,m.name+":"),g.error.apply(console,arguments))},performance:{log:function(e){var n,t,i;m.performance&&(n=(new Date).getTime(),i=r||n,t=n-i,r=n,s.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:x,"Execution Time":t})),clearTimeout(g.performance.timer),g.performance.timer=setTimeout(g.performance.display,500)},display:function(){var n=m.name+":",t=0;r=!1,clearTimeout(g.performance.timer),e.each(s,function(e,n){t+=n["Execution Time"]}),n+=" "+t+"ms",o&&(n+=" '"+o+"'"),a.length>1&&(n+=" ("+a.length+")"),(console.group!==i||console.table!==i)&&s.length>0&&(console.groupCollapsed(n),console.table?console.table(s):e.each(s,function(e,n){console.log(n.Name+": "+n["Execution Time"]+"ms")}),console.groupEnd()),s=[]}},invoke:function(n,a,o){var r,s,l,c=R;return a=a||u,o=x||o,"string"==typeof n&&c!==i&&(n=n.split(/[\. ]/),r=n.length-1,e.each(n,function(t,a){var o=t!=r?a+n[t+1].charAt(0).toUpperCase()+n[t+1].slice(1):n;if(e.isPlainObject(c[o])&&t!=r)c=c[o];else{if(c[o]!==i)return s=c[o],!1;if(!e.isPlainObject(c[a])||t==r)return c[a]!==i&&(s=c[a],!1);c=c[a]}})),e.isFunction(s)?l=s.apply(o,a):s!==i&&(l=s),e.isArray(t)?t.push(l):t!==i?t=[t,l]:l!==i&&(t=l),s}},c?(R===i&&g.initialize(),g.invoke(l)):(R!==i&&R.invoke("destroy"),g.initialize())}),t!==i?t:this},e.fn.rating.settings={name:"Rating",namespace:"rating",slent:!1,debug:!1,verbose:!1,performance:!0,initialRating:0,interactive:!0,maxRating:4,clearable:"auto",fireOnInit:!1,onRate:function(e){},error:{method:"The method you called is not defined",noMaximum:"No maximum rating specified. Cannot generate HTML automatically"},metadata:{rating:"rating",maxRating:"maxRating"},className:{active:"active",disabled:"disabled",selected:"selected",loading:"loading"},selector:{icon:".icon"},templates:{icon:function(e){for(var n=1,t="";n<=e;)t+='<i class="icon"></i>',n++;return t}}}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlbmRvci9yYXRpbmcuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiTWF0aCIsInNlbGYiLCJGdW5jdGlvbiIsImZuIiwicmF0aW5nIiwicGFyYW1ldGVycyIsInJldHVybmVkVmFsdWUiLCIkYWxsTW9kdWxlcyIsInRoaXMiLCJtb2R1bGVTZWxlY3RvciIsInNlbGVjdG9yIiwidGltZSIsIkRhdGUiLCJnZXRUaW1lIiwicGVyZm9ybWFuY2UiLCJxdWVyeSIsImFyZ3VtZW50cyIsIm1ldGhvZEludm9rZWQiLCJxdWVyeUFyZ3VtZW50cyIsInNsaWNlIiwiY2FsbCIsImVhY2giLCJpbml0aWFsTG9hZCIsIm1vZHVsZSIsInNldHRpbmdzIiwiaXNQbGFpbk9iamVjdCIsImV4dGVuZCIsIm5hbWVzcGFjZSIsImNsYXNzTmFtZSIsIm1ldGFkYXRhIiwiZXZlbnROYW1lc3BhY2UiLCJlcnJvciIsIm1vZHVsZU5hbWVzcGFjZSIsImVsZW1lbnQiLCJpbnN0YW5jZSIsImRhdGEiLCIkbW9kdWxlIiwiJGljb24iLCJmaW5kIiwiaWNvbiIsImluaXRpYWxpemUiLCJ2ZXJib3NlIiwibGVuZ3RoIiwic2V0dXAiLCJsYXlvdXQiLCJpbnRlcmFjdGl2ZSIsImVuYWJsZSIsImRpc2FibGUiLCJzZXQiLCJnZXQiLCJpbml0aWFsUmF0aW5nIiwicmVtb3ZlIiwiaW5zdGFudGlhdGUiLCJkZXN0cm95IiwiZXZlbnRzIiwicmVtb3ZlRGF0YSIsInJlZnJlc2giLCJtYXhSYXRpbmciLCJodG1sIiwidGVtcGxhdGVzIiwiZGVidWciLCJldmVudCIsIm1vdXNlZW50ZXIiLCIkYWN0aXZlSWNvbiIsIm5leHRBbGwiLCJyZW1vdmVDbGFzcyIsInNlbGVjdGVkIiwiYWRkQ2xhc3MiLCJwcmV2QWxsIiwibW91c2VsZWF2ZSIsImNsaWNrIiwiY3VycmVudFJhdGluZyIsImluZGV4IiwiY2FuQ2xlYXIiLCJjbGVhcmFibGUiLCJjbGVhclJhdGluZyIsImJpbmQiLCJvbiIsIm9mZiIsImRpc2FibGVkIiwiaXMiLCJmaWx0ZXIiLCJhY3RpdmUiLCJyYXRpbmdJbmRleCIsImVxIiwiYWRkQmFjayIsIm9uUmF0ZSIsInNldHRpbmciLCJuYW1lIiwidmFsdWUiLCJpbnRlcm5hbCIsInNpbGVudCIsImxvZyIsInByb3RvdHlwZSIsImNvbnNvbGUiLCJpbmZvIiwiYXBwbHkiLCJtZXNzYWdlIiwiY3VycmVudFRpbWUiLCJleGVjdXRpb25UaW1lIiwicHJldmlvdXNUaW1lIiwicHVzaCIsIk5hbWUiLCJBcmd1bWVudHMiLCJFbGVtZW50IiwiRXhlY3V0aW9uIFRpbWUiLCJjbGVhclRpbWVvdXQiLCJ0aW1lciIsInNldFRpbWVvdXQiLCJkaXNwbGF5IiwidGl0bGUiLCJ0b3RhbFRpbWUiLCJncm91cCIsInRhYmxlIiwiZ3JvdXBDb2xsYXBzZWQiLCJncm91cEVuZCIsImludm9rZSIsInBhc3NlZEFyZ3VtZW50cyIsImNvbnRleHQiLCJtYXhEZXB0aCIsImZvdW5kIiwicmVzcG9uc2UiLCJvYmplY3QiLCJzcGxpdCIsImRlcHRoIiwiY2FtZWxDYXNlVmFsdWUiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsImlzRnVuY3Rpb24iLCJpc0FycmF5Iiwic2xlbnQiLCJmaXJlT25Jbml0IiwibWV0aG9kIiwibm9NYXhpbXVtIiwibG9hZGluZyIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBVUMsU0FBV0EsRUFBR0MsRUFBUUMsRUFBVUMsR0FFakMsWUFFQUYsR0FBMkIsbUJBQVZBLElBQXlCQSxFQUFPRyxNQUFRQSxLQUNyREgsRUFDZ0IsbUJBQVJJLE9BQXVCQSxLQUFLRCxNQUFRQSxLQUMxQ0MsS0FDQUMsU0FBUyxpQkFHZk4sRUFBRU8sR0FBR0MsT0FBUyxTQUFTQyxHQUNyQixHQVVFQyxHQVRBQyxFQUFrQlgsRUFBRVksTUFDcEJDLEVBQWtCRixFQUFZRyxVQUFZLEdBRTFDQyxHQUFrQixHQUFJQyxPQUFPQyxVQUM3QkMsS0FFQUMsRUFBa0JDLFVBQVUsR0FDNUJD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LE1BSU5aLEVBQUVPLEdBQUdDLE9BQU9vQixVQUVWZ0UsS0FBZ0IsU0FDaEI3RCxVQUFnQixTQUVoQnVHLE9BQWdCLEVBQ2hCdEUsT0FBZ0IsRUFDaEJuQixTQUFnQixFQUNoQjNCLGFBQWdCLEVBRWhCb0MsY0FBZ0IsRUFDaEJMLGFBQWdCLEVBQ2hCWSxVQUFnQixFQUNoQmlCLFVBQWdCLE9BRWhCeUQsWUFBZ0IsRUFFaEI3QyxPQUFnQixTQUFTbEYsS0FFekIyQixPQUNFcUcsT0FBWSx1Q0FDWkMsVUFBWSxtRUFJZHhHLFVBQ0V6QixPQUFZLFNBQ1pxRCxVQUFZLGFBR2Q3QixXQUNFc0QsT0FBVyxTQUNYSCxTQUFXLFdBQ1hiLFNBQVcsV0FDWG9FLFFBQVcsV0FHYjVILFVBQ0U2QixLQUFPLFNBR1RvQixXQUNFcEIsS0FBTSxTQUFTa0IsR0FLYixJQUpBLEdBQ0VsQixHQUFPLEVBQ1BtQixFQUFPLEdBRUhuQixHQUFRa0IsR0FDWkMsR0FBUSx1QkFDUm5CLEdBRUYsT0FBT21CLE9BTVQ2RSxPQUFRMUksT0FBUUMiLCJmaWxlIjoidmVuZG9yL3JhdGluZy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogIyBTZW1hbnRpYyBVSSAyLjIuNyAtIFJhdGluZ1xuICogaHR0cDovL2dpdGh1Yi5jb20vc2VtYW50aWMtb3JnL3NlbWFudGljLXVpL1xuICpcbiAqXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAqXG4gKi9cblxuOyhmdW5jdGlvbiAoJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG53aW5kb3cgPSAodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoKVxuICA/IHdpbmRvd1xuICA6ICh0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aClcbiAgICA/IHNlbGZcbiAgICA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClcbjtcblxuJC5mbi5yYXRpbmcgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7XG4gIHZhclxuICAgICRhbGxNb2R1bGVzICAgICA9ICQodGhpcyksXG4gICAgbW9kdWxlU2VsZWN0b3IgID0gJGFsbE1vZHVsZXMuc2VsZWN0b3IgfHwgJycsXG5cbiAgICB0aW1lICAgICAgICAgICAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICBwZXJmb3JtYW5jZSAgICAgPSBbXSxcblxuICAgIHF1ZXJ5ICAgICAgICAgICA9IGFyZ3VtZW50c1swXSxcbiAgICBtZXRob2RJbnZva2VkICAgPSAodHlwZW9mIHF1ZXJ5ID09ICdzdHJpbmcnKSxcbiAgICBxdWVyeUFyZ3VtZW50cyAgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXG4gICAgcmV0dXJuZWRWYWx1ZVxuICA7XG4gICRhbGxNb2R1bGVzXG4gICAgLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICB2YXJcbiAgICAgICAgc2V0dGluZ3MgICAgICAgID0gKCAkLmlzUGxhaW5PYmplY3QocGFyYW1ldGVycykgKVxuICAgICAgICAgID8gJC5leHRlbmQodHJ1ZSwge30sICQuZm4ucmF0aW5nLnNldHRpbmdzLCBwYXJhbWV0ZXJzKVxuICAgICAgICAgIDogJC5leHRlbmQoe30sICQuZm4ucmF0aW5nLnNldHRpbmdzKSxcblxuICAgICAgICBuYW1lc3BhY2UgICAgICAgPSBzZXR0aW5ncy5uYW1lc3BhY2UsXG4gICAgICAgIGNsYXNzTmFtZSAgICAgICA9IHNldHRpbmdzLmNsYXNzTmFtZSxcbiAgICAgICAgbWV0YWRhdGEgICAgICAgID0gc2V0dGluZ3MubWV0YWRhdGEsXG4gICAgICAgIHNlbGVjdG9yICAgICAgICA9IHNldHRpbmdzLnNlbGVjdG9yLFxuICAgICAgICBlcnJvciAgICAgICAgICAgPSBzZXR0aW5ncy5lcnJvcixcblxuICAgICAgICBldmVudE5hbWVzcGFjZSAgPSAnLicgKyBuYW1lc3BhY2UsXG4gICAgICAgIG1vZHVsZU5hbWVzcGFjZSA9ICdtb2R1bGUtJyArIG5hbWVzcGFjZSxcblxuICAgICAgICBlbGVtZW50ICAgICAgICAgPSB0aGlzLFxuICAgICAgICBpbnN0YW5jZSAgICAgICAgPSAkKHRoaXMpLmRhdGEobW9kdWxlTmFtZXNwYWNlKSxcblxuICAgICAgICAkbW9kdWxlICAgICAgICAgPSAkKHRoaXMpLFxuICAgICAgICAkaWNvbiAgICAgICAgICAgPSAkbW9kdWxlLmZpbmQoc2VsZWN0b3IuaWNvbiksXG5cbiAgICAgICAgaW5pdGlhbExvYWQsXG4gICAgICAgIG1vZHVsZVxuICAgICAgO1xuXG4gICAgICBtb2R1bGUgPSB7XG5cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbW9kdWxlLnZlcmJvc2UoJ0luaXRpYWxpemluZyByYXRpbmcgbW9kdWxlJywgc2V0dGluZ3MpO1xuXG4gICAgICAgICAgaWYoJGljb24ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBtb2R1bGUuc2V0dXAubGF5b3V0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYoc2V0dGluZ3MuaW50ZXJhY3RpdmUpIHtcbiAgICAgICAgICAgIG1vZHVsZS5lbmFibGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtb2R1bGUuZGlzYWJsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtb2R1bGUuc2V0LmluaXRpYWxMb2FkKCk7XG4gICAgICAgICAgbW9kdWxlLnNldC5yYXRpbmcoIG1vZHVsZS5nZXQuaW5pdGlhbFJhdGluZygpICk7XG4gICAgICAgICAgbW9kdWxlLnJlbW92ZS5pbml0aWFsTG9hZCgpO1xuICAgICAgICAgIG1vZHVsZS5pbnN0YW50aWF0ZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluc3RhbnRpYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBtb2R1bGUudmVyYm9zZSgnSW5zdGFudGlhdGluZyBtb2R1bGUnLCBzZXR0aW5ncyk7XG4gICAgICAgICAgaW5zdGFuY2UgPSBtb2R1bGU7XG4gICAgICAgICAgJG1vZHVsZVxuICAgICAgICAgICAgLmRhdGEobW9kdWxlTmFtZXNwYWNlLCBtb2R1bGUpXG4gICAgICAgICAgO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1vZHVsZS52ZXJib3NlKCdEZXN0cm95aW5nIHByZXZpb3VzIGluc3RhbmNlJywgaW5zdGFuY2UpO1xuICAgICAgICAgIG1vZHVsZS5yZW1vdmUuZXZlbnRzKCk7XG4gICAgICAgICAgJG1vZHVsZVxuICAgICAgICAgICAgLnJlbW92ZURhdGEobW9kdWxlTmFtZXNwYWNlKVxuICAgICAgICAgIDtcbiAgICAgICAgfSxcblxuICAgICAgICByZWZyZXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkaWNvbiAgID0gJG1vZHVsZS5maW5kKHNlbGVjdG9yLmljb24pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldHVwOiB7XG4gICAgICAgICAgbGF5b3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBtYXhSYXRpbmcgPSBtb2R1bGUuZ2V0Lm1heFJhdGluZygpLFxuICAgICAgICAgICAgICBodG1sICAgICAgPSAkLmZuLnJhdGluZy5zZXR0aW5ncy50ZW1wbGF0ZXMuaWNvbihtYXhSYXRpbmcpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBtb2R1bGUuZGVidWcoJ0dlbmVyYXRpbmcgaWNvbiBodG1sIGR5bmFtaWNhbGx5Jyk7XG4gICAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAgIC5odG1sKGh0bWwpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBtb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBldmVudDoge1xuICAgICAgICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgICRhY3RpdmVJY29uID0gJCh0aGlzKVxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgJGFjdGl2ZUljb25cbiAgICAgICAgICAgICAgLm5leHRBbGwoKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhjbGFzc05hbWUuc2VsZWN0ZWQpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAgIC5hZGRDbGFzcyhjbGFzc05hbWUuc2VsZWN0ZWQpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICAkYWN0aXZlSWNvblxuICAgICAgICAgICAgICAuYWRkQ2xhc3MoY2xhc3NOYW1lLnNlbGVjdGVkKVxuICAgICAgICAgICAgICAgIC5wcmV2QWxsKClcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoY2xhc3NOYW1lLnNlbGVjdGVkKVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbW91c2VsZWF2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhjbGFzc05hbWUuc2VsZWN0ZWQpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICAkaWNvblxuICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lLnNlbGVjdGVkKVxuICAgICAgICAgICAgO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgICRhY3RpdmVJY29uICAgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICBjdXJyZW50UmF0aW5nID0gbW9kdWxlLmdldC5yYXRpbmcoKSxcbiAgICAgICAgICAgICAgcmF0aW5nICAgICAgICA9ICRpY29uLmluZGV4KCRhY3RpdmVJY29uKSArIDEsXG4gICAgICAgICAgICAgIGNhbkNsZWFyICAgICAgPSAoc2V0dGluZ3MuY2xlYXJhYmxlID09ICdhdXRvJylcbiAgICAgICAgICAgICAgID8gKCRpY29uLmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgICAgIDogc2V0dGluZ3MuY2xlYXJhYmxlXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBpZihjYW5DbGVhciAmJiBjdXJyZW50UmF0aW5nID09IHJhdGluZykge1xuICAgICAgICAgICAgICBtb2R1bGUuY2xlYXJSYXRpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBtb2R1bGUuc2V0LnJhdGluZyggcmF0aW5nICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNsZWFyUmF0aW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBtb2R1bGUuZGVidWcoJ0NsZWFyaW5nIGN1cnJlbnQgcmF0aW5nJyk7XG4gICAgICAgICAgbW9kdWxlLnNldC5yYXRpbmcoMCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmluZDoge1xuICAgICAgICAgIGV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBtb2R1bGUudmVyYm9zZSgnQmluZGluZyBldmVudHMnKTtcbiAgICAgICAgICAgICRtb2R1bGVcbiAgICAgICAgICAgICAgLm9uKCdtb3VzZWVudGVyJyArIGV2ZW50TmFtZXNwYWNlLCBzZWxlY3Rvci5pY29uLCBtb2R1bGUuZXZlbnQubW91c2VlbnRlcilcbiAgICAgICAgICAgICAgLm9uKCdtb3VzZWxlYXZlJyArIGV2ZW50TmFtZXNwYWNlLCBzZWxlY3Rvci5pY29uLCBtb2R1bGUuZXZlbnQubW91c2VsZWF2ZSlcbiAgICAgICAgICAgICAgLm9uKCdjbGljaycgICAgICArIGV2ZW50TmFtZXNwYWNlLCBzZWxlY3Rvci5pY29uLCBtb2R1bGUuZXZlbnQuY2xpY2spXG4gICAgICAgICAgICA7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZToge1xuICAgICAgICAgIGV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBtb2R1bGUudmVyYm9zZSgnUmVtb3ZpbmcgZXZlbnRzJyk7XG4gICAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAgIC5vZmYoZXZlbnROYW1lc3BhY2UpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbml0aWFsTG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbml0aWFsTG9hZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnU2V0dGluZyByYXRpbmcgdG8gaW50ZXJhY3RpdmUgbW9kZScpO1xuICAgICAgICAgIG1vZHVsZS5iaW5kLmV2ZW50cygpO1xuICAgICAgICAgICRtb2R1bGVcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhjbGFzc05hbWUuZGlzYWJsZWQpXG4gICAgICAgICAgO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1vZHVsZS5kZWJ1ZygnU2V0dGluZyByYXRpbmcgdG8gcmVhZC1vbmx5IG1vZGUnKTtcbiAgICAgICAgICBtb2R1bGUucmVtb3ZlLmV2ZW50cygpO1xuICAgICAgICAgICRtb2R1bGVcbiAgICAgICAgICAgIC5hZGRDbGFzcyhjbGFzc05hbWUuZGlzYWJsZWQpXG4gICAgICAgICAgO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzOiB7XG4gICAgICAgICAgaW5pdGlhbExvYWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGluaXRpYWxMb2FkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IHtcbiAgICAgICAgICBpbml0aWFsUmF0aW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKCRtb2R1bGUuZGF0YShtZXRhZGF0YS5yYXRpbmcpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgJG1vZHVsZS5yZW1vdmVEYXRhKG1ldGFkYXRhLnJhdGluZyk7XG4gICAgICAgICAgICAgIHJldHVybiAkbW9kdWxlLmRhdGEobWV0YWRhdGEucmF0aW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5pbml0aWFsUmF0aW5nO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbWF4UmF0aW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKCRtb2R1bGUuZGF0YShtZXRhZGF0YS5tYXhSYXRpbmcpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgJG1vZHVsZS5yZW1vdmVEYXRhKG1ldGFkYXRhLm1heFJhdGluZyk7XG4gICAgICAgICAgICAgIHJldHVybiAkbW9kdWxlLmRhdGEobWV0YWRhdGEubWF4UmF0aW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5tYXhSYXRpbmc7XG4gICAgICAgICAgfSxcbiAgICAgICAgICByYXRpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGN1cnJlbnRSYXRpbmcgPSAkaWNvbi5maWx0ZXIoJy4nICsgY2xhc3NOYW1lLmFjdGl2ZSkubGVuZ3RoXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBtb2R1bGUudmVyYm9zZSgnQ3VycmVudCByYXRpbmcgcmV0cmlldmVkJywgY3VycmVudFJhdGluZyk7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFJhdGluZztcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0OiB7XG4gICAgICAgICAgcmF0aW5nOiBmdW5jdGlvbihyYXRpbmcpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICByYXRpbmdJbmRleCA9IChyYXRpbmcgLSAxID49IDApXG4gICAgICAgICAgICAgICAgPyAocmF0aW5nIC0gMSlcbiAgICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICRhY3RpdmVJY29uID0gJGljb24uZXEocmF0aW5nSW5kZXgpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICAkbW9kdWxlXG4gICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyhjbGFzc05hbWUuc2VsZWN0ZWQpXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICAkaWNvblxuICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lLnNlbGVjdGVkKVxuICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lLmFjdGl2ZSlcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmKHJhdGluZyA+IDApIHtcbiAgICAgICAgICAgICAgbW9kdWxlLnZlcmJvc2UoJ1NldHRpbmcgY3VycmVudCByYXRpbmcgdG8nLCByYXRpbmcpO1xuICAgICAgICAgICAgICAkYWN0aXZlSWNvblxuICAgICAgICAgICAgICAgIC5wcmV2QWxsKClcbiAgICAgICAgICAgICAgICAuYWRkQmFjaygpXG4gICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoY2xhc3NOYW1lLmFjdGl2ZSlcbiAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIW1vZHVsZS5pcy5pbml0aWFsTG9hZCgpKSB7XG4gICAgICAgICAgICAgIHNldHRpbmdzLm9uUmF0ZS5jYWxsKGVsZW1lbnQsIHJhdGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbml0aWFsTG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbml0aWFsTG9hZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNldHRpbmc6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgbW9kdWxlLmRlYnVnKCdDaGFuZ2luZyBzZXR0aW5nJywgbmFtZSwgdmFsdWUpO1xuICAgICAgICAgIGlmKCAkLmlzUGxhaW5PYmplY3QobmFtZSkgKSB7XG4gICAgICAgICAgICAkLmV4dGVuZCh0cnVlLCBzZXR0aW5ncywgbmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYoJC5pc1BsYWluT2JqZWN0KHNldHRpbmdzW25hbWVdKSkge1xuICAgICAgICAgICAgICAkLmV4dGVuZCh0cnVlLCBzZXR0aW5nc1tuYW1lXSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHNldHRpbmdzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzW25hbWVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW50ZXJuYWw6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgaWYoICQuaXNQbGFpbk9iamVjdChuYW1lKSApIHtcbiAgICAgICAgICAgICQuZXh0ZW5kKHRydWUsIG1vZHVsZSwgbmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbW9kdWxlW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVtuYW1lXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlYnVnOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZighc2V0dGluZ3Muc2lsZW50ICYmIHNldHRpbmdzLmRlYnVnKSB7XG4gICAgICAgICAgICBpZihzZXR0aW5ncy5wZXJmb3JtYW5jZSkge1xuICAgICAgICAgICAgICBtb2R1bGUucGVyZm9ybWFuY2UubG9nKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgbW9kdWxlLmRlYnVnID0gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuY2FsbChjb25zb2xlLmluZm8sIGNvbnNvbGUsIHNldHRpbmdzLm5hbWUgKyAnOicpO1xuICAgICAgICAgICAgICBtb2R1bGUuZGVidWcuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHZlcmJvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmKCFzZXR0aW5ncy5zaWxlbnQgJiYgc2V0dGluZ3MudmVyYm9zZSAmJiBzZXR0aW5ncy5kZWJ1Zykge1xuICAgICAgICAgICAgaWYoc2V0dGluZ3MucGVyZm9ybWFuY2UpIHtcbiAgICAgICAgICAgICAgbW9kdWxlLnBlcmZvcm1hbmNlLmxvZyhhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIG1vZHVsZS52ZXJib3NlID0gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuY2FsbChjb25zb2xlLmluZm8sIGNvbnNvbGUsIHNldHRpbmdzLm5hbWUgKyAnOicpO1xuICAgICAgICAgICAgICBtb2R1bGUudmVyYm9zZS5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmKCFzZXR0aW5ncy5zaWxlbnQpIHtcbiAgICAgICAgICAgIG1vZHVsZS5lcnJvciA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5lcnJvciwgY29uc29sZSwgc2V0dGluZ3MubmFtZSArICc6Jyk7XG4gICAgICAgICAgICBtb2R1bGUuZXJyb3IuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBlcmZvcm1hbmNlOiB7XG4gICAgICAgICAgbG9nOiBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgY3VycmVudFRpbWUsXG4gICAgICAgICAgICAgIGV4ZWN1dGlvblRpbWUsXG4gICAgICAgICAgICAgIHByZXZpb3VzVGltZVxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgaWYoc2V0dGluZ3MucGVyZm9ybWFuY2UpIHtcbiAgICAgICAgICAgICAgY3VycmVudFRpbWUgICA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICBwcmV2aW91c1RpbWUgID0gdGltZSB8fCBjdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgZXhlY3V0aW9uVGltZSA9IGN1cnJlbnRUaW1lIC0gcHJldmlvdXNUaW1lO1xuICAgICAgICAgICAgICB0aW1lICAgICAgICAgID0gY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgIHBlcmZvcm1hbmNlLnB1c2goe1xuICAgICAgICAgICAgICAgICdOYW1lJyAgICAgICAgICAgOiBtZXNzYWdlWzBdLFxuICAgICAgICAgICAgICAgICdBcmd1bWVudHMnICAgICAgOiBbXS5zbGljZS5jYWxsKG1lc3NhZ2UsIDEpIHx8ICcnLFxuICAgICAgICAgICAgICAgICdFbGVtZW50JyAgICAgICAgOiBlbGVtZW50LFxuICAgICAgICAgICAgICAgICdFeGVjdXRpb24gVGltZScgOiBleGVjdXRpb25UaW1lXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KG1vZHVsZS5wZXJmb3JtYW5jZS50aW1lcik7XG4gICAgICAgICAgICBtb2R1bGUucGVyZm9ybWFuY2UudGltZXIgPSBzZXRUaW1lb3V0KG1vZHVsZS5wZXJmb3JtYW5jZS5kaXNwbGF5LCA1MDApO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZGlzcGxheTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgdGl0bGUgPSBzZXR0aW5ncy5uYW1lICsgJzonLFxuICAgICAgICAgICAgICB0b3RhbFRpbWUgPSAwXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICB0aW1lID0gZmFsc2U7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobW9kdWxlLnBlcmZvcm1hbmNlLnRpbWVyKTtcbiAgICAgICAgICAgICQuZWFjaChwZXJmb3JtYW5jZSwgZnVuY3Rpb24oaW5kZXgsIGRhdGEpIHtcbiAgICAgICAgICAgICAgdG90YWxUaW1lICs9IGRhdGFbJ0V4ZWN1dGlvbiBUaW1lJ107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRpdGxlICs9ICcgJyArIHRvdGFsVGltZSArICdtcyc7XG4gICAgICAgICAgICBpZihtb2R1bGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgICB0aXRsZSArPSAnIFxcJycgKyBtb2R1bGVTZWxlY3RvciArICdcXCcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoJGFsbE1vZHVsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICB0aXRsZSArPSAnICcgKyAnKCcgKyAkYWxsTW9kdWxlcy5sZW5ndGggKyAnKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiggKGNvbnNvbGUuZ3JvdXAgIT09IHVuZGVmaW5lZCB8fCBjb25zb2xlLnRhYmxlICE9PSB1bmRlZmluZWQpICYmIHBlcmZvcm1hbmNlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5ncm91cENvbGxhcHNlZCh0aXRsZSk7XG4gICAgICAgICAgICAgIGlmKGNvbnNvbGUudGFibGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLnRhYmxlKHBlcmZvcm1hbmNlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkLmVhY2gocGVyZm9ybWFuY2UsIGZ1bmN0aW9uKGluZGV4LCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhWydOYW1lJ10gKyAnOiAnICsgZGF0YVsnRXhlY3V0aW9uIFRpbWUnXSsnbXMnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwZXJmb3JtYW5jZSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW52b2tlOiBmdW5jdGlvbihxdWVyeSwgcGFzc2VkQXJndW1lbnRzLCBjb250ZXh0KSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBvYmplY3QgPSBpbnN0YW5jZSxcbiAgICAgICAgICAgIG1heERlcHRoLFxuICAgICAgICAgICAgZm91bmQsXG4gICAgICAgICAgICByZXNwb25zZVxuICAgICAgICAgIDtcbiAgICAgICAgICBwYXNzZWRBcmd1bWVudHMgPSBwYXNzZWRBcmd1bWVudHMgfHwgcXVlcnlBcmd1bWVudHM7XG4gICAgICAgICAgY29udGV4dCAgICAgICAgID0gZWxlbWVudCAgICAgICAgIHx8IGNvbnRleHQ7XG4gICAgICAgICAgaWYodHlwZW9mIHF1ZXJ5ID09ICdzdHJpbmcnICYmIG9iamVjdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBxdWVyeSAgICA9IHF1ZXJ5LnNwbGl0KC9bXFwuIF0vKTtcbiAgICAgICAgICAgIG1heERlcHRoID0gcXVlcnkubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICQuZWFjaChxdWVyeSwgZnVuY3Rpb24oZGVwdGgsIHZhbHVlKSB7XG4gICAgICAgICAgICAgIHZhciBjYW1lbENhc2VWYWx1ZSA9IChkZXB0aCAhPSBtYXhEZXB0aClcbiAgICAgICAgICAgICAgICA/IHZhbHVlICsgcXVlcnlbZGVwdGggKyAxXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5W2RlcHRoICsgMV0uc2xpY2UoMSlcbiAgICAgICAgICAgICAgICA6IHF1ZXJ5XG4gICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgaWYoICQuaXNQbGFpbk9iamVjdCggb2JqZWN0W2NhbWVsQ2FzZVZhbHVlXSApICYmIChkZXB0aCAhPSBtYXhEZXB0aCkgKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0ID0gb2JqZWN0W2NhbWVsQ2FzZVZhbHVlXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIGlmKCBvYmplY3RbY2FtZWxDYXNlVmFsdWVdICE9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICAgICAgZm91bmQgPSBvYmplY3RbY2FtZWxDYXNlVmFsdWVdO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIGlmKCAkLmlzUGxhaW5PYmplY3QoIG9iamVjdFt2YWx1ZV0gKSAmJiAoZGVwdGggIT0gbWF4RGVwdGgpICkge1xuICAgICAgICAgICAgICAgIG9iamVjdCA9IG9iamVjdFt2YWx1ZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZiggb2JqZWN0W3ZhbHVlXSAhPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gb2JqZWN0W3ZhbHVlXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCAkLmlzRnVuY3Rpb24oIGZvdW5kICkgKSB7XG4gICAgICAgICAgICByZXNwb25zZSA9IGZvdW5kLmFwcGx5KGNvbnRleHQsIHBhc3NlZEFyZ3VtZW50cyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYoZm91bmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzcG9uc2UgPSBmb3VuZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYoJC5pc0FycmF5KHJldHVybmVkVmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm5lZFZhbHVlLnB1c2gocmVzcG9uc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmKHJldHVybmVkVmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IFtyZXR1cm5lZFZhbHVlLCByZXNwb25zZV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYocmVzcG9uc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IHJlc3BvbnNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBpZihtZXRob2RJbnZva2VkKSB7XG4gICAgICAgIGlmKGluc3RhbmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBtb2R1bGUuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIG1vZHVsZS5pbnZva2UocXVlcnkpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmKGluc3RhbmNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpbnN0YW5jZS5pbnZva2UoJ2Rlc3Ryb3knKTtcbiAgICAgICAgfVxuICAgICAgICBtb2R1bGUuaW5pdGlhbGl6ZSgpO1xuICAgICAgfVxuICAgIH0pXG4gIDtcblxuICByZXR1cm4gKHJldHVybmVkVmFsdWUgIT09IHVuZGVmaW5lZClcbiAgICA/IHJldHVybmVkVmFsdWVcbiAgICA6IHRoaXNcbiAgO1xufTtcblxuJC5mbi5yYXRpbmcuc2V0dGluZ3MgPSB7XG5cbiAgbmFtZSAgICAgICAgICA6ICdSYXRpbmcnLFxuICBuYW1lc3BhY2UgICAgIDogJ3JhdGluZycsXG5cbiAgc2xlbnQgICAgICAgICA6IGZhbHNlLFxuICBkZWJ1ZyAgICAgICAgIDogZmFsc2UsXG4gIHZlcmJvc2UgICAgICAgOiBmYWxzZSxcbiAgcGVyZm9ybWFuY2UgICA6IHRydWUsXG5cbiAgaW5pdGlhbFJhdGluZyA6IDAsXG4gIGludGVyYWN0aXZlICAgOiB0cnVlLFxuICBtYXhSYXRpbmcgICAgIDogNCxcbiAgY2xlYXJhYmxlICAgICA6ICdhdXRvJyxcblxuICBmaXJlT25Jbml0ICAgIDogZmFsc2UsXG5cbiAgb25SYXRlICAgICAgICA6IGZ1bmN0aW9uKHJhdGluZyl7fSxcblxuICBlcnJvciAgICAgICAgIDoge1xuICAgIG1ldGhvZCAgICA6ICdUaGUgbWV0aG9kIHlvdSBjYWxsZWQgaXMgbm90IGRlZmluZWQnLFxuICAgIG5vTWF4aW11bSA6ICdObyBtYXhpbXVtIHJhdGluZyBzcGVjaWZpZWQuIENhbm5vdCBnZW5lcmF0ZSBIVE1MIGF1dG9tYXRpY2FsbHknXG4gIH0sXG5cblxuICBtZXRhZGF0YToge1xuICAgIHJhdGluZyAgICA6ICdyYXRpbmcnLFxuICAgIG1heFJhdGluZyA6ICdtYXhSYXRpbmcnXG4gIH0sXG5cbiAgY2xhc3NOYW1lIDoge1xuICAgIGFjdGl2ZSAgIDogJ2FjdGl2ZScsXG4gICAgZGlzYWJsZWQgOiAnZGlzYWJsZWQnLFxuICAgIHNlbGVjdGVkIDogJ3NlbGVjdGVkJyxcbiAgICBsb2FkaW5nICA6ICdsb2FkaW5nJ1xuICB9LFxuXG4gIHNlbGVjdG9yICA6IHtcbiAgICBpY29uIDogJy5pY29uJ1xuICB9LFxuXG4gIHRlbXBsYXRlczoge1xuICAgIGljb246IGZ1bmN0aW9uKG1heFJhdGluZykge1xuICAgICAgdmFyXG4gICAgICAgIGljb24gPSAxLFxuICAgICAgICBodG1sID0gJydcbiAgICAgIDtcbiAgICAgIHdoaWxlKGljb24gPD0gbWF4UmF0aW5nKSB7XG4gICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwiaWNvblwiPjwvaT4nO1xuICAgICAgICBpY29uKys7XG4gICAgICB9XG4gICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gIH1cblxufTtcblxufSkoIGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCApO1xuIl19
