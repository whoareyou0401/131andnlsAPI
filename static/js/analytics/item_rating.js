function fillData(){var t=$(".date .date-choiced").attr("value"),e=$(".select-page").val()||1,a=$("th .ascending").parent().attr("value")||$("th .descending").parent().attr("value"),i=$(".ascending").attr("class")||$(".descending").attr("class");values.category="all",$("select.t4").each(function(){"all"!==$(this).val()&&(values.category=Number($(this).val()))}),$.ajax({url:"/analytics/chain-store",data:{action:"itemrating-item",term_range:t,page:e,arg:window.btoa(JSON.stringify(values)),sort:a,order:i},type:"GET",success:function(t){if(1==t.success){$(".pagination p span").text(t.data.pages),$(".select-page option").remove();for(var a=1;a<=t.data.pages;a++)$(".select-page").append("<option value="+a+">第"+num2Chinese(a)+"页</option>");$(".select-page").val(e);var i="<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";$("table tbody tr").remove();for(var n=0;n<t.data.data.length;n++){$("table tbody").append(i),ii=n+1,$("table tr:eq("+ii+")").attr("value",t.data.data[n].id),$("table tr:eq("+ii+") td:eq(0)").text(ii);for(var l in t.data.data[n])index=$("table thead th[value='"+l+"']").index(),index!==-1&&$("table tr:eq("+ii+") td:eq("+index+")").text(t.data.data[n][l])}$(".table-wrap input:checkbox:not(:checked)").each(function(){hideTableCol($("table"),$(this).attr("value"))}),$(".table-wrap input:checkbox:checked").each(function(){showTableCol($("table"),$(this).attr("value"))}),$(".module-wrap .line-right .block div").each(function(){t.data.values[$(this).attr("name")]?$(this).height(134*t.data.values[$(this).attr("name")]):$(this).height(0)}),$(".module-wrap .line-right .text p").each(function(){t.data.values[$(this).attr("name")]?($(this).height(134*t.data.values[$(this).attr("name")]),$(this).css("line-height",String(134*t.data.values[$(this).attr("name")])+"px"),$(this).children("span").text((100*t.data.values[$(this).attr("name")]).toFixed(2))):($(this).height(0),$(this).css("line-height",String("0px")),$(this).children("span").text((0).toFixed(0)))})}else location.href="/logout"}})}var values={},categories={};$(document).ready(function(){$.ajax({url:"/analytics/chain-store",data:{action:"itemrating-init",arg:"rank-item-rank"},type:"GET",success:function(t){if(1==t.success){categories=t.data;for(var e={},a=0;a<categories.length;a++)e[categories[a].level0_id]=categories[a];for(var i in e)$("select[level='0']").append("<option value='"+i+"'>"+e[i].level0_name+"</option>");fillData()}}}),$("a[value='itemrating']").addClass("sidebar-color"),$(".show .show-line div[name]").each(function(){values[$(this).attr("name")]=Number($(this).text().split("%")[0])/100}),$("select.t4").change(function(){if("all"!==$(this).val()&&Number(2!=$(this).attr("level"))){for(var t=Number($(this).attr("level")),e=Number($(this).attr("level"))+1,a=Number($(this).val()),i=e;i<=2;i++)$("select[level='"+i+"'] option:not([value='all'])").remove();for(var n={},l=0;l<categories.length;l++)categories[l]["level"+t+"_id"]==a&&(n[categories[l]["level"+e+"_id"]]=categories[l]);for(var d in n)$("select[level='"+e+"']").append("<option value='"+d+"'>"+n[d]["level"+e+"_name"]+"</option>")}else if("all"===$(this).val())for(e=Number($(this).attr("level"))+1,i=e;i<=2;i++)$("select[level='"+i+"'] option:not([value='all'])").remove();fillData(),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"category-select"})}),$(".date li").click(function(){$(this).siblings(".date-choiced").removeClass(),$(this).addClass("date-choiced"),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"date"})}),$(".add-image:eq(0)").click(function(){"hidden"==$(".explain-box").attr("hidden")?$(".explain-box").removeAttr("hidden"):$(".explain-box").attr("hidden","hidden")}),$(".add-image:eq(1)").click(function(){"hidden"==$(".add-items").attr("hidden")?$(".add-items").removeAttr("hidden"):$(".add-items").attr("hidden","hidden")}),$(".popup-box .choice-button input.btn-color").click(function(){$(this).parents(".popup-box").find(".show .show-line div[name]").each(function(){values[$(this).attr("name")]=Number($(this).text().split("%")[0])/100;var t=Number($(this).text().split("%")[0]);$(this).parents(".module-wrap").find(".line .line-left .text p[name='"+$(this).attr("name")+"'] span").text(t),$(this).parents(".module-wrap").find(".line .line-left .block div[name='"+$(this).attr("name")+"']").height(134*t/100),$(this).parents(".item-module-wrap").find(".line .line-left p[name='"+$(this).attr("name")+"']").css("line-height",String(134*t/100)+"px"),$(this).parents(".item-module-wrap").find(".line .line-left p[name='"+$(this).attr("name")+"']").height(134*t/100)}),$(this).parents(".popup-box").attr("hidden","hidden"),fillData(),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"ratechanged"})}),$(".choice-button input[name='cancel']").click(function(){$(this).parents(".popup-box").find(":text").each(function(){$(this).val(values[$(this).attr("name")])}),$(this).parents(".popup-box").attr("hidden","hidden")}),$(".setting.t4").click(function(){"hidden"==$(this).parent().siblings(".popup-box").attr("hidden")?$(this).parent().siblings(".popup-box").removeAttr("hidden"):$(this).parent().siblings(".popup-box").attr("hidden","hidden");$(this).parents(".popup-box").find(":text").each(function(){$(this).val(values[$(this).attr("name")])})}),$(".popup-box input:first-child, .item-rating-button .float-right>input:first-child, .explain-box .float-right>input").click(function(){$(".add-items").attr("hidden","hidden")}),$(".popup-box input:nth-child(2)").click(function(){$(".add-items").attr("hidden","hidden"),$("input:checkbox:not(:checked)").each(function(){hideTableCol($("table"),$(this).attr("value"))}),$("input:checkbox:checked").each(function(){showTableCol($("table"),$(this).attr("value"))})}),$(".item-rating-button .float-right>input:nth-of-type(2)").click(function(){$(".add-items").attr("hidden","hidden"),$("input:checkbox:not(:checked)").each(function(){hideTableCol($("table"),$(this).attr("value"))}),$("input:checkbox:checked").each(function(){showTableCol($("table"),$(this).attr("value"))}),setTbaleWidth()}),$(".select-page").change(function(){fillData(),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"page-select"})}),$(".page-turing.prev").click(function(){1!=$(".select-page").val()&&($(".select-page").val($(".select-page").val()-1),fillData(),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"page-turing"}))}),$(".page-turing.next").click(function(){$(".select-page").val()!=$(".select-page option").length&&($(".select-page").val(Number($(".select-page").val())+1),fillData(),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"page-turing"}))}),$("table").tablesort({func:function(){fillData()}}),$(".download").click(function(){$("table").tableExport({headings:!0,fileName:"items",formats:["csv"],position:"bottom",ignoreCSS:"[style*='display: none']"}),ga("send",{hitType:"event",eventCategory:"itemrating",eventAction:"download"})}),tableScrollFun()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuYWx5dGljcy9pdGVtX3JhdGluZy5qcyJdLCJuYW1lcyI6WyJmaWxsRGF0YSIsInRlcm1SYW5nZSIsIiQiLCJhdHRyIiwicGFnZSIsInZhbCIsInNvcnQiLCJwYXJlbnQiLCJvcmRlciIsInZhbHVlcyIsImNhdGVnb3J5IiwiZWFjaCIsInRoaXMiLCJOdW1iZXIiLCJhamF4IiwidXJsIiwiZGF0YSIsImFjdGlvbiIsInRlcm1fcmFuZ2UiLCJhcmciLCJ3aW5kb3ciLCJidG9hIiwiSlNPTiIsInN0cmluZ2lmeSIsInR5cGUiLCJzdWNjZXNzIiwidGV4dCIsInBhZ2VzIiwicmVtb3ZlIiwiaiIsImFwcGVuZCIsIm51bTJDaGluZXNlIiwibmV3Um93IiwiaSIsImxlbmd0aCIsImlpIiwiaWQiLCJrZXkiLCJpbmRleCIsImhpZGVUYWJsZUNvbCIsInNob3dUYWJsZUNvbCIsImhlaWdodCIsImNzcyIsIlN0cmluZyIsImNoaWxkcmVuIiwidG9GaXhlZCIsImxvY2F0aW9uIiwiaHJlZiIsImNhdGVnb3JpZXMiLCJkb2N1bWVudCIsInJlYWR5IiwidGVtcCIsImxldmVsMF9pZCIsImxldmVsMF9uYW1lIiwiYWRkQ2xhc3MiLCJzcGxpdCIsImNoYW5nZSIsInNlbGVjdGVkTGV2ZWwiLCJjdXJyZW50TGV2ZWwiLCJzZWxlY3RlZENhdCIsImdhIiwiaGl0VHlwZSIsImV2ZW50Q2F0ZWdvcnkiLCJldmVudEFjdGlvbiIsImNsaWNrIiwic2libGluZ3MiLCJyZW1vdmVDbGFzcyIsInJlbW92ZUF0dHIiLCJwYXJlbnRzIiwiZmluZCIsInNldFRiYWxlV2lkdGgiLCJ0YWJsZXNvcnQiLCJmdW5jIiwidGFibGVFeHBvcnQiLCJoZWFkaW5ncyIsImZpbGVOYW1lIiwiZm9ybWF0cyIsInBvc2l0aW9uIiwiaWdub3JlQ1NTIiwidGFibGVTY3JvbGxGdW4iXSwibWFwcGluZ3MiOiJBQUVBLFFBQVNBLFlBQ0wsR0FBSUMsR0FBWUMsRUFBRSx1QkFBdUJDLEtBQUssU0FDMUNDLEVB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U0FBU3VFLGFBQ1BDLFVBQVUsRUFDVkMsU0FBVSxRQUNWQyxTQUFVLE9BQ1ZDLFNBQVUsU0FDVkMsVUFBVyw2QkFFZmxCLEdBQUcsUUFDQ0MsUUFBUyxRQUNUQyxjQUFlLGFBQ2ZDLFlBQWEsZUFHckJnQiIsImZpbGUiOiJhbmFseXRpY3MvaXRlbV9yYXRpbmcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdmFsdWVzID0ge307XG52YXIgY2F0ZWdvcmllcyA9IHt9O1xuZnVuY3Rpb24gZmlsbERhdGEoKXtcbiAgICB2YXIgdGVybVJhbmdlID0gJChcIi5kYXRlIC5kYXRlLWNob2ljZWRcIikuYXR0cihcInZhbHVlXCIpO1xuICAgIHZhciBwYWdlID0gJChcIi5zZWxlY3QtcGFnZVwiKS52YWwoKSB8fCAxO1xuICAgIHZhciBzb3J0ID0gJChcInRoIC5hc2NlbmRpbmdcIikucGFyZW50KCkuYXR0cihcInZhbHVlXCIpIHx8ICQoXCJ0aCAuZGVzY2VuZGluZ1wiKS5wYXJlbnQoKS5hdHRyKFwidmFsdWVcIik7XG4gICAgdmFyIG9yZGVyID0gJChcIi5hc2NlbmRpbmdcIikuYXR0cihcImNsYXNzXCIpIHx8ICQoXCIuZGVzY2VuZGluZ1wiKS5hdHRyKFwiY2xhc3NcIik7XG4gICAgdmFsdWVzLmNhdGVnb3J5ID0gXCJhbGxcIjtcbiAgICAkKFwic2VsZWN0LnQ0XCIpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKCQodGhpcykudmFsKCkgIT09IFwiYWxsXCIpe1xuICAgICAgICAgICAgdmFsdWVzLmNhdGVnb3J5ID0gTnVtYmVyKCQodGhpcykudmFsKCkpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgJC5hamF4KHtcbiAgICAgICAgdXJsOiBcIi9hbmFseXRpY3MvY2hhaW4tc3RvcmVcIixcbiAgICAgICAgZGF0YToge1wiYWN0aW9uXCI6IFwiaXRlbXJhdGluZy1pdGVtXCIsIFwidGVybV9yYW5nZVwiOiB0ZXJtUmFuZ2UsIFwicGFnZVwiOiBwYWdlLCBcImFyZ1wiOiB3aW5kb3cuYnRvYShKU09OLnN0cmluZ2lmeSh2YWx1ZXMpKSwgXCJzb3J0XCI6IHNvcnQsIFwib3JkZXJcIjogb3JkZXJ9LFxuICAgICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzID09IDEpIHtcbiAgICAgICAgICAgICAgICAkKFwiLnBhZ2luYXRpb24gcCBzcGFuXCIpLnRleHQoZGF0YS5kYXRhLnBhZ2VzKTtcbiAgICAgICAgICAgICAgICAkKFwiLnNlbGVjdC1wYWdlIG9wdGlvblwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8PSBkYXRhLmRhdGEucGFnZXM7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgICQoXCIuc2VsZWN0LXBhZ2VcIikuYXBwZW5kKFwiPG9wdGlvbiB2YWx1ZT1cIitqK1wiPuesrFwiICsgbnVtMkNoaW5lc2UoaikgKyBcIumhtTwvb3B0aW9uPlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJChcIi5zZWxlY3QtcGFnZVwiKS52YWwocGFnZSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1JvdyA9IFwiPHRyPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjwvdHI+XCI7XG4gICAgICAgICAgICAgICAgJChcInRhYmxlIHRib2R5IHRyXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5kYXRhLmRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgJChcInRhYmxlIHRib2R5XCIpLmFwcGVuZChuZXdSb3cpO1xuICAgICAgICAgICAgICAgICAgICBpaSA9IGkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAkKFwidGFibGUgdHI6ZXEoXCIgKyBpaSArIFwiKVwiKS5hdHRyKFwidmFsdWVcIiwgZGF0YS5kYXRhLmRhdGFbaV0uaWQpO1xuICAgICAgICAgICAgICAgICAgICAkKFwidGFibGUgdHI6ZXEoXCIgKyBpaSArIFwiKSB0ZDplcSgwKVwiKS50ZXh0KGlpKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEuZGF0YS5kYXRhW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9ICQoXCJ0YWJsZSB0aGVhZCB0aFt2YWx1ZT0nXCIgKyBrZXkgK1wiJ11cIikuaW5kZXgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCJ0YWJsZSB0cjplcShcIiArIGlpICsgXCIpIHRkOmVxKFwiICsgaW5kZXggKyBcIilcIikudGV4dChkYXRhLmRhdGEuZGF0YVtpXVtrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkKFwiLnRhYmxlLXdyYXAgaW5wdXQ6Y2hlY2tib3g6bm90KDpjaGVja2VkKVwiKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGhpZGVUYWJsZUNvbCgkKFwidGFibGVcIiksICQodGhpcykuYXR0cihcInZhbHVlXCIpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKFwiLnRhYmxlLXdyYXAgaW5wdXQ6Y2hlY2tib3g6Y2hlY2tlZFwiKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHNob3dUYWJsZUNvbCgkKFwidGFibGVcIiksICQodGhpcykuYXR0cihcInZhbHVlXCIpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKFwiLm1vZHVsZS13cmFwIC5saW5lLXJpZ2h0IC5ibG9jayBkaXZcIikuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLnZhbHVlc1skKHRoaXMpLmF0dHIoXCJuYW1lXCIpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5oZWlnaHQoMTM0ICogZGF0YS5kYXRhLnZhbHVlc1skKHRoaXMpLmF0dHIoXCJuYW1lXCIpXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmhlaWdodCgwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICQoXCIubW9kdWxlLXdyYXAgLmxpbmUtcmlnaHQgLnRleHQgcFwiKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEudmFsdWVzWyQodGhpcykuYXR0cihcIm5hbWVcIildKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmhlaWdodCgxMzQgKiBkYXRhLmRhdGEudmFsdWVzWyQodGhpcykuYXR0cihcIm5hbWVcIildKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY3NzKFwibGluZS1oZWlnaHRcIiwgU3RyaW5nKDEzNCAqIGRhdGEuZGF0YS52YWx1ZXNbJCh0aGlzKS5hdHRyKFwibmFtZVwiKV0pICsgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oXCJzcGFuXCIpLnRleHQoKGRhdGEuZGF0YS52YWx1ZXNbJCh0aGlzKS5hdHRyKFwibmFtZVwiKV0gKiAxMDApLnRvRml4ZWQoMikpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5oZWlnaHQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcyhcImxpbmUtaGVpZ2h0XCIsIFN0cmluZyhcIjBweFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKFwic3BhblwiKS50ZXh0KCgwKS50b0ZpeGVkKDApKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIvbG9nb3V0XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXG4gICAgJC5hamF4KHtcbiAgICAgICAgdXJsOiBcIi9hbmFseXRpY3MvY2hhaW4tc3RvcmVcIixcbiAgICAgICAgZGF0YToge1wiYWN0aW9uXCI6IFwiaXRlbXJhdGluZy1pbml0XCIsIFwiYXJnXCI6IFwicmFuay1pdGVtLXJhbmtcIn0sXG4gICAgICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzID09IDEpIHtcbiAgICAgICAgICAgICAgICBjYXRlZ29yaWVzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0ge307XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpbmRleD0wOyBpbmRleCA8IGNhdGVnb3JpZXMubGVuZ3RoOyBpbmRleCsrKXtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFtjYXRlZ29yaWVzW2luZGV4XS5sZXZlbDBfaWRdID0gY2F0ZWdvcmllc1tpbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcih2YXIga2V5IGluIHRlbXApe1xuICAgICAgICAgICAgICAgICAgICAkKFwic2VsZWN0W2xldmVsPScwJ11cIikuYXBwZW5kKFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyBrZXkgKyBcIic+XCIgKyB0ZW1wW2tleV0ubGV2ZWwwX25hbWUgKyBcIjwvb3B0aW9uPlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmlsbERhdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChcImFbdmFsdWU9J2l0ZW1yYXRpbmcnXVwiKS5hZGRDbGFzcyhcInNpZGViYXItY29sb3JcIik7XG5cbiAgICAkKFwiLnNob3cgLnNob3ctbGluZSBkaXZbbmFtZV1cIikuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICB2YWx1ZXNbJCh0aGlzKS5hdHRyKFwibmFtZVwiKV0gPSBOdW1iZXIoJCh0aGlzKS50ZXh0KCkuc3BsaXQoJyUnKVswXSkgLyAxMDA7XG4gICAgfSk7XG5cbiAgICAkKFwic2VsZWN0LnQ0XCIpLmNoYW5nZShmdW5jdGlvbigpe1xuICAgICAgICBpZigkKHRoaXMpLnZhbCgpICE9PSBcImFsbFwiICYmIE51bWJlcigkKHRoaXMpLmF0dHIoXCJsZXZlbFwiKSAhPSAyKSl7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRMZXZlbCA9IE51bWJlcigkKHRoaXMpLmF0dHIoXCJsZXZlbFwiKSk7XG4gICAgICAgICAgICB2YXIgY3VycmVudExldmVsID0gTnVtYmVyKCQodGhpcykuYXR0cihcImxldmVsXCIpKSArIDE7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDYXQgPSBOdW1iZXIoJCh0aGlzKS52YWwoKSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY3VycmVudExldmVsOyBpIDw9IDI7IGkrKyl7XG4gICAgICAgICAgICAgICAgJChcInNlbGVjdFtsZXZlbD0nXCIgKyBpICsgXCInXSBvcHRpb246bm90KFt2YWx1ZT0nYWxsJ10pXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRlbXAgPSB7fTtcbiAgICAgICAgICAgIGZvcih2YXIgaW5kZXg9MDsgaW5kZXggPCBjYXRlZ29yaWVzLmxlbmd0aDsgaW5kZXgrKyl7XG4gICAgICAgICAgICAgICAgaWYgKGNhdGVnb3JpZXNbaW5kZXhdW1wibGV2ZWxcIiArIHNlbGVjdGVkTGV2ZWwgKyBcIl9pZFwiXSA9PSBzZWxlY3RlZENhdCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wW2NhdGVnb3JpZXNbaW5kZXhdW1wibGV2ZWxcIiArIGN1cnJlbnRMZXZlbCArIFwiX2lkXCJdXSA9IGNhdGVnb3JpZXNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluIHRlbXApe1xuICAgICAgICAgICAgICAgICQoXCJzZWxlY3RbbGV2ZWw9J1wiICsgY3VycmVudExldmVsICsgXCInXVwiKS5hcHBlbmQoXCI8b3B0aW9uIHZhbHVlPSdcIiArIGtleSArIFwiJz5cIiArIHRlbXBba2V5XVtcImxldmVsXCIgKyBjdXJyZW50TGV2ZWwgKyBcIl9uYW1lXCJdICsgXCI8L29wdGlvbj5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS52YWwoKSA9PT0gXCJhbGxcIil7XG4gICAgICAgICAgICBjdXJyZW50TGV2ZWwgPSBOdW1iZXIoJCh0aGlzKS5hdHRyKFwibGV2ZWxcIikpICsgMTtcbiAgICAgICAgICAgIGZvciAoaSA9IGN1cnJlbnRMZXZlbDsgaSA8PSAyOyBpKyspe1xuICAgICAgICAgICAgICAgICQoXCJzZWxlY3RbbGV2ZWw9J1wiICsgaSArIFwiJ10gb3B0aW9uOm5vdChbdmFsdWU9J2FsbCddKVwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmaWxsRGF0YSgpO1xuICAgICAgICBnYSgnc2VuZCcsIHtcbiAgICAgICAgICAgIGhpdFR5cGU6ICdldmVudCcsXG4gICAgICAgICAgICBldmVudENhdGVnb3J5OiAnaXRlbXJhdGluZycsXG4gICAgICAgICAgICBldmVudEFjdGlvbjogJ2NhdGVnb3J5LXNlbGVjdCcsXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgJChcIi5kYXRlIGxpXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5zaWJsaW5ncyhcIi5kYXRlLWNob2ljZWRcIikucmVtb3ZlQ2xhc3MoKTtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImRhdGUtY2hvaWNlZFwiKTtcbiAgICAgICAgZ2EoJ3NlbmQnLCB7XG4gICAgICAgICAgICBoaXRUeXBlOiAnZXZlbnQnLFxuICAgICAgICAgICAgZXZlbnRDYXRlZ29yeTogJ2l0ZW1yYXRpbmcnLFxuICAgICAgICAgICAgZXZlbnRBY3Rpb246ICdkYXRlJyxcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAkKFwiLmFkZC1pbWFnZTplcSgwKVwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICB2YXIgb3AgPSAkKFwiLmV4cGxhaW4tYm94XCIpLmF0dHIoXCJoaWRkZW5cIikgPT0gXCJoaWRkZW5cIiA/ICQoXCIuZXhwbGFpbi1ib3hcIikucmVtb3ZlQXR0cihcImhpZGRlblwiKSA6ICQoXCIuZXhwbGFpbi1ib3hcIikuYXR0cihcImhpZGRlblwiLCBcImhpZGRlblwiKTtcbiAgICB9KTtcbiAgICAkKFwiLmFkZC1pbWFnZTplcSgxKVwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICB2YXIgb3AgPSAkKFwiLmFkZC1pdGVtc1wiKS5hdHRyKFwiaGlkZGVuXCIpID09IFwiaGlkZGVuXCIgPyAkKFwiLmFkZC1pdGVtc1wiKS5yZW1vdmVBdHRyKFwiaGlkZGVuXCIpIDogJChcIi5hZGQtaXRlbXNcIikuYXR0cihcImhpZGRlblwiLCBcImhpZGRlblwiKTtcbiAgICB9KTtcblxuICAgICQoXCIucG9wdXAtYm94IC5jaG9pY2UtYnV0dG9uIGlucHV0LmJ0bi1jb2xvclwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoXCIucG9wdXAtYm94XCIpLmZpbmQoXCIuc2hvdyAuc2hvdy1saW5lIGRpdltuYW1lXVwiKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YWx1ZXNbJCh0aGlzKS5hdHRyKFwibmFtZVwiKV0gPSBOdW1iZXIoJCh0aGlzKS50ZXh0KCkuc3BsaXQoJyUnKVswXSkgLyAxMDA7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gTnVtYmVyKCQodGhpcykudGV4dCgpLnNwbGl0KCclJylbMF0pO1xuXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoXCIubW9kdWxlLXdyYXBcIikuZmluZChcIi5saW5lIC5saW5lLWxlZnQgLnRleHQgcFtuYW1lPSdcIisgJCh0aGlzKS5hdHRyKFwibmFtZVwiKSArXCInXSBzcGFuXCIpLnRleHQoaGVpZ2h0KTtcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cyhcIi5tb2R1bGUtd3JhcFwiKS5maW5kKFwiLmxpbmUgLmxpbmUtbGVmdCAuYmxvY2sgZGl2W25hbWU9J1wiKyAkKHRoaXMpLmF0dHIoXCJuYW1lXCIpICtcIiddXCIpLmhlaWdodCgxMzQgKiBoZWlnaHQgLyAxMDApO1xuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKFwiLml0ZW0tbW9kdWxlLXdyYXBcIikuZmluZChcIi5saW5lIC5saW5lLWxlZnQgcFtuYW1lPSdcIisgJCh0aGlzKS5hdHRyKFwibmFtZVwiKSArXCInXVwiKS5jc3MoXCJsaW5lLWhlaWdodFwiLCBTdHJpbmcoMTM0ICogaGVpZ2h0IC8gMTAwKSArIFwicHhcIik7XG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoXCIuaXRlbS1tb2R1bGUtd3JhcFwiKS5maW5kKFwiLmxpbmUgLmxpbmUtbGVmdCBwW25hbWU9J1wiKyAkKHRoaXMpLmF0dHIoXCJuYW1lXCIpICtcIiddXCIpLmhlaWdodCgxMzQgKiBoZWlnaHQgLyAxMDApO1xuICAgICAgICB9KTtcbiAgICAgICAgJCh0aGlzKS5wYXJlbnRzKFwiLnBvcHVwLWJveFwiKS5hdHRyKFwiaGlkZGVuXCIsIFwiaGlkZGVuXCIpO1xuICAgICAgICBmaWxsRGF0YSgpO1xuICAgICAgICBnYSgnc2VuZCcsIHtcbiAgICAgICAgICAgIGhpdFR5cGU6ICdldmVudCcsXG4gICAgICAgICAgICBldmVudENhdGVnb3J5OiAnaXRlbXJhdGluZycsXG4gICAgICAgICAgICBldmVudEFjdGlvbjogJ3JhdGVjaGFuZ2VkJyxcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAkKFwiLmNob2ljZS1idXR0b24gaW5wdXRbbmFtZT0nY2FuY2VsJ11cIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgJCh0aGlzKS5wYXJlbnRzKFwiLnBvcHVwLWJveFwiKS5maW5kKFwiOnRleHRcIikuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICQodGhpcykudmFsKHZhbHVlc1skKHRoaXMpLmF0dHIoXCJuYW1lXCIpXSk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoXCIucG9wdXAtYm94XCIpLmF0dHIoXCJoaWRkZW5cIiwgXCJoaWRkZW5cIik7XG4gICAgfSk7XG5cbiAgICAkKFwiLnNldHRpbmcudDRcIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG9wID0gJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncyhcIi5wb3B1cC1ib3hcIikuYXR0cihcImhpZGRlblwiKSA9PSBcImhpZGRlblwiID8gJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncyhcIi5wb3B1cC1ib3hcIikucmVtb3ZlQXR0cihcImhpZGRlblwiKSA6ICQodGhpcykucGFyZW50KCkuc2libGluZ3MoXCIucG9wdXAtYm94XCIpLmF0dHIoXCJoaWRkZW5cIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICQodGhpcykucGFyZW50cyhcIi5wb3B1cC1ib3hcIikuZmluZChcIjp0ZXh0XCIpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAkKHRoaXMpLnZhbCh2YWx1ZXNbJCh0aGlzKS5hdHRyKFwibmFtZVwiKV0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgICQoXCIucG9wdXAtYm94IGlucHV0OmZpcnN0LWNoaWxkLCAuaXRlbS1yYXRpbmctYnV0dG9uIC5mbG9hdC1yaWdodD5pbnB1dDpmaXJzdC1jaGlsZCwgLmV4cGxhaW4tYm94IC5mbG9hdC1yaWdodD5pbnB1dFwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKFwiLmFkZC1pdGVtc1wiKS5hdHRyKFwiaGlkZGVuXCIsIFwiaGlkZGVuXCIpO1xuICAgIH0pO1xuICAgICQoXCIucG9wdXAtYm94IGlucHV0Om50aC1jaGlsZCgyKVwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKFwiLmFkZC1pdGVtc1wiKS5hdHRyKFwiaGlkZGVuXCIsIFwiaGlkZGVuXCIpO1xuXG4gICAgICAgICQoJ2lucHV0OmNoZWNrYm94Om5vdCg6Y2hlY2tlZCknKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBoaWRlVGFibGVDb2woJChcInRhYmxlXCIpLCAkKHRoaXMpLmF0dHIoXCJ2YWx1ZVwiKSk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKCdpbnB1dDpjaGVja2JveDpjaGVja2VkJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2hvd1RhYmxlQ29sKCQoXCJ0YWJsZVwiKSwgJCh0aGlzKS5hdHRyKFwidmFsdWVcIikpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICAkKFwiLml0ZW0tcmF0aW5nLWJ1dHRvbiAuZmxvYXQtcmlnaHQ+aW5wdXQ6bnRoLW9mLXR5cGUoMilcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoXCIuYWRkLWl0ZW1zXCIpLmF0dHIoXCJoaWRkZW5cIiwgXCJoaWRkZW5cIik7XG5cbiAgICAgICAgJCgnaW5wdXQ6Y2hlY2tib3g6bm90KDpjaGVja2VkKScpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGhpZGVUYWJsZUNvbCgkKFwidGFibGVcIiksICQodGhpcykuYXR0cihcInZhbHVlXCIpKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJ2lucHV0OmNoZWNrYm94OmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzaG93VGFibGVDb2woJChcInRhYmxlXCIpLCAkKHRoaXMpLmF0dHIoXCJ2YWx1ZVwiKSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRUYmFsZVdpZHRoKCk7XG4gICAgfSk7XG5cbiAgICAkKFwiLnNlbGVjdC1wYWdlXCIpLmNoYW5nZShmdW5jdGlvbigpe1xuICAgICAgICBmaWxsRGF0YSgpO1xuICAgICAgICBnYSgnc2VuZCcsIHtcbiAgICAgICAgICAgIGhpdFR5cGU6ICdldmVudCcsXG4gICAgICAgICAgICBldmVudENhdGVnb3J5OiAnaXRlbXJhdGluZycsXG4gICAgICAgICAgICBldmVudEFjdGlvbjogJ3BhZ2Utc2VsZWN0JyxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgJChcIi5wYWdlLXR1cmluZy5wcmV2XCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmICgkKFwiLnNlbGVjdC1wYWdlXCIpLnZhbCgpID09IDEpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICQoXCIuc2VsZWN0LXBhZ2VcIikudmFsKCQoXCIuc2VsZWN0LXBhZ2VcIikudmFsKCkgLSAxKTtcbiAgICAgICAgZmlsbERhdGEoKTtcbiAgICAgICAgZ2EoJ3NlbmQnLCB7XG4gICAgICAgICAgICBoaXRUeXBlOiAnZXZlbnQnLFxuICAgICAgICAgICAgZXZlbnRDYXRlZ29yeTogJ2l0ZW1yYXRpbmcnLFxuICAgICAgICAgICAgZXZlbnRBY3Rpb246ICdwYWdlLXR1cmluZycsXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgICQoXCIucGFnZS10dXJpbmcubmV4dFwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBpZiAoJChcIi5zZWxlY3QtcGFnZVwiKS52YWwoKSA9PSAkKFwiLnNlbGVjdC1wYWdlIG9wdGlvblwiKS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAkKFwiLnNlbGVjdC1wYWdlXCIpLnZhbChOdW1iZXIoJChcIi5zZWxlY3QtcGFnZVwiKS52YWwoKSkgKyAxKTtcbiAgICAgICAgZmlsbERhdGEoKTtcbiAgICAgICAgZ2EoJ3NlbmQnLCB7XG4gICAgICAgICAgICBoaXRUeXBlOiAnZXZlbnQnLFxuICAgICAgICAgICAgZXZlbnRDYXRlZ29yeTogJ2l0ZW1yYXRpbmcnLFxuICAgICAgICAgICAgZXZlbnRBY3Rpb246ICdwYWdlLXR1cmluZycsXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgICQoXCJ0YWJsZVwiKS50YWJsZXNvcnQoe2Z1bmM6IGZ1bmN0aW9uKCl7ZmlsbERhdGEoKTt9fSk7XG4gICAgJChcIi5kb3dubG9hZFwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAkKFwidGFibGVcIikudGFibGVFeHBvcnQoe1xuICAgICAgICAgICAgaGVhZGluZ3M6IHRydWUsXG4gICAgICAgICAgICBmaWxlTmFtZTogXCJpdGVtc1wiLFxuICAgICAgICAgICAgZm9ybWF0czogW1wiY3N2XCJdLFxuICAgICAgICAgICAgcG9zaXRpb246IFwiYm90dG9tXCIsXG4gICAgICAgICAgICBpZ25vcmVDU1M6IFwiW3N0eWxlKj0nZGlzcGxheTogbm9uZSddXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGdhKCdzZW5kJywge1xuICAgICAgICAgICAgaGl0VHlwZTogJ2V2ZW50JyxcbiAgICAgICAgICAgIGV2ZW50Q2F0ZWdvcnk6ICdpdGVtcmF0aW5nJyxcbiAgICAgICAgICAgIGV2ZW50QWN0aW9uOiAnZG93bmxvYWQnLFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB0YWJsZVNjcm9sbEZ1bigpO1xufSk7XG4iXX0=
