!function(e){"use strict";var t=function(t,s){this.options=s,this.$element=e(t),this.$container=e("<div/>",{"class":" ms-container glyphicon glyphicon-resize-horizontal"}),this.$selectableContainer=e("<div/>",{"class":"ms-selectable"}),this.$selectionContainer=e("<div/>",{"class":"ms-selection"}),this.$selectableUl=e("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.$selectionUl=e("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.scrollTo=0,this.elemsSelector="li:visible:not(.ms-optgroup-label,.ms-optgroup-container,."+s.disabledClass+")"};t.prototype={constructor:t,init:function(){var t=this,s=this.$element;if(0===s.next(".ms-container").length){s.css({position:"absolute",left:"-9999px"}),s.attr("id",s.attr("id")?s.attr("id"):Math.ceil(1e3*Math.random())+"multiselect"),this.$container.attr("id","ms-"+s.attr("id")),this.$container.addClass(t.options.cssClass),s.find("option").each(function(){t.generateLisFromOption(this)}),this.$selectionUl.find(".ms-optgroup-label").hide(),t.options.selectableHeader&&t.$selectableContainer.append(t.options.selectableHeader),t.$selectableContainer.append(t.$selectableUl),t.options.selectableFooter&&t.$selectableContainer.append(t.options.selectableFooter),t.options.selectionHeader&&t.$selectionContainer.append(t.options.selectionHeader),t.$selectionContainer.append(t.$selectionUl),t.options.selectionFooter&&t.$selectionContainer.append(t.options.selectionFooter),t.$container.append(t.$selectableContainer),t.$container.append(t.$selectionContainer),s.after(t.$container),t.activeMouse(t.$selectableUl),t.activeKeyboard(t.$selectableUl);var l=t.options.dblClick?"dblclick":"click";t.$selectableUl.on(l,".ms-elem-selectable",function(){t.select(e(this).data("ms-value"))}),t.$selectionUl.on(l,".ms-elem-selection",function(){t.deselect(e(this).data("ms-value"))}),t.activeMouse(t.$selectionUl),t.activeKeyboard(t.$selectionUl),s.on("focus",function(){t.$selectableUl.focus()})}var i=s.find("option:selected").map(function(){return e(this).val()}).get();t.select(i,"init"),"function"==typeof t.options.afterInit&&t.options.afterInit.call(this,this.$container)},generateLisFromOption:function(t,s,l){for(var i=this,n=i.$element,o="",a=e(t),r=0;r<t.attributes.length;r++){var c=t.attributes[r];"value"!==c.name&&"disabled"!==c.name&&(o+=c.name+'="'+c.value+'" ')}var d=e("<li "+o+"><span>"+i.escapeHTML(a.text())+"</span></li>"),h=d.clone(),p=a.val(),f=i.sanitize(p);d.data("ms-value",p).addClass("ms-elem-selectable").attr("id",f+"-selectable"),h.data("ms-value",p).addClass("ms-elem-selection").attr("id",f+"-selection").hide(),(a.prop("disabled")||n.prop("disabled"))&&(h.addClass(i.options.disabledClass),d.addClass(i.options.disabledClass));var m=a.parent("optgroup");if(m.length>0){var u=m.attr("label"),v=i.sanitize(u),b=i.$selectableUl.find("#optgroup-selectable-"+v),g=i.$selectionUl.find("#optgroup-selection-"+v);if(0===b.length){var $='<li class="ms-optgroup-container"></li>',C='<ul class="ms-optgroup"><li class="ms-optgroup-label"><span>'+u+"</span></li></ul>";b=e($),g=e($),b.attr("id","optgroup-selectable-"+v),g.attr("id","optgroup-selection-"+v),b.append(e(C)),g.append(e(C)),i.options.selectableOptgroup&&(b.find(".ms-optgroup-label").on("click",function(){var t=m.children(":not(:selected, :disabled)").map(function(){return e(this).val()}).get();i.select(t)}),g.find(".ms-optgroup-label").on("click",function(){var t=m.children(":selected:not(:disabled)").map(function(){return e(this).val()}).get();i.deselect(t)})),i.$selectableUl.append(b),i.$selectionUl.append(g)}s=void 0==s?b.find("ul").children().length:s+1,d.insertAt(s,b.children()),h.insertAt(s,g.children())}else s=void 0==s?i.$selectableUl.children().length:s,d.insertAt(s,i.$selectableUl),h.insertAt(s,i.$selectionUl)},addOption:function(t){var s=this;t.value&&(t=[t]),e.each(t,function(t,l){if(l.value&&0===s.$element.find("option[value='"+l.value+"']").length){var i=e('<option value="'+l.value+'">'+l.text+"</option>"),t=parseInt("undefined"==typeof l.index?s.$element.children().length:l.index),n=void 0==l.nested?s.$element:e("optgroup[label='"+l.nested+"']");i.insertAt(t,n),s.generateLisFromOption(i.get(0),t,l.nested)}})},escapeHTML:function(t){return e("<div>").text(t).html()},activeKeyboard:function(t){var s=this;t.on("focus",function(){e(this).addClass("ms-focus")}).on("blur",function(){e(this).removeClass("ms-focus")}).on("keydown",function(l){switch(l.which){case 40:case 38:return l.preventDefault(),l.stopPropagation(),void s.moveHighlight(e(this),38===l.which?-1:1);case 37:case 39:return l.preventDefault(),l.stopPropagation(),void s.switchList(t);case 9:if(s.$element.is("[tabindex]")){l.preventDefault();var i=parseInt(s.$element.attr("tabindex"),10);return i=l.shiftKey?i-1:i+1,void e('[tabindex="'+i+'"]').focus()}l.shiftKey&&s.$element.trigger("focus")}if(e.inArray(l.which,s.options.keySelect)>-1)return l.preventDefault(),l.stopPropagation(),void s.selectHighlighted(t)})},moveHighlight:function(e,t){var s=e.find(this.elemsSelector),l=s.filter(".ms-hover"),i=null,n=s.first().outerHeight(),o=e.height();"#"+this.$container.prop("id");if(s.removeClass("ms-hover"),1===t){if(i=l.nextAll(this.elemsSelector).first(),0===i.length){var a=l.parent();if(a.hasClass("ms-optgroup")){var r=a.parent(),c=r.next(":visible");i=c.length>0?c.find(this.elemsSelector).first():s.first()}else i=s.first()}}else if(t===-1&&(i=l.prevAll(this.elemsSelector).first(),0===i.length)){var a=l.parent();if(a.hasClass("ms-optgroup")){var r=a.parent(),d=r.prev(":visible");i=d.length>0?d.find(this.elemsSelector).last():s.last()}else i=s.last()}if(i.length>0){i.addClass("ms-hover");var h=e.scrollTop()+i.position().top-o/2+n/2;e.scrollTop(h)}},selectHighlighted:function(e){var t=e.find(this.elemsSelector),s=t.filter(".ms-hover").first();s.length>0&&(e.parent().hasClass("ms-selectable")?this.select(s.data("ms-value")):this.deselect(s.data("ms-value")),t.removeClass("ms-hover"))},switchList:function(e){e.blur(),this.$container.find(this.elemsSelector).removeClass("ms-hover"),e.parent().hasClass("ms-selectable")?this.$selectionUl.focus():this.$selectableUl.focus()},activeMouse:function(t){var s=this;e("body").on("mouseenter",s.elemsSelector,function(){e(this).parents(".ms-container").find(s.elemsSelector).removeClass("ms-hover"),e(this).addClass("ms-hover")}),e("body").on("mouseleave",s.elemsSelector,function(){e(this).parents(".ms-container").find(s.elemsSelector).removeClass("ms-hover")})},refresh:function(){this.destroy(),this.$element.multiSelect(this.options)},destroy:function(){e("#ms-"+this.$element.attr("id")).remove(),this.$element.css("position","").css("left",""),this.$element.removeData("multiselect")},select:function(t,s){"string"==typeof t&&(t=[t]);var l=this,i=this.$element,n=e.map(t,function(e){return l.sanitize(e)}),o=this.$selectableUl.find("#"+n.join("-selectable, #")+"-selectable").filter(":not(."+l.options.disabledClass+")"),a=this.$selectionUl.find("#"+n.join("-selection, #")+"-selection").filter(":not(."+l.options.disabledClass+")"),r=i.find("option:not(:disabled)").filter(function(){return e.inArray(this.value,t)>-1});if("init"===s&&(o=this.$selectableUl.find("#"+n.join("-selectable, #")+"-selectable"),a=this.$selectionUl.find("#"+n.join("-selection, #")+"-selection")),o.length>0){o.addClass("ms-selected").hide(),a.addClass("ms-selected").show(),r.prop("selected",!0),l.$container.find(l.elemsSelector).removeClass("ms-hover");var c=l.$selectableUl.children(".ms-optgroup-container");if(c.length>0){c.each(function(){var t=e(this).find(".ms-elem-selectable");t.length===t.filter(".ms-selected").length&&e(this).find(".ms-optgroup-label").hide()});var d=l.$selectionUl.children(".ms-optgroup-container");d.each(function(){var t=e(this).find(".ms-elem-selection");t.filter(".ms-selected").length>0&&e(this).find(".ms-optgroup-label").show()})}else if(l.options.keepOrder&&"init"!==s){var h=l.$selectionUl.find(".ms-selected");h.length>1&&h.last().get(0)!=a.get(0)&&a.insertAfter(h.last())}"init"!==s&&(i.trigger("change"),"function"==typeof l.options.afterSelect&&l.options.afterSelect.call(this,t))}},deselect:function(t){"string"==typeof t&&(t=[t]);var s=this,l=this.$element,i=e.map(t,function(e){return s.sanitize(e)}),n=this.$selectableUl.find("#"+i.join("-selectable, #")+"-selectable"),o=this.$selectionUl.find("#"+i.join("-selection, #")+"-selection").filter(".ms-selected").filter(":not(."+s.options.disabledClass+")"),a=l.find("option").filter(function(){return e.inArray(this.value,t)>-1});if(o.length>0){n.removeClass("ms-selected").show(),o.removeClass("ms-selected").hide(),a.prop("selected",!1),s.$container.find(s.elemsSelector).removeClass("ms-hover");var r=s.$selectableUl.children(".ms-optgroup-container");if(r.length>0){r.each(function(){var t=e(this).find(".ms-elem-selectable");t.filter(":not(.ms-selected)").length>0&&e(this).find(".ms-optgroup-label").show()});var c=s.$selectionUl.children(".ms-optgroup-container");c.each(function(){var t=e(this).find(".ms-elem-selection");0===t.filter(".ms-selected").length&&e(this).find(".ms-optgroup-label").hide()})}l.trigger("change"),"function"==typeof s.options.afterDeselect&&s.options.afterDeselect.call(this,t)}},select_all:function(){var t=this.$element,s=t.val();if(t.find('option:not(":disabled")').prop("selected",!0),this.$selectableUl.find(".ms-elem-selectable").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").hide(),this.$selectionUl.find(".ms-optgroup-label").show(),this.$selectableUl.find(".ms-optgroup-label").hide(),this.$selectionUl.find(".ms-elem-selection").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").show(),this.$selectionUl.focus(),t.trigger("change"),"function"==typeof this.options.afterSelect){var l=e.grep(t.val(),function(t){return e.inArray(t,s)<0});this.options.afterSelect.call(this,l)}},deselect_all:function(){var e=this.$element,t=e.val();e.find("option").prop("selected",!1),this.$selectableUl.find(".ms-elem-selectable").removeClass("ms-selected").show(),this.$selectionUl.find(".ms-optgroup-label").hide(),this.$selectableUl.find(".ms-optgroup-label").show(),this.$selectionUl.find(".ms-elem-selection").removeClass("ms-selected").hide(),this.$selectableUl.focus(),e.trigger("change"),"function"==typeof this.options.afterDeselect&&this.options.afterDeselect.call(this,t)},sanitize:function(e){var t,s,l=0;if(0==e.length)return l;var i=0;for(t=0,i=e.length;t<i;t++)s=e.charCodeAt(t),l=(l<<5)-l+s,l|=0;return l}},e.fn.multiSelect=function(){var s=arguments[0],l=arguments;return this.each(function(){var i=e(this),n=i.data("multiselect"),o=e.extend({},e.fn.multiSelect.defaults,i.data(),"object"==typeof s&&s);n||i.data("multiselect",n=new t(this,o)),"string"==typeof s?n[s](l[1]):n.init()})},e.fn.multiSelect.defaults={keySelect:[32],selectableOptgroup:!1,disabledClass:"disabled",dblClick:!1,keepOrder:!1,cssClass:""},e.fn.multiSelect.Constructor=t,e.fn.insertAt=function(e,t){return this.each(function(){0===e?t.prepend(this):t.children().eq(e-1).after(this)})}}(window.jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhaWx5c3RhdGVtZW50L211bHRpLXNlbGVjdC5qcyJdLCJuYW1lcyI6WyIkIiwiTXVsdGlTZWxlY3QiLCJlbGVtZW50Iiwib3B0aW9ucyIsInRoaXMiLCIkZWxlbWVudCIsIiRjb250YWluZXIiLCJjbGFzcyIsIiRzZWxlY3RhYmxlQ29udGFpbmVyIiwiJHNlbGVjdGlvbkNvbnRhaW5lciIsIiRzZWxlY3RhYmxlVWwiLCJ0YWJpbmRleCIsIiRzZWxlY3Rpb25VbCIsInNjcm9sbFRvIiwiZWxlbXNTZWxlY3RvciIsImRpc2FibGVkQ2xhc3MiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsImluaXQiLCJ0aGF0IiwibXMiLCJuZXh0IiwibGVuZ3RoIiwiY3NzIiwicG9zaXRpb24iLCJsZWZ0IiwiYXR0ciIsIk1hdGgiLCJjZWlsIiwicmFuZG9tIiwiYWRkQ2xhc3MiLCJjc3NDbGFzcyIsImZpbmQiLCJlYWNoIiwiZ2VuZXJhdGVMaXNGcm9tT3B0aW9uIiwiaGlkZSIsInNlbGVjdGFibGVIZWFkZXIiLCJhcHBlbmQiLCJzZWxlY3RhYmxlRm9vdGVyIiwic2VsZWN0aW9uSGVhZGVyIiwic2VsZWN0aW9uRm9vdGVyIiwiYWZ0ZXIiLCJhY3RpdmVNb3VzZSIsImFjdGl2ZUtleWJvYXJkIiwiYWN0aW9uIiwiZGJsQ2xpY2siLCJvbiIsInNlbGVjdCIsImRhdGEiLCJkZXNlbGVjdCIsImZvY3VzIiwic2VsZWN0ZWRWYWx1ZXMiLCJtYXAiLCJ2YWwiLCJnZXQiLCJhZnRlckluaXQiLCJjYWxsIiwib3B0aW9uIiwiaW5kZXgiLCJhdHRyaWJ1dGVzIiwiJG9wdGlvbiIsImNwdCIsIm5hbWUiLCJ2YWx1ZSIsInNlbGVjdGFibGVMaSIsImVzY2FwZUhUTUwiLCJ0ZXh0Iiwic2VsZWN0ZWRMaSIsImNsb25lIiwiZWxlbWVudElkIiwic2FuaXRpemUiLCJwcm9wIiwiJG9wdGdyb3VwIiwicGFyZW50Iiwib3B0Z3JvdXBMYWJlbCIsIm9wdGdyb3VwSWQiLCIkc2VsZWN0YWJsZU9wdGdyb3VwIiwiJHNlbGVjdGlvbk9wdGdyb3VwIiwib3B0Z3JvdXBDb250YWluZXJUcGwiLCJvcHRncm91cFRwbCIsInNlbGVjdGFibGVPcHRncm91cCIsInZhbHVlcyIsImNoaWxkcmVuIiwidW5kZWZpbmVkIiwiaW5zZXJ0QXQiLCJhZGRPcHRpb24iLCJwYXJzZUludCIsIm5lc3RlZCIsImh0bWwiLCIkbGlzdCIsInJlbW92ZUNsYXNzIiwiZSIsIndoaWNoIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJtb3ZlSGlnaGxpZ2h0Iiwic3dpdGNoTGlzdCIsImlzIiwic2hpZnRLZXkiLCJ0cmlnZ2VyIiwiaW5BcnJheSIsImtleVNlbGVjdCIsInNlbGVjdEhpZ2hsaWdodGVkIiwiZGlyZWN0aW9uIiwiJGVsZW1zIiwiJGN1cnJFbGVtIiwiZmlsdGVyIiwiJG5leHRFbGVtIiwiZWxlbUhlaWdodCIsImZpcnN0Iiwib3V0ZXJIZWlnaHQiLCJjb250YWluZXJIZWlnaHQiLCJoZWlnaHQiLCJuZXh0QWxsIiwiJG9wdGdyb3VwVWwiLCJoYXNDbGFzcyIsIiRvcHRncm91cExpIiwiJG5leHRPcHRncm91cExpIiwicHJldkFsbCIsIiRwcmV2T3B0Z3JvdXBMaSIsInByZXYiLCJsYXN0Iiwic2Nyb2xsVG9wIiwidG9wIiwiJGhpZ2hsaWdodGVkRWxlbSIsImJsdXIiLCJwYXJlbnRzIiwicmVmcmVzaCIsImRlc3Ryb3kiLCJtdWx0aVNlbGVjdCIsInJlbW92ZSIsInJlbW92ZURhdGEiLCJtZXRob2QiLCJtc0lkcyIsInNlbGVjdGFibGVzIiwiam9pbiIsInNlbGVjdGlvbnMiLCJzaG93Iiwic2VsZWN0YWJsZU9wdGdyb3VwcyIsInNlbGVjdGFibGVzTGkiLCJzZWxlY3Rpb25PcHRncm91cHMiLCJzZWxlY3Rpb25zTGkiLCJrZWVwT3JkZXIiLCJzZWxlY3Rpb25MaUxhc3QiLCJpbnNlcnRBZnRlciIsImFmdGVyU2VsZWN0IiwiYWZ0ZXJEZXNlbGVjdCIsInNlbGVjdF9hbGwiLCJncmVwIiwiaXRlbSIsImRlc2VsZWN0X2FsbCIsImkiLCJjaGFyYWN0ZXIiLCJoYXNoIiwibHMiLCJjaGFyQ29kZUF0IiwiZm4iLCJhcmd1bWVudHMiLCJhcmdzIiwiJHRoaXMiLCJleHRlbmQiLCJkZWZhdWx0cyIsIkNvbnN0cnVjdG9yIiwiJHBhcmVudCIsInByZXBlbmQiLCJlcSIsIndpbmRvdyIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBV0MsU0FBVUEsR0FFVCxZQU1BLElBQUlDLEdBQWMsU0FBVUMsRUFBU0MsR0FDbkNDLEtBQUtELFFBQVVBLEVBQ2ZDLEtBQUtDLFNBQVdMLEVBQUVFLEdBQ2xCRSxLQUFLRSxXQUFhTixFQUFFLFVBQVlPLFFBQVMsd0RBQ3pDSCxLQUFLSSxxQkFBdUJSLEVBQUUsVUFBWU8sUUFBUyxrQkFDbkRILEtBQUtLLG9CQUFzQlQsRUFBRSxVQUFZTyxRQUFTLGlCQUNsREgsS0FBS00sY0FBZ0JWLEVBQUUsU0FBV08sUUFBUyxVQUFXSSxTQUFhLE9BQ25FUCxLQUFLUSxhQUFlWixFQUFFLFNBQVdPLFFBQVMsVUFBV0ksU0FBYSxPQUNsRVAsS0FBS1MsU0FBVyxFQUNoQlQsS0FBS1UsY0FBZ0IsNkRBQTZEWCxFQUFRWSxjQUFjLElBRzFHZCxHQUFZZSxXQUNWQyxZQUFhaEIsRUFFYmlCLEtBQU0sV0FDSixHQUFJQyxHQUFPZixLQUNQZ0IsRUFBS2hCLEtBQUtDLFFBRWQsSUFBd0MsSUFBcENlLEVBQUdDLEtBQUssaUJBQWlCQyxPQUFhLENBQ3hDRixFQUFHRyxLQUFNQyxTQUFVLFdBQVlDLEtBQU0sWUFDckNMLEVBQUdNLEtBQUssS0FBTU4sRUFBR00sS0FBSyxNQUFRTixFQUFHTSxLQUFLLE1BQVFDLEtBQUtDLEtBQW1CLElBQWRELEtBQUtFLFVBQWUsZUFDNUV6QixLQUFLRSxXQUFXb0IsS0FBSyxLQUFNLE1BQU1OLEVBQUdNLEtBQUssT0FDekN0QixLQUFLRSxXQUFXd0IsU0FBU1gsRUFBS2hCLFFBQVE0QixVQUN0Q1gsRUFBR1ksS0FBSyxVQUFVQyxLQUFLLFdBQ3JCZCxFQUFL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b0IsR0FBaEIxRixFQUFNekMsT0FBYSxNQUFPbUksRUFDOUIsSUFBSUMsR0FBSyxDQUNULEtBQUtILEVBQUksRUFBR0csRUFBSzNGLEVBQU16QyxPQUFRaUksRUFBSUcsRUFBSUgsSUFDckNDLEVBQWF6RixFQUFNNEYsV0FBV0osR0FDOUJFLEdBQVVBLEdBQU0sR0FBR0EsRUFBTUQsRUFDekJDLEdBQVEsQ0FFVixPQUFPQSxLQU9YekosRUFBRTRKLEdBQUczQixZQUFjLFdBQ2pCLEdBQUl4RSxHQUFTb0csVUFBVSxHQUNuQkMsRUFBT0QsU0FFWCxPQUFPekosTUFBSzZCLEtBQUssV0FDZixHQUFJOEgsR0FBUS9KLEVBQUVJLE1BQ1Y0QyxFQUFPK0csRUFBTS9HLEtBQUssZUFDbEI3QyxFQUFVSCxFQUFFZ0ssVUFBV2hLLEVBQUU0SixHQUFHM0IsWUFBWWdDLFNBQVVGLEVBQU0vRyxPQUEwQixnQkFBWFMsSUFBdUJBLEVBRTdGVCxJQUFPK0csRUFBTS9HLEtBQUssY0FBZ0JBLEVBQU8sR0FBSS9DLEdBQVlHLEtBQU1ELElBRTlDLGdCQUFYc0QsR0FDVFQsRUFBS1MsR0FBUXFHLEVBQUssSUFFbEI5RyxFQUFLOUIsVUFLWGxCLEVBQUU0SixHQUFHM0IsWUFBWWdDLFVBQ2Y1RCxXQUFZLElBQ1pyQixvQkFBb0IsRUFDcEJqRSxjQUFnQixXQUNoQjhCLFVBQVcsRUFDWGlHLFdBQVcsRUFDWC9HLFNBQVUsSUFHWi9CLEVBQUU0SixHQUFHM0IsWUFBWWlDLFlBQWNqSyxFQUUvQkQsRUFBRTRKLEdBQUd4RSxTQUFXLFNBQVMxQixFQUFPeUcsR0FDOUIsTUFBTy9KLE1BQUs2QixLQUFLLFdBQ0QsSUFBVnlCLEVBQ0Z5RyxFQUFRQyxRQUFRaEssTUFFaEIrSixFQUFRakYsV0FBV21GLEdBQUczRyxFQUFRLEdBQUdqQixNQUFNckMsVUFLN0NrSyxPQUFPQyIsImZpbGUiOiJkYWlseXN0YXRlbWVudC9tdWx0aS1zZWxlY3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiBNdWx0aVNlbGVjdCB2MC45LjExXG4qIENvcHlyaWdodCAoYykgMjAxMiBMb3VpcyBDdW55XG4qXG4qIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlLiBJdCBjb21lcyB3aXRob3V0IGFueSB3YXJyYW50eSwgdG9cbiogdGhlIGV4dGVudCBwZXJtaXR0ZWQgYnkgYXBwbGljYWJsZSBsYXcuIFlvdSBjYW4gcmVkaXN0cmlidXRlIGl0XG4qIGFuZC9vciBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBEbyBXaGF0IFRoZSBGdWNrIFlvdSBXYW50XG4qIFRvIFB1YmxpYyBMaWNlbnNlLCBWZXJzaW9uIDIsIGFzIHB1Ymxpc2hlZCBieSBTYW0gSG9jZXZhci4gU2VlXG4qIGh0dHA6Ly9zYW0uem95Lm9yZy93dGZwbC9DT1BZSU5HIGZvciBtb3JlIGRldGFpbHMuXG4qL1xuXG4hZnVuY3Rpb24gKCQpIHtcblxuICBcInVzZSBzdHJpY3RcIjtcblxuXG4gLyogTVVMVElTRUxFQ1QgQ0xBU1MgREVGSU5JVElPTlxuICAqID09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuICB2YXIgTXVsdGlTZWxlY3QgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgdGhpcy4kY29udGFpbmVyID0gJCgnPGRpdi8+JywgeyAnY2xhc3MnOiBcIiBtcy1jb250YWluZXIgZ2x5cGhpY29uIGdseXBoaWNvbi1yZXNpemUtaG9yaXpvbnRhbFwiIH0pO1xuICAgIHRoaXMuJHNlbGVjdGFibGVDb250YWluZXIgPSAkKCc8ZGl2Lz4nLCB7ICdjbGFzcyc6ICdtcy1zZWxlY3RhYmxlJyB9KTtcbiAgICB0aGlzLiRzZWxlY3Rpb25Db250YWluZXIgPSAkKCc8ZGl2Lz4nLCB7ICdjbGFzcyc6ICdtcy1zZWxlY3Rpb24nIH0pO1xuICAgIHRoaXMuJHNlbGVjdGFibGVVbCA9ICQoJzx1bC8+JywgeyAnY2xhc3MnOiBcIm1zLWxpc3RcIiwgJ3RhYmluZGV4JyA6ICctMScgfSk7XG4gICAgdGhpcy4kc2VsZWN0aW9uVWwgPSAkKCc8dWwvPicsIHsgJ2NsYXNzJzogXCJtcy1saXN0XCIsICd0YWJpbmRleCcgOiAnLTEnIH0pO1xuICAgIHRoaXMuc2Nyb2xsVG8gPSAwO1xuICAgIHRoaXMuZWxlbXNTZWxlY3RvciA9ICdsaTp2aXNpYmxlOm5vdCgubXMtb3B0Z3JvdXAtbGFiZWwsLm1zLW9wdGdyb3VwLWNvbnRhaW5lciwuJytvcHRpb25zLmRpc2FibGVkQ2xhc3MrJyknO1xuICB9O1xuXG4gIE11bHRpU2VsZWN0LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogTXVsdGlTZWxlY3QsXG5cbiAgICBpbml0OiBmdW5jdGlvbigpe1xuICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgIG1zID0gdGhpcy4kZWxlbWVudDtcblxuICAgICAgaWYgKG1zLm5leHQoJy5tcy1jb250YWluZXInKS5sZW5ndGggPT09IDApe1xuICAgICAgICBtcy5jc3MoeyBwb3NpdGlvbjogJ2Fic29sdXRlJywgbGVmdDogJy05OTk5cHgnIH0pO1xuICAgICAgICBtcy5hdHRyKCdpZCcsIG1zLmF0dHIoJ2lkJykgPyBtcy5hdHRyKCdpZCcpIDogTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkqMTAwMCkrJ211bHRpc2VsZWN0Jyk7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5hdHRyKCdpZCcsICdtcy0nK21zLmF0dHIoJ2lkJykpO1xuICAgICAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhhdC5vcHRpb25zLmNzc0NsYXNzKTtcbiAgICAgICAgbXMuZmluZCgnb3B0aW9uJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgIHRoYXQuZ2VuZXJhdGVMaXNGcm9tT3B0aW9uKHRoaXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRzZWxlY3Rpb25VbC5maW5kKCcubXMtb3B0Z3JvdXAtbGFiZWwnKS5oaWRlKCk7XG5cbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zZWxlY3RhYmxlSGVhZGVyKXtcbiAgICAgICAgICB0aGF0LiRzZWxlY3RhYmxlQ29udGFpbmVyLmFwcGVuZCh0aGF0Lm9wdGlvbnMuc2VsZWN0YWJsZUhlYWRlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhhdC4kc2VsZWN0YWJsZUNvbnRhaW5lci5hcHBlbmQodGhhdC4kc2VsZWN0YWJsZVVsKTtcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zZWxlY3RhYmxlRm9vdGVyKXtcbiAgICAgICAgICB0aGF0LiRzZWxlY3RhYmxlQ29udGFpbmVyLmFwcGVuZCh0aGF0Lm9wdGlvbnMuc2VsZWN0YWJsZUZvb3Rlcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhhdC5vcHRpb25zLnNlbGVjdGlvbkhlYWRlcil7XG4gICAgICAgICAgdGhhdC4kc2VsZWN0aW9uQ29udGFpbmVyLmFwcGVuZCh0aGF0Lm9wdGlvbnMuc2VsZWN0aW9uSGVhZGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGF0LiRzZWxlY3Rpb25Db250YWluZXIuYXBwZW5kKHRoYXQuJHNlbGVjdGlvblVsKTtcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zZWxlY3Rpb25Gb290ZXIpe1xuICAgICAgICAgIHRoYXQuJHNlbGVjdGlvbkNvbnRhaW5lci5hcHBlbmQodGhhdC5vcHRpb25zLnNlbGVjdGlvbkZvb3Rlcik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGF0LiRjb250YWluZXIuYXBwZW5kKHRoYXQuJHNlbGVjdGFibGVDb250YWluZXIpO1xuICAgICAgICB0aGF0LiRjb250YWluZXIuYXBwZW5kKHRoYXQuJHNlbGVjdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG1zLmFmdGVyKHRoYXQuJGNvbnRhaW5lcik7XG5cbiAgICAgICAgdGhhdC5hY3RpdmVNb3VzZSh0aGF0LiRzZWxlY3RhYmxlVWwpO1xuICAgICAgICB0aGF0LmFjdGl2ZUtleWJvYXJkKHRoYXQuJHNlbGVjdGFibGVVbCk7XG5cbiAgICAgICAgdmFyIGFjdGlvbiA9IHRoYXQub3B0aW9ucy5kYmxDbGljayA/ICdkYmxjbGljaycgOiAnY2xpY2snO1xuXG4gICAgICAgIHRoYXQuJHNlbGVjdGFibGVVbC5vbihhY3Rpb24sICcubXMtZWxlbS1zZWxlY3RhYmxlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICB0aGF0LnNlbGVjdCgkKHRoaXMpLmRhdGEoJ21zLXZhbHVlJykpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhhdC4kc2VsZWN0aW9uVWwub24oYWN0aW9uLCAnLm1zLWVsZW0tc2VsZWN0aW9uJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICB0aGF0LmRlc2VsZWN0KCQodGhpcykuZGF0YSgnbXMtdmFsdWUnKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoYXQuYWN0aXZlTW91c2UodGhhdC4kc2VsZWN0aW9uVWwpO1xuICAgICAgICB0aGF0LmFjdGl2ZUtleWJvYXJkKHRoYXQuJHNlbGVjdGlvblVsKTtcblxuICAgICAgICBtcy5vbignZm9jdXMnLCBmdW5jdGlvbigpe1xuICAgICAgICAgIHRoYXQuJHNlbGVjdGFibGVVbC5mb2N1cygpO1xuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICB2YXIgc2VsZWN0ZWRWYWx1ZXMgPSBtcy5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS5tYXAoZnVuY3Rpb24oKXsgcmV0dXJuICQodGhpcykudmFsKCk7IH0pLmdldCgpO1xuICAgICAgdGhhdC5zZWxlY3Qoc2VsZWN0ZWRWYWx1ZXMsICdpbml0Jyk7XG5cbiAgICAgIGlmICh0eXBlb2YgdGhhdC5vcHRpb25zLmFmdGVySW5pdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGF0Lm9wdGlvbnMuYWZ0ZXJJbml0LmNhbGwodGhpcywgdGhpcy4kY29udGFpbmVyKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgJ2dlbmVyYXRlTGlzRnJvbU9wdGlvbicgOiBmdW5jdGlvbihvcHRpb24sIGluZGV4LCAkY29udGFpbmVyKXtcbiAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICBtcyA9IHRoYXQuJGVsZW1lbnQsXG4gICAgICAgICAgYXR0cmlidXRlcyA9IFwiXCIsXG4gICAgICAgICAgJG9wdGlvbiA9ICQob3B0aW9uKTtcblxuICAgICAgZm9yICh2YXIgY3B0ID0gMDsgY3B0IDwgb3B0aW9uLmF0dHJpYnV0ZXMubGVuZ3RoOyBjcHQrKyl7XG4gICAgICAgIHZhciBhdHRyID0gb3B0aW9uLmF0dHJpYnV0ZXNbY3B0XTtcblxuICAgICAgICBpZihhdHRyLm5hbWUgIT09ICd2YWx1ZScgJiYgYXR0ci5uYW1lICE9PSAnZGlzYWJsZWQnKXtcbiAgICAgICAgICBhdHRyaWJ1dGVzICs9IGF0dHIubmFtZSsnPVwiJythdHRyLnZhbHVlKydcIiAnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgc2VsZWN0YWJsZUxpID0gJCgnPGxpICcrYXR0cmlidXRlcysnPjxzcGFuPicrdGhhdC5lc2NhcGVIVE1MKCRvcHRpb24udGV4dCgpKSsnPC9zcGFuPjwvbGk+JyksXG4gICAgICAgICAgc2VsZWN0ZWRMaSA9IHNlbGVjdGFibGVMaS5jbG9uZSgpLFxuICAgICAgICAgIHZhbHVlID0gJG9wdGlvbi52YWwoKSxcbiAgICAgICAgICBlbGVtZW50SWQgPSB0aGF0LnNhbml0aXplKHZhbHVlKTtcblxuICAgICAgc2VsZWN0YWJsZUxpXG4gICAgICAgIC5kYXRhKCdtcy12YWx1ZScsIHZhbHVlKVxuICAgICAgICAuYWRkQ2xhc3MoJ21zLWVsZW0tc2VsZWN0YWJsZScpXG4gICAgICAgIC5hdHRyKCdpZCcsIGVsZW1lbnRJZCsnLXNlbGVjdGFibGUnKTtcblxuICAgICAgc2VsZWN0ZWRMaVxuICAgICAgICAuZGF0YSgnbXMtdmFsdWUnLCB2YWx1ZSlcbiAgICAgICAgLmFkZENsYXNzKCdtcy1lbGVtLXNlbGVjdGlvbicpXG4gICAgICAgIC5hdHRyKCdpZCcsIGVsZW1lbnRJZCsnLXNlbGVjdGlvbicpXG4gICAgICAgIC5oaWRlKCk7XG5cbiAgICAgIGlmICgkb3B0aW9uLnByb3AoJ2Rpc2FibGVkJykgfHwgbXMucHJvcCgnZGlzYWJsZWQnKSl7XG4gICAgICAgIHNlbGVjdGVkTGkuYWRkQ2xhc3ModGhhdC5vcHRpb25zLmRpc2FibGVkQ2xhc3MpO1xuICAgICAgICBzZWxlY3RhYmxlTGkuYWRkQ2xhc3ModGhhdC5vcHRpb25zLmRpc2FibGVkQ2xhc3MpO1xuICAgICAgfVxuXG4gICAgICB2YXIgJG9wdGdyb3VwID0gJG9wdGlvbi5wYXJlbnQoJ29wdGdyb3VwJyk7XG5cbiAgICAgIGlmICgkb3B0Z3JvdXAubGVuZ3RoID4gMCl7XG4gICAgICAgIHZhciBvcHRncm91cExhYmVsID0gJG9wdGdyb3VwLmF0dHIoJ2xhYmVsJyksXG4gICAgICAgICAgICBvcHRncm91cElkID0gdGhhdC5zYW5pdGl6ZShvcHRncm91cExhYmVsKSxcbiAgICAgICAgICAgICRzZWxlY3RhYmxlT3B0Z3JvdXAgPSB0aGF0LiRzZWxlY3RhYmxlVWwuZmluZCgnI29wdGdyb3VwLXNlbGVjdGFibGUtJytvcHRncm91cElkKSxcbiAgICAgICAgICAgICRzZWxlY3Rpb25PcHRncm91cCA9IHRoYXQuJHNlbGVjdGlvblVsLmZpbmQoJyNvcHRncm91cC1zZWxlY3Rpb24tJytvcHRncm91cElkKTtcblxuICAgICAgICBpZiAoJHNlbGVjdGFibGVPcHRncm91cC5sZW5ndGggPT09IDApe1xuICAgICAgICAgIHZhciBvcHRncm91cENvbnRhaW5lclRwbCA9ICc8bGkgY2xhc3M9XCJtcy1vcHRncm91cC1jb250YWluZXJcIj48L2xpPicsXG4gICAgICAgICAgICAgIG9wdGdyb3VwVHBsID0gJzx1bCBjbGFzcz1cIm1zLW9wdGdyb3VwXCI+PGxpIGNsYXNzPVwibXMtb3B0Z3JvdXAtbGFiZWxcIj48c3Bhbj4nK29wdGdyb3VwTGFiZWwrJzwvc3Bhbj48L2xpPjwvdWw+JztcblxuICAgICAgICAgICRzZWxlY3RhYmxlT3B0Z3JvdXAgPSAkKG9wdGdyb3VwQ29udGFpbmVyVHBsKTtcbiAgICAgICAgICAkc2VsZWN0aW9uT3B0Z3JvdXAgPSAkKG9wdGdyb3VwQ29udGFpbmVyVHBsKTtcbiAgICAgICAgICAkc2VsZWN0YWJsZU9wdGdyb3VwLmF0dHIoJ2lkJywgJ29wdGdyb3VwLXNlbGVjdGFibGUtJytvcHRncm91cElkKTtcbiAgICAgICAgICAkc2VsZWN0aW9uT3B0Z3JvdXAuYXR0cignaWQnLCAnb3B0Z3JvdXAtc2VsZWN0aW9uLScrb3B0Z3JvdXBJZCk7XG4gICAgICAgICAgJHNlbGVjdGFibGVPcHRncm91cC5hcHBlbmQoJChvcHRncm91cFRwbCkpO1xuICAgICAgICAgICRzZWxlY3Rpb25PcHRncm91cC5hcHBlbmQoJChvcHRncm91cFRwbCkpO1xuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuc2VsZWN0YWJsZU9wdGdyb3VwKXtcbiAgICAgICAgICAgICRzZWxlY3RhYmxlT3B0Z3JvdXAuZmluZCgnLm1zLW9wdGdyb3VwLWxhYmVsJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9ICRvcHRncm91cC5jaGlsZHJlbignOm5vdCg6c2VsZWN0ZWQsIDpkaXNhYmxlZCknKS5tYXAoZnVuY3Rpb24oKXsgcmV0dXJuICQodGhpcykudmFsKCkgfSkuZ2V0KCk7XG4gICAgICAgICAgICAgIHRoYXQuc2VsZWN0KHZhbHVlcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzZWxlY3Rpb25PcHRncm91cC5maW5kKCcubXMtb3B0Z3JvdXAtbGFiZWwnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICB2YXIgdmFsdWVzID0gJG9wdGdyb3VwLmNoaWxkcmVuKCc6c2VsZWN0ZWQ6bm90KDpkaXNhYmxlZCknKS5tYXAoZnVuY3Rpb24oKXsgcmV0dXJuICQodGhpcykudmFsKCkgfSkuZ2V0KCk7XG4gICAgICAgICAgICAgIHRoYXQuZGVzZWxlY3QodmFsdWVzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGF0LiRzZWxlY3RhYmxlVWwuYXBwZW5kKCRzZWxlY3RhYmxlT3B0Z3JvdXApO1xuICAgICAgICAgIHRoYXQuJHNlbGVjdGlvblVsLmFwcGVuZCgkc2VsZWN0aW9uT3B0Z3JvdXApO1xuICAgICAgICB9XG4gICAgICAgIGluZGV4ID0gaW5kZXggPT0gdW5kZWZpbmVkID8gJHNlbGVjdGFibGVPcHRncm91cC5maW5kKCd1bCcpLmNoaWxkcmVuKCkubGVuZ3RoIDogaW5kZXggKyAxO1xuICAgICAgICBzZWxlY3RhYmxlTGkuaW5zZXJ0QXQoaW5kZXgsICRzZWxlY3RhYmxlT3B0Z3JvdXAuY2hpbGRyZW4oKSk7XG4gICAgICAgIHNlbGVjdGVkTGkuaW5zZXJ0QXQoaW5kZXgsICRzZWxlY3Rpb25PcHRncm91cC5jaGlsZHJlbigpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluZGV4ID0gaW5kZXggPT0gdW5kZWZpbmVkID8gdGhhdC4kc2VsZWN0YWJsZVVsLmNoaWxkcmVuKCkubGVuZ3RoIDogaW5kZXg7XG5cbiAgICAgICAgc2VsZWN0YWJsZUxpLmluc2VydEF0KGluZGV4LCB0aGF0LiRzZWxlY3RhYmxlVWwpO1xuICAgICAgICBzZWxlY3RlZExpLmluc2VydEF0KGluZGV4LCB0aGF0LiRzZWxlY3Rpb25VbCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgICdhZGRPcHRpb24nIDogZnVuY3Rpb24ob3B0aW9ucyl7XG4gICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgIGlmIChvcHRpb25zLnZhbHVlKSBvcHRpb25zID0gW29wdGlvbnNdO1xuICAgICAgJC5lYWNoKG9wdGlvbnMsIGZ1bmN0aW9uKGluZGV4LCBvcHRpb24pe1xuICAgICAgICBpZiAob3B0aW9uLnZhbHVlICYmIHRoYXQuJGVsZW1lbnQuZmluZChcIm9wdGlvblt2YWx1ZT0nXCIrb3B0aW9uLnZhbHVlK1wiJ11cIikubGVuZ3RoID09PSAwKXtcbiAgICAgICAgICB2YXIgJG9wdGlvbiA9ICQoJzxvcHRpb24gdmFsdWU9XCInK29wdGlvbi52YWx1ZSsnXCI+JytvcHRpb24udGV4dCsnPC9vcHRpb24+JyksXG4gICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoKHR5cGVvZiBvcHRpb24uaW5kZXggPT09ICd1bmRlZmluZWQnID8gdGhhdC4kZWxlbWVudC5jaGlsZHJlbigpLmxlbmd0aCA6IG9wdGlvbi5pbmRleCkpLFxuICAgICAgICAgICAgICAkY29udGFpbmVyID0gb3B0aW9uLm5lc3RlZCA9PSB1bmRlZmluZWQgPyB0aGF0LiRlbGVtZW50IDogJChcIm9wdGdyb3VwW2xhYmVsPSdcIitvcHRpb24ubmVzdGVkK1wiJ11cIilcblxuICAgICAgICAgICRvcHRpb24uaW5zZXJ0QXQoaW5kZXgsICRjb250YWluZXIpO1xuICAgICAgICAgIHRoYXQuZ2VuZXJhdGVMaXNGcm9tT3B0aW9uKCRvcHRpb24uZ2V0KDApLCBpbmRleCwgb3B0aW9uLm5lc3RlZCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSxcblxuICAgICdlc2NhcGVIVE1MJyA6IGZ1bmN0aW9uKHRleHQpe1xuICAgICAgcmV0dXJuICQoXCI8ZGl2PlwiKS50ZXh0KHRleHQpLmh0bWwoKTtcbiAgICB9LFxuXG4gICAgJ2FjdGl2ZUtleWJvYXJkJyA6IGZ1bmN0aW9uKCRsaXN0KXtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgJGxpc3Qub24oJ2ZvY3VzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnbXMtZm9jdXMnKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2JsdXInLCBmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdtcy1mb2N1cycpO1xuICAgICAgfSlcbiAgICAgIC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGUpe1xuICAgICAgICBzd2l0Y2ggKGUud2hpY2gpIHtcbiAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdGhhdC5tb3ZlSGlnaGxpZ2h0KCQodGhpcyksIChlLndoaWNoID09PSAzOCkgPyAtMSA6IDEpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGF0LnN3aXRjaExpc3QoJGxpc3QpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIGlmKHRoYXQuJGVsZW1lbnQuaXMoJ1t0YWJpbmRleF0nKSl7XG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgdmFyIHRhYmluZGV4ID0gcGFyc2VJbnQodGhhdC4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpLCAxMCk7XG4gICAgICAgICAgICAgIHRhYmluZGV4ID0gKGUuc2hpZnRLZXkpID8gdGFiaW5kZXgtMSA6IHRhYmluZGV4KzE7XG4gICAgICAgICAgICAgICQoJ1t0YWJpbmRleD1cIicrKHRhYmluZGV4KSsnXCJdJykuZm9jdXMoKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgIGlmKGUuc2hpZnRLZXkpe1xuICAgICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignZm9jdXMnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKCQuaW5BcnJheShlLndoaWNoLCB0aGF0Lm9wdGlvbnMua2V5U2VsZWN0KSA+IC0xKXtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICB0aGF0LnNlbGVjdEhpZ2hsaWdodGVkKCRsaXN0KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAnbW92ZUhpZ2hsaWdodCc6IGZ1bmN0aW9uKCRsaXN0LCBkaXJlY3Rpb24pe1xuICAgICAgdmFyICRlbGVtcyA9ICRsaXN0LmZpbmQodGhpcy5lbGVtc1NlbGVjdG9yKSxcbiAgICAgICAgICAkY3VyckVsZW0gPSAkZWxlbXMuZmlsdGVyKCcubXMtaG92ZXInKSxcbiAgICAgICAgICAkbmV4dEVsZW0gPSBudWxsLFxuICAgICAgICAgIGVsZW1IZWlnaHQgPSAkZWxlbXMuZmlyc3QoKS5vdXRlckhlaWdodCgpLFxuICAgICAgICAgIGNvbnRhaW5lckhlaWdodCA9ICRsaXN0LmhlaWdodCgpLFxuICAgICAgICAgIGNvbnRhaW5lclNlbGVjdG9yID0gJyMnK3RoaXMuJGNvbnRhaW5lci5wcm9wKCdpZCcpO1xuXG4gICAgICAkZWxlbXMucmVtb3ZlQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICBpZiAoZGlyZWN0aW9uID09PSAxKXsgLy8gRE9XTlxuXG4gICAgICAgICRuZXh0RWxlbSA9ICRjdXJyRWxlbS5uZXh0QWxsKHRoaXMuZWxlbXNTZWxlY3RvcikuZmlyc3QoKTtcbiAgICAgICAgaWYgKCRuZXh0RWxlbS5sZW5ndGggPT09IDApe1xuICAgICAgICAgIHZhciAkb3B0Z3JvdXBVbCA9ICRjdXJyRWxlbS5wYXJlbnQoKTtcblxuICAgICAgICAgIGlmICgkb3B0Z3JvdXBVbC5oYXNDbGFzcygnbXMtb3B0Z3JvdXAnKSl7XG4gICAgICAgICAgICB2YXIgJG9wdGdyb3VwTGkgPSAkb3B0Z3JvdXBVbC5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICAkbmV4dE9wdGdyb3VwTGkgPSAkb3B0Z3JvdXBMaS5uZXh0KCc6dmlzaWJsZScpO1xuXG4gICAgICAgICAgICBpZiAoJG5leHRPcHRncm91cExpLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAkbmV4dEVsZW0gPSAkbmV4dE9wdGdyb3VwTGkuZmluZCh0aGlzLmVsZW1zU2VsZWN0b3IpLmZpcnN0KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAkbmV4dEVsZW0gPSAkZWxlbXMuZmlyc3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJG5leHRFbGVtID0gJGVsZW1zLmZpcnN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gLTEpeyAvLyBVUFxuXG4gICAgICAgICRuZXh0RWxlbSA9ICRjdXJyRWxlbS5wcmV2QWxsKHRoaXMuZWxlbXNTZWxlY3RvcikuZmlyc3QoKTtcbiAgICAgICAgaWYgKCRuZXh0RWxlbS5sZW5ndGggPT09IDApe1xuICAgICAgICAgIHZhciAkb3B0Z3JvdXBVbCA9ICRjdXJyRWxlbS5wYXJlbnQoKTtcblxuICAgICAgICAgIGlmICgkb3B0Z3JvdXBVbC5oYXNDbGFzcygnbXMtb3B0Z3JvdXAnKSl7XG4gICAgICAgICAgICB2YXIgJG9wdGdyb3VwTGkgPSAkb3B0Z3JvdXBVbC5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICAkcHJldk9wdGdyb3VwTGkgPSAkb3B0Z3JvdXBMaS5wcmV2KCc6dmlzaWJsZScpO1xuXG4gICAgICAgICAgICBpZiAoJHByZXZPcHRncm91cExpLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAkbmV4dEVsZW0gPSAkcHJldk9wdGdyb3VwTGkuZmluZCh0aGlzLmVsZW1zU2VsZWN0b3IpLmxhc3QoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICRuZXh0RWxlbSA9ICRlbGVtcy5sYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRuZXh0RWxlbSA9ICRlbGVtcy5sYXN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoJG5leHRFbGVtLmxlbmd0aCA+IDApe1xuICAgICAgICAkbmV4dEVsZW0uYWRkQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICAgIHZhciBzY3JvbGxUbyA9ICRsaXN0LnNjcm9sbFRvcCgpICsgJG5leHRFbGVtLnBvc2l0aW9uKCkudG9wIC0gXG4gICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lckhlaWdodCAvIDIgKyBlbGVtSGVpZ2h0IC8gMjtcblxuICAgICAgICAkbGlzdC5zY3JvbGxUb3Aoc2Nyb2xsVG8pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAnc2VsZWN0SGlnaGxpZ2h0ZWQnIDogZnVuY3Rpb24oJGxpc3Qpe1xuICAgICAgdmFyICRlbGVtcyA9ICRsaXN0LmZpbmQodGhpcy5lbGVtc1NlbGVjdG9yKSxcbiAgICAgICAgICAkaGlnaGxpZ2h0ZWRFbGVtID0gJGVsZW1zLmZpbHRlcignLm1zLWhvdmVyJykuZmlyc3QoKTtcblxuICAgICAgaWYgKCRoaWdobGlnaHRlZEVsZW0ubGVuZ3RoID4gMCl7XG4gICAgICAgIGlmICgkbGlzdC5wYXJlbnQoKS5oYXNDbGFzcygnbXMtc2VsZWN0YWJsZScpKXtcbiAgICAgICAgICB0aGlzLnNlbGVjdCgkaGlnaGxpZ2h0ZWRFbGVtLmRhdGEoJ21zLXZhbHVlJykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZGVzZWxlY3QoJGhpZ2hsaWdodGVkRWxlbS5kYXRhKCdtcy12YWx1ZScpKTtcbiAgICAgICAgfVxuICAgICAgICAkZWxlbXMucmVtb3ZlQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgICdzd2l0Y2hMaXN0JyA6IGZ1bmN0aW9uKCRsaXN0KXtcbiAgICAgICRsaXN0LmJsdXIoKTtcbiAgICAgIHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMuZWxlbXNTZWxlY3RvcikucmVtb3ZlQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICBpZiAoJGxpc3QucGFyZW50KCkuaGFzQ2xhc3MoJ21zLXNlbGVjdGFibGUnKSl7XG4gICAgICAgIHRoaXMuJHNlbGVjdGlvblVsLmZvY3VzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiRzZWxlY3RhYmxlVWwuZm9jdXMoKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgJ2FjdGl2ZU1vdXNlJyA6IGZ1bmN0aW9uKCRsaXN0KXtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgJCgnYm9keScpLm9uKCdtb3VzZWVudGVyJywgdGhhdC5lbGVtc1NlbGVjdG9yLCBmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5tcy1jb250YWluZXInKS5maW5kKHRoYXQuZWxlbXNTZWxlY3RvcikucmVtb3ZlQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ21zLWhvdmVyJyk7XG4gICAgICB9KTtcblxuICAgICAgJCgnYm9keScpLm9uKCdtb3VzZWxlYXZlJywgdGhhdC5lbGVtc1NlbGVjdG9yLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcubXMtY29udGFpbmVyJykuZmluZCh0aGF0LmVsZW1zU2VsZWN0b3IpLnJlbW92ZUNsYXNzKCdtcy1ob3ZlcicpOztcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAncmVmcmVzaCcgOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgdGhpcy4kZWxlbWVudC5tdWx0aVNlbGVjdCh0aGlzLm9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICAnZGVzdHJveScgOiBmdW5jdGlvbigpe1xuICAgICAgJChcIiNtcy1cIit0aGlzLiRlbGVtZW50LmF0dHIoXCJpZFwiKSkucmVtb3ZlKCk7XG4gICAgICB0aGlzLiRlbGVtZW50LmNzcygncG9zaXRpb24nLCAnJykuY3NzKCdsZWZ0JywgJycpXG4gICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZURhdGEoJ211bHRpc2VsZWN0Jyk7XG4gICAgfSxcblxuICAgICdzZWxlY3QnIDogZnVuY3Rpb24odmFsdWUsIG1ldGhvZCl7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyl7IHZhbHVlID0gW3ZhbHVlXTsgfVxuXG4gICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgbXMgPSB0aGlzLiRlbGVtZW50LFxuICAgICAgICAgIG1zSWRzID0gJC5tYXAodmFsdWUsIGZ1bmN0aW9uKHZhbCl7IHJldHVybih0aGF0LnNhbml0aXplKHZhbCkpOyB9KSxcbiAgICAgICAgICBzZWxlY3RhYmxlcyA9IHRoaXMuJHNlbGVjdGFibGVVbC5maW5kKCcjJyArIG1zSWRzLmpvaW4oJy1zZWxlY3RhYmxlLCAjJykrJy1zZWxlY3RhYmxlJykuZmlsdGVyKCc6bm90KC4nK3RoYXQub3B0aW9ucy5kaXNhYmxlZENsYXNzKycpJyksXG4gICAgICAgICAgc2VsZWN0aW9ucyA9IHRoaXMuJHNlbGVjdGlvblVsLmZpbmQoJyMnICsgbXNJZHMuam9pbignLXNlbGVjdGlvbiwgIycpICsgJy1zZWxlY3Rpb24nKS5maWx0ZXIoJzpub3QoLicrdGhhdC5vcHRpb25zLmRpc2FibGVkQ2xhc3MrJyknKSxcbiAgICAgICAgICBvcHRpb25zID0gbXMuZmluZCgnb3B0aW9uOm5vdCg6ZGlzYWJsZWQpJykuZmlsdGVyKGZ1bmN0aW9uKCl7IHJldHVybigkLmluQXJyYXkodGhpcy52YWx1ZSwgdmFsdWUpID4gLTEpOyB9KTtcblxuICAgICAgaWYgKG1ldGhvZCA9PT0gJ2luaXQnKXtcbiAgICAgICAgc2VsZWN0YWJsZXMgPSB0aGlzLiRzZWxlY3RhYmxlVWwuZmluZCgnIycgKyBtc0lkcy5qb2luKCctc2VsZWN0YWJsZSwgIycpKyctc2VsZWN0YWJsZScpLFxuICAgICAgICBzZWxlY3Rpb25zID0gdGhpcy4kc2VsZWN0aW9uVWwuZmluZCgnIycgKyBtc0lkcy5qb2luKCctc2VsZWN0aW9uLCAjJykgKyAnLXNlbGVjdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2VsZWN0YWJsZXMubGVuZ3RoID4gMCl7XG4gICAgICAgIHNlbGVjdGFibGVzLmFkZENsYXNzKCdtcy1zZWxlY3RlZCcpLmhpZGUoKTtcbiAgICAgICAgc2VsZWN0aW9ucy5hZGRDbGFzcygnbXMtc2VsZWN0ZWQnKS5zaG93KCk7XG5cbiAgICAgICAgb3B0aW9ucy5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuXG4gICAgICAgIHRoYXQuJGNvbnRhaW5lci5maW5kKHRoYXQuZWxlbXNTZWxlY3RvcikucmVtb3ZlQ2xhc3MoJ21zLWhvdmVyJyk7XG5cbiAgICAgICAgdmFyIHNlbGVjdGFibGVPcHRncm91cHMgPSB0aGF0LiRzZWxlY3RhYmxlVWwuY2hpbGRyZW4oJy5tcy1vcHRncm91cC1jb250YWluZXInKTtcbiAgICAgICAgaWYgKHNlbGVjdGFibGVPcHRncm91cHMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgc2VsZWN0YWJsZU9wdGdyb3Vwcy5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgc2VsZWN0YWJsZXNMaSA9ICQodGhpcykuZmluZCgnLm1zLWVsZW0tc2VsZWN0YWJsZScpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGFibGVzTGkubGVuZ3RoID09PSBzZWxlY3RhYmxlc0xpLmZpbHRlcignLm1zLXNlbGVjdGVkJykubGVuZ3RoKXtcbiAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCcubXMtb3B0Z3JvdXAtbGFiZWwnKS5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgc2VsZWN0aW9uT3B0Z3JvdXBzID0gdGhhdC4kc2VsZWN0aW9uVWwuY2hpbGRyZW4oJy5tcy1vcHRncm91cC1jb250YWluZXInKTtcbiAgICAgICAgICBzZWxlY3Rpb25PcHRncm91cHMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHNlbGVjdGlvbnNMaSA9ICQodGhpcykuZmluZCgnLm1zLWVsZW0tc2VsZWN0aW9uJyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uc0xpLmZpbHRlcignLm1zLXNlbGVjdGVkJykubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICQodGhpcykuZmluZCgnLm1zLW9wdGdyb3VwLWxhYmVsJykuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMua2VlcE9yZGVyICYmIG1ldGhvZCAhPT0gJ2luaXQnKXtcbiAgICAgICAgICAgIHZhciBzZWxlY3Rpb25MaUxhc3QgPSB0aGF0LiRzZWxlY3Rpb25VbC5maW5kKCcubXMtc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIGlmKChzZWxlY3Rpb25MaUxhc3QubGVuZ3RoID4gMSkgJiYgKHNlbGVjdGlvbkxpTGFzdC5sYXN0KCkuZ2V0KDApICE9IHNlbGVjdGlvbnMuZ2V0KDApKSkge1xuICAgICAgICAgICAgICBzZWxlY3Rpb25zLmluc2VydEFmdGVyKHNlbGVjdGlvbkxpTGFzdC5sYXN0KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobWV0aG9kICE9PSAnaW5pdCcpe1xuICAgICAgICAgIG1zLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgICAgICAgIGlmICh0eXBlb2YgdGhhdC5vcHRpb25zLmFmdGVyU2VsZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGF0Lm9wdGlvbnMuYWZ0ZXJTZWxlY3QuY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgICdkZXNlbGVjdCcgOiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyl7IHZhbHVlID0gW3ZhbHVlXTsgfVxuXG4gICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgbXMgPSB0aGlzLiRlbGVtZW50LFxuICAgICAgICAgIG1zSWRzID0gJC5tYXAodmFsdWUsIGZ1bmN0aW9uKHZhbCl7IHJldHVybih0aGF0LnNhbml0aXplKHZhbCkpOyB9KSxcbiAgICAgICAgICBzZWxlY3RhYmxlcyA9IHRoaXMuJHNlbGVjdGFibGVVbC5maW5kKCcjJyArIG1zSWRzLmpvaW4oJy1zZWxlY3RhYmxlLCAjJykrJy1zZWxlY3RhYmxlJyksXG4gICAgICAgICAgc2VsZWN0aW9ucyA9IHRoaXMuJHNlbGVjdGlvblVsLmZpbmQoJyMnICsgbXNJZHMuam9pbignLXNlbGVjdGlvbiwgIycpKyctc2VsZWN0aW9uJykuZmlsdGVyKCcubXMtc2VsZWN0ZWQnKS5maWx0ZXIoJzpub3QoLicrdGhhdC5vcHRpb25zLmRpc2FibGVkQ2xhc3MrJyknKSxcbiAgICAgICAgICBvcHRpb25zID0gbXMuZmluZCgnb3B0aW9uJykuZmlsdGVyKGZ1bmN0aW9uKCl7IHJldHVybigkLmluQXJyYXkodGhpcy52YWx1ZSwgdmFsdWUpID4gLTEpOyB9KTtcblxuICAgICAgaWYgKHNlbGVjdGlvbnMubGVuZ3RoID4gMCl7XG4gICAgICAgIHNlbGVjdGFibGVzLnJlbW92ZUNsYXNzKCdtcy1zZWxlY3RlZCcpLnNob3coKTtcbiAgICAgICAgc2VsZWN0aW9ucy5yZW1vdmVDbGFzcygnbXMtc2VsZWN0ZWQnKS5oaWRlKCk7XG4gICAgICAgIG9wdGlvbnMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgdGhhdC4kY29udGFpbmVyLmZpbmQodGhhdC5lbGVtc1NlbGVjdG9yKS5yZW1vdmVDbGFzcygnbXMtaG92ZXInKTtcblxuICAgICAgICB2YXIgc2VsZWN0YWJsZU9wdGdyb3VwcyA9IHRoYXQuJHNlbGVjdGFibGVVbC5jaGlsZHJlbignLm1zLW9wdGdyb3VwLWNvbnRhaW5lcicpO1xuICAgICAgICBpZiAoc2VsZWN0YWJsZU9wdGdyb3Vwcy5sZW5ndGggPiAwKXtcbiAgICAgICAgICBzZWxlY3RhYmxlT3B0Z3JvdXBzLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBzZWxlY3RhYmxlc0xpID0gJCh0aGlzKS5maW5kKCcubXMtZWxlbS1zZWxlY3RhYmxlJyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0YWJsZXNMaS5maWx0ZXIoJzpub3QoLm1zLXNlbGVjdGVkKScpLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5tcy1vcHRncm91cC1sYWJlbCcpLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBzZWxlY3Rpb25PcHRncm91cHMgPSB0aGF0LiRzZWxlY3Rpb25VbC5jaGlsZHJlbignLm1zLW9wdGdyb3VwLWNvbnRhaW5lcicpO1xuICAgICAgICAgIHNlbGVjdGlvbk9wdGdyb3Vwcy5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW9uc0xpID0gJCh0aGlzKS5maW5kKCcubXMtZWxlbS1zZWxlY3Rpb24nKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb25zTGkuZmlsdGVyKCcubXMtc2VsZWN0ZWQnKS5sZW5ndGggPT09IDApe1xuICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5tcy1vcHRncm91cC1sYWJlbCcpLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBtcy50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGF0Lm9wdGlvbnMuYWZ0ZXJEZXNlbGVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHRoYXQub3B0aW9ucy5hZnRlckRlc2VsZWN0LmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgICdzZWxlY3RfYWxsJyA6IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgbXMgPSB0aGlzLiRlbGVtZW50LFxuICAgICAgICAgIHZhbHVlcyA9IG1zLnZhbCgpO1xuXG4gICAgICBtcy5maW5kKCdvcHRpb246bm90KFwiOmRpc2FibGVkXCIpJykucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgIHRoaXMuJHNlbGVjdGFibGVVbC5maW5kKCcubXMtZWxlbS1zZWxlY3RhYmxlJykuZmlsdGVyKCc6bm90KC4nK3RoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKycpJykuYWRkQ2xhc3MoJ21zLXNlbGVjdGVkJykuaGlkZSgpO1xuICAgICAgdGhpcy4kc2VsZWN0aW9uVWwuZmluZCgnLm1zLW9wdGdyb3VwLWxhYmVsJykuc2hvdygpO1xuICAgICAgdGhpcy4kc2VsZWN0YWJsZVVsLmZpbmQoJy5tcy1vcHRncm91cC1sYWJlbCcpLmhpZGUoKTtcbiAgICAgIHRoaXMuJHNlbGVjdGlvblVsLmZpbmQoJy5tcy1lbGVtLXNlbGVjdGlvbicpLmZpbHRlcignOm5vdCguJyt0aGlzLm9wdGlvbnMuZGlzYWJsZWRDbGFzcysnKScpLmFkZENsYXNzKCdtcy1zZWxlY3RlZCcpLnNob3coKTtcbiAgICAgIHRoaXMuJHNlbGVjdGlvblVsLmZvY3VzKCk7XG4gICAgICBtcy50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmFmdGVyU2VsZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHZhciBzZWxlY3RlZFZhbHVlcyA9ICQuZ3JlcChtcy52YWwoKSwgZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgcmV0dXJuICQuaW5BcnJheShpdGVtLCB2YWx1ZXMpIDwgMDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub3B0aW9ucy5hZnRlclNlbGVjdC5jYWxsKHRoaXMsIHNlbGVjdGVkVmFsdWVzKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgJ2Rlc2VsZWN0X2FsbCcgOiBmdW5jdGlvbigpe1xuICAgICAgdmFyIG1zID0gdGhpcy4kZWxlbWVudCxcbiAgICAgICAgICB2YWx1ZXMgPSBtcy52YWwoKTtcblxuICAgICAgbXMuZmluZCgnb3B0aW9uJykucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG4gICAgICB0aGlzLiRzZWxlY3RhYmxlVWwuZmluZCgnLm1zLWVsZW0tc2VsZWN0YWJsZScpLnJlbW92ZUNsYXNzKCdtcy1zZWxlY3RlZCcpLnNob3coKTtcbiAgICAgIHRoaXMuJHNlbGVjdGlvblVsLmZpbmQoJy5tcy1vcHRncm91cC1sYWJlbCcpLmhpZGUoKTtcbiAgICAgIHRoaXMuJHNlbGVjdGFibGVVbC5maW5kKCcubXMtb3B0Z3JvdXAtbGFiZWwnKS5zaG93KCk7XG4gICAgICB0aGlzLiRzZWxlY3Rpb25VbC5maW5kKCcubXMtZWxlbS1zZWxlY3Rpb24nKS5yZW1vdmVDbGFzcygnbXMtc2VsZWN0ZWQnKS5oaWRlKCk7XG4gICAgICB0aGlzLiRzZWxlY3RhYmxlVWwuZm9jdXMoKTtcbiAgICAgIG1zLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuYWZ0ZXJEZXNlbGVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLm9wdGlvbnMuYWZ0ZXJEZXNlbGVjdC5jYWxsKHRoaXMsIHZhbHVlcyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNhbml0aXplOiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICB2YXIgaGFzaCA9IDAsIGksIGNoYXJhY3RlcjtcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT0gMCkgcmV0dXJuIGhhc2g7XG4gICAgICB2YXIgbHMgPSAwO1xuICAgICAgZm9yIChpID0gMCwgbHMgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsczsgaSsrKSB7XG4gICAgICAgIGNoYXJhY3RlciAgPSB2YWx1ZS5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBoYXNoICA9ICgoaGFzaDw8NSktaGFzaCkrY2hhcmFjdGVyO1xuICAgICAgICBoYXNoIHw9IDA7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxuICAgICAgfVxuICAgICAgcmV0dXJuIGhhc2g7XG4gICAgfVxuICB9O1xuXG4gIC8qIE1VTFRJU0VMRUNUIFBMVUdJTiBERUZJTklUSU9OXG4gICAqID09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbiAgJC5mbi5tdWx0aVNlbGVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9uID0gYXJndW1lbnRzWzBdLFxuICAgICAgICBhcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgIGRhdGEgPSAkdGhpcy5kYXRhKCdtdWx0aXNlbGVjdCcpLFxuICAgICAgICAgIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgJC5mbi5tdWx0aVNlbGVjdC5kZWZhdWx0cywgJHRoaXMuZGF0YSgpLCB0eXBlb2Ygb3B0aW9uID09PSAnb2JqZWN0JyAmJiBvcHRpb24pO1xuXG4gICAgICBpZiAoIWRhdGEpeyAkdGhpcy5kYXRhKCdtdWx0aXNlbGVjdCcsIChkYXRhID0gbmV3IE11bHRpU2VsZWN0KHRoaXMsIG9wdGlvbnMpKSk7IH1cblxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT09ICdzdHJpbmcnKXtcbiAgICAgICAgZGF0YVtvcHRpb25dKGFyZ3NbMV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YS5pbml0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgJC5mbi5tdWx0aVNlbGVjdC5kZWZhdWx0cyA9IHtcbiAgICBrZXlTZWxlY3Q6IFszMl0sXG4gICAgc2VsZWN0YWJsZU9wdGdyb3VwOiBmYWxzZSxcbiAgICBkaXNhYmxlZENsYXNzIDogJ2Rpc2FibGVkJyxcbiAgICBkYmxDbGljayA6IGZhbHNlLFxuICAgIGtlZXBPcmRlcjogZmFsc2UsXG4gICAgY3NzQ2xhc3M6ICcnXG4gIH07XG5cbiAgJC5mbi5tdWx0aVNlbGVjdC5Db25zdHJ1Y3RvciA9IE11bHRpU2VsZWN0O1xuXG4gICQuZm4uaW5zZXJ0QXQgPSBmdW5jdGlvbihpbmRleCwgJHBhcmVudCkge1xuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgJHBhcmVudC5wcmVwZW5kKHRoaXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHBhcmVudC5jaGlsZHJlbigpLmVxKGluZGV4IC0gMSkuYWZ0ZXIodGhpcyk7XG4gICAgICB9XG4gICAgfSk7XG59XG5cbn0od2luZG93LmpRdWVyeSk7XG4iXX0=
